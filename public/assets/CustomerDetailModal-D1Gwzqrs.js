import{a3 as ee,z as le,x as Z,M as J,D as we,N as ke,E as ne,Q as ie,H as De,F as Te,P as Ce,T as Ae,k as _e,r as i,a0 as O,b as x,j as e,U as de,B as p,a1 as G,a2 as Se,$ as Y,X as Me,L as B,i as ze,l as Fe,m as Ee,n as L,aj as R,C as w,e as k,w as u,R as T,S as Oe,p as Be,q as Le,s as Re,t as P,a4 as Pe,K as Ue}from"./index-Xd90qdO9.js";import{y as qe,D as me,a as oe,b as ce,c as xe,d as he,P as fe,W as U,T as $,j as Ve,B as W,ac as He,a6 as Qe,w as Ke}from"./MainLayout-DW7UjMSA.js";import{S as X}from"./separator-BNuYyAQ9.js";import{getSavedReports as Ge}from"./reportService-eZYvGhBr.js";import{A as Ye,a as $e,b as We,c as Xe,d as Ze,e as Je,f as Ie,g as es}from"./alert-dialog-BVp-ELLM.js";import{S as ss}from"./square-pen-zeHrcQ7c.js";import{T as as}from"./trash-2-DlZRXDqX.js";import{S as ts}from"./save-Bgz0wbo5.js";import{T as rs}from"./trending-up-DyiN6Ad2.js";import{M as ls}from"./map-pin-CYdnXw-f.js";import{D as ns}from"./download-Bq-rl9Ru.js";import{P as is}from"./plus-D9uLCipi.js";import{M as pe}from"./message-square-BAQ_w3zD.js";import{f as ds}from"./format-DuC-NjES.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=ee("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=ee("PhoneIncoming",[["polyline",{points:"16 2 16 8 22 8",key:"1ygljm"}],["line",{x1:"22",x2:"16",y1:"2",y2:"8",key:"1xzwqn"}],["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=ee("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]),I="customerNotes",xs=async g=>{var N;try{const s=le(Z(J,I),we("customerId","==",g),ke("createdAt","desc"));return(await ne(s)).docs.map(o=>({id:o.id,...o.data()}))}catch(s){if((s==null?void 0:s.code)==="failed-precondition"||(N=s==null?void 0:s.message)!=null&&N.includes("index")){console.warn("Customer notes index bulunamadı, basit query kullanılıyor");try{const m=le(Z(J,I));let n=(await ne(m)).docs.map(h=>({id:h.id,...h.data()}));return n=n.filter(h=>h.customerId===g),n.sort((h,q)=>{var f,_;const b=((f=h.createdAt)==null?void 0:f.toMillis())||0;return(((_=q.createdAt)==null?void 0:_.toMillis())||0)-b}),n}catch(m){return console.error("Fallback query de başarısız:",m),[]}}throw console.error("Get customer notes error:",s),s}},hs=async g=>{var N;try{const s={...g,createdAt:ie(),updatedAt:ie()},m=await De(Z(J,I),s),o=await Te(m);if(!o.exists())throw new Error("Not oluşturulamadı");return await Ce("CREATE","customerNotes",m.id,g.createdBy,null,o.data()),{id:m.id,...o.data(),createdAt:((N=o.data())==null?void 0:N.createdAt)||Ae.now()}}catch(s){throw console.error("Create customer note error:",s),s}},As=({open:g,onOpenChange:N,customer:s,onUpdate:m,onDelete:o})=>{const{user:n}=_e(),[h,q]=i.useState([]),[b,se]=i.useState([]),[f,_]=i.useState([]),[S,ae]=i.useState(!1),[ue,M]=i.useState(!1),[c,z]=i.useState({type:"general",title:"",content:""}),[D,F]=i.useState(!1),[V,te]=i.useState(!1),[ge,H]=i.useState(!1),[r,j]=i.useState({name:"",email:"",phone:"",company:"",address:"",tax_number:"",notes:""});i.useEffect(()=>{g&&(s!=null&&s.id)&&(Q(),F(!1))},[g,s==null?void 0:s.id]),i.useEffect(()=>{s&&!D&&j({name:s.name||"",email:s.email||"",phone:O(s.phone)||"",company:s.company||"",address:s.address||"",tax_number:s.taxId||s.tax_number||s.tax_id||"",notes:s.notes||""})},[s,D]);const Q=async()=>{if(s!=null&&s.id){ae(!0);try{const[a,t,d]=await Promise.all([xs(s.id),Ge({reportType:"sales_quote"}),qe({customerId:s.id})]);q(a);const v=t.filter(y=>{const l=y.metadata;return(l==null?void 0:l.customerId)===s.id});se(v),_(d)}catch(a){x.error("Veriler yüklenirken hata: "+a.message)}finally{ae(!1)}}},je=async()=>{if(!(!(s!=null&&s.id)||!(n!=null&&n.id))){if(!c.title.trim()||!c.content.trim()){x.error("Başlık ve içerik gereklidir");return}try{await hs({customerId:s.id,type:c.type,title:c.title.trim(),content:c.content.trim(),createdBy:n.id}),x.success("Not eklendi"),M(!1),z({type:"general",title:"",content:""}),Q()}catch(a){x.error("Not eklenirken hata: "+a.message)}}},re=async a=>{if(a.preventDefault(),!(!(s!=null&&s.id)||!(n!=null&&n.id))){if(!r.name.trim()){x.error("İsim gereklidir");return}te(!0);try{await He(s.id,{name:r.name.trim(),company:r.company.trim()||null,email:r.email.trim()||null,phone:Pe(r.phone),address:r.address.trim()||null,taxId:r.tax_number.trim()||null,notes:r.notes.trim()||null},n.id),x.success("Müşteri başarıyla güncellendi"),F(!1),m&&m(),Q()}catch(t){console.error("Update customer error:",t),x.error(t.message||"Müşteri güncellenirken hata oluştu")}finally{te(!1)}}},Ne=async()=>{if(s!=null&&s.id)try{await Qe(s.id),x.success("Müşteri silindi"),H(!1),N(!1),o&&o()}catch(a){console.error("Delete customer error:",a),x.error(a.message||"Müşteri silinirken hata oluştu")}},be=a=>{switch(a){case"phone_call_out":return"Telefonla Aradık";case"phone_call_in":return"Bizi Aradı";case"warranty":return"Arıza Kaydı";case"general":return"Genel Not";default:return a}},ve=a=>{switch(a){case"phone_call_out":return ms;case"phone_call_in":return os;case"warranty":return Ue;case"general":return pe;default:return U}},E=i.useMemo(()=>{const a=f.length,t=f.reduce((l,A)=>l+(A.totalAmount||0),0),d=b.length,v=b.reduce((l,A)=>{const K=A.metadata;return l+((K==null?void 0:K.grandTotal)||0)},0),y=f.filter(l=>l.status==="completed"||l.status==="delivered").length;return{totalOrders:a,totalOrderAmount:t,totalQuotes:d,totalQuoteAmount:v,completedOrders:y}},[f,b]),ye=a=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:2}).format(a),C=a=>{if(!a)return"-";try{let t;if(a!=null&&a.toDate&&typeof a.toDate=="function")t=a.toDate();else if(a!=null&&a.seconds)t=new Date(a.seconds*1e3);else if(a!=null&&a.nanoseconds)t=new Date(a.seconds*1e3+a.nanoseconds/1e6);else if(a instanceof Date)t=a;else if(typeof a=="string"){const d=new Date(a);if(!Number.isNaN(d.getTime()))t=d;else return"-"}else typeof a=="number"?t=new Date(a):t=new Date(a);return Number.isNaN(t.getTime())?"-":ds(t,"dd MMM yyyy",{locale:Ke})}catch(t){return console.error("Date formatting error:",t,a),"-"}};return s?e.jsx(me,{open:g,onOpenChange:N,children:e.jsxs(oe,{className:"!max-w-[100vw] sm:!max-w-[95vw] !w-[100vw] sm:!w-[95vw] !h-[100vh] sm:!h-[90vh] !max-h-[100vh] sm:!max-h-[90vh] !left-0 sm:!left-[2.5vw] !top-0 sm:!top-[5vh] !right-0 sm:!right-auto !bottom-0 sm:!bottom-auto !translate-x-0 !translate-y-0 overflow-hidden !p-0 gap-0 bg-white flex flex-col !m-0 !rounded-none sm:!rounded-lg !border-0 sm:!border",children:[e.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[e.jsx(ce,{className:"p-3 sm:p-4 border-b bg-white flex-shrink-0 relative pr-12 sm:pr-16",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-8 w-8 sm:h-10 sm:w-10 rounded-lg bg-primary/10 flex items-center justify-center border border-primary/20 flex-shrink-0",children:e.jsx(de,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(xe,{className:"text-lg sm:text-xl font-semibold text-foreground truncate",children:D?"Müşteri Düzenle":s.name}),!D&&s.company&&e.jsx(he,{className:"text-xs text-muted-foreground truncate mt-0.5",children:s.company})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 flex-shrink-0",children:D?e.jsxs(e.Fragment,{children:[e.jsxs(p,{variant:"outline",size:"sm",className:"border-primary/20 hover:bg-primary/5 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0",onClick:()=>{F(!1),j({name:s.name||"",email:s.email||"",phone:O(s.phone)||"",company:s.company||"",address:s.address||"",tax_number:s.taxId||s.tax_number||s.tax_id||"",notes:s.notes||""})},disabled:V,children:[e.jsx(Me,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"İptal"]}),e.jsxs(p,{variant:"default",size:"sm",className:"bg-primary hover:bg-primary/90 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0 text-white",onClick:re,disabled:V,children:[V?e.jsx(B,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0 animate-spin"}):e.jsx(ts,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Kaydet"]})]}):e.jsxs(e.Fragment,{children:[s.email&&e.jsxs(p,{variant:"secondary",size:"sm",className:"bg-primary/10 text-primary hover:bg-primary/20 rounded-lg px-3 py-1.5 font-medium shadow-sm text-xs sm:text-sm flex-shrink-0",onClick:()=>window.location.href=`mailto:${s.email}`,"aria-label":"E-posta gönder",children:[e.jsx(G,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Mail"]}),s.phone&&e.jsxs(p,{variant:"outline",size:"sm",className:"border-primary/20 hover:bg-primary/5 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0",onClick:()=>window.location.href=`tel:${Se(s.phone)}`,"aria-label":"Telefon ara",children:[e.jsx(Y,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Ara"]}),e.jsxs(p,{variant:"outline",size:"sm",className:"border-primary/20 hover:bg-primary/5 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0",onClick:()=>F(!0),children:[e.jsx(ss,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Düzenle"]}),e.jsxs(p,{variant:"outline",size:"sm",className:"border-destructive/20 hover:bg-destructive/5 text-destructive rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0",onClick:()=>H(!0),children:[e.jsx(as,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Sil"]})]})})]})}),(s.email||s.phone||s.tax_number||s.taxId||s.tax_id)&&e.jsxs("div",{className:"px-3 sm:px-6 py-2 sm:py-3 border-b bg-gray-50/50 flex flex-wrap items-center gap-2 flex-shrink-0",children:[s.email&&e.jsxs("div",{className:"flex items-center gap-1 rounded-full border bg-muted/40 px-3 py-1.5 text-xs font-medium text-muted-foreground",children:[e.jsx(G,{className:"h-3 w-3"}),e.jsx("span",{className:"text-muted-foreground/70",children:"E-posta:"}),e.jsx("span",{className:"text-foreground truncate max-w-[200px]",children:s.email})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-1 rounded-full border bg-muted/40 px-3 py-1.5 text-xs font-medium text-muted-foreground",children:[e.jsx(Y,{className:"h-3 w-3"}),e.jsx("span",{className:"text-muted-foreground/70",children:"Telefon:"}),e.jsx("span",{className:"text-foreground",children:O(s.phone)})]}),(s.tax_number||s.taxId||s.tax_id)&&e.jsxs("div",{className:"flex items-center gap-1 rounded-full border bg-muted/40 px-3 py-1.5 text-xs font-medium text-muted-foreground",children:[e.jsx("span",{className:"text-muted-foreground/70",children:"Vergi No:"}),e.jsx("span",{className:"text-foreground",children:s.tax_number||s.taxId||s.tax_id})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden bg-gray-50/50 p-3 sm:p-4 min-h-0",children:e.jsx("div",{className:"max-w-full mx-auto h-full overflow-y-auto",children:S?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx("div",{className:"rounded-2xl border bg-gradient-to-br from-primary/10 via-white to-white border-primary/20 text-card-foreground p-4 shadow-sm transition hover:shadow-md hover:-translate-y-0.5 flex flex-col h-full",children:e.jsxs("div",{className:"flex items-start justify-between flex-1",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-muted-foreground mb-1",children:"Toplam Sipariş"}),e.jsx("p",{className:"text-2xl font-semibold leading-tight",children:E.totalOrders})]}),e.jsx("div",{className:"rounded-full border p-2 bg-white/75 shadow-inner shrink-0 ml-2",children:e.jsx(fe,{className:"h-5 w-5 text-primary"})})]})}),e.jsx("div",{className:"rounded-2xl border bg-gradient-to-br from-emerald-50/80 via-white to-white border-emerald-100 text-card-foreground p-4 shadow-sm transition hover:shadow-md hover:-translate-y-0.5 flex flex-col h-full",children:e.jsxs("div",{className:"flex items-start justify-between flex-1",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-muted-foreground mb-1",children:"Sipariş Tutarı"}),e.jsx("p",{className:"text-2xl font-semibold leading-tight",children:ye(E.totalOrderAmount)})]}),e.jsx("div",{className:"rounded-full border p-2 bg-white/75 shadow-inner shrink-0 ml-2",children:e.jsx(rs,{className:"h-5 w-5 text-emerald-600"})})]})}),e.jsx("div",{className:"rounded-2xl border bg-gradient-to-br from-blue-50/80 via-white to-white border-blue-100 text-card-foreground p-4 shadow-sm transition hover:shadow-md hover:-translate-y-0.5 flex flex-col h-full",children:e.jsxs("div",{className:"flex items-start justify-between flex-1",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-muted-foreground mb-1",children:"Fiyat Teklifleri"}),e.jsx("p",{className:"text-2xl font-semibold leading-tight",children:E.totalQuotes})]}),e.jsx("div",{className:"rounded-full border p-2 bg-white/75 shadow-inner shrink-0 ml-2",children:e.jsx(U,{className:"h-5 w-5 text-blue-600"})})]})}),e.jsx("div",{className:"rounded-2xl border bg-gradient-to-br from-amber-50/80 via-white to-white border-amber-100 text-card-foreground p-4 shadow-sm transition hover:shadow-md hover:-translate-y-0.5 flex flex-col h-full",children:e.jsxs("div",{className:"flex items-start justify-between flex-1",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-muted-foreground mb-1",children:"Tamamlanan"}),e.jsx("p",{className:"text-2xl font-semibold leading-tight",children:E.completedOrders})]}),e.jsx("div",{className:"rounded-full border p-2 bg-white/75 shadow-inner shrink-0 ml-2",children:e.jsx(ze,{className:"h-5 w-5 text-amber-600"})})]})})]}),e.jsxs(Fe,{defaultValue:"info",className:"w-full overflow-x-hidden max-w-full px-3 sm:px-4 md:px-6 lg:px-12",children:[e.jsxs(Ee,{className:"grid w-full grid-cols-4 h-auto sm:h-10 md:h-11 bg-muted/50 rounded-lg p-1 border gap-1",children:[e.jsx(L,{value:"info",className:"rounded-md data-[state=active]:bg-background data-[state=active]:shadow-sm data-[state=active]:text-primary text-xs md:text-sm font-medium transition-all duration-200 min-h-[44px] sm:min-h-0",children:"Bilgiler"}),e.jsx(L,{value:"quotes",className:"rounded-md data-[state=active]:bg-background data-[state=active]:shadow-sm data-[state=active]:text-primary text-xs md:text-sm font-medium transition-all duration-200 min-h-[44px] sm:min-h-0",children:"Fiyat Teklifleri"}),e.jsx(L,{value:"orders",className:"rounded-md data-[state=active]:bg-background data-[state=active]:shadow-sm data-[state=active]:text-primary text-xs md:text-sm font-medium transition-all duration-200 min-h-[44px] sm:min-h-0",children:"Siparişler"}),e.jsx(L,{value:"notes",className:"rounded-md data-[state=active]:bg-background data-[state=active]:shadow-sm data-[state=active]:text-primary text-xs md:text-sm font-medium transition-all duration-200 min-h-[44px] sm:min-h-0",children:"Notlar"})]}),e.jsx(R,{value:"info",className:"space-y-4 sm:space-y-6 mt-4 sm:mt-6 focus:outline-none overflow-x-hidden max-w-full",children:D?e.jsx("form",{onSubmit:re,className:"space-y-4 sm:space-y-6",children:e.jsx(w,{children:e.jsxs(k,{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-1",children:"Müşteri Bilgileri"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Temel müşteri bilgilerini güncelleyin"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"name",showRequired:!0,className:"text-sm sm:text-base",children:"İsim"}),e.jsx(T,{id:"name",value:r.name,onChange:a=>j({...r,name:a.target.value}),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"company",className:"text-sm sm:text-base",children:"Şirket"}),e.jsx(T,{id:"company",value:r.company,onChange:a=>j({...r,company:a.target.value}),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"email",className:"text-sm sm:text-base",children:"E-posta"}),e.jsx(T,{id:"email",type:"email",value:r.email,onChange:a=>j({...r,email:a.target.value}),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"phone",className:"text-sm sm:text-base",children:"Telefon"}),e.jsx(T,{id:"phone",value:r.phone,onChange:a=>j({...r,phone:a.target.value}),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"address",className:"text-sm sm:text-base",children:"Adres"}),e.jsx($,{id:"address",value:r.address,onChange:a=>j({...r,address:a.target.value}),rows:3,className:"min-h-[44px] sm:min-h-0 resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"tax_number",className:"text-sm sm:text-base",children:"Vergi No"}),e.jsx(T,{id:"tax_number",value:r.tax_number,onChange:a=>j({...r,tax_number:a.target.value}),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"notes",className:"text-sm sm:text-base",children:"Notlar"}),e.jsx($,{id:"notes",value:r.notes,onChange:a=>j({...r,notes:a.target.value}),rows:4,className:"min-h-[44px] sm:min-h-0 resize-none",placeholder:"Müşteri hakkında notlar..."})]})]})})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(de,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-0.5",children:"İsim"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.name})]})]}),s.company&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ve,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-0.5",children:"Şirket"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.company})]})]}),s.email&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(G,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-0.5",children:"E-posta"}),e.jsx("p",{className:"text-sm text-muted-foreground break-all",children:s.email})]})]}),s.phone&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Y,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-0.5",children:"Telefon"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:O(s.phone)})]})]}),(s.tax_number||s.taxId||s.tax_id)&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(cs,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-0.5",children:"Vergi No"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.tax_number||s.taxId||s.tax_id})]})]})]}),s.address&&e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ls,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-0.5",children:"Adres"}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap break-words leading-relaxed",children:s.address})]})]})]}),s.notes&&e.jsxs(e.Fragment,{children:[e.jsx(X,{}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(U,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-0.5",children:"Notlar"}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap break-words leading-relaxed",children:s.notes})]})]})]}),e.jsx(X,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide mb-1.5",children:"Oluşturma Tarihi"}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:C(s.createdAt||s.created_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide mb-1.5",children:"Son Güncelleme"}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:C(s.updatedAt||s.updated_at)})]})]})]})}),e.jsxs(R,{value:"quotes",className:"space-y-3 sm:space-y-4 mt-4 sm:mt-6 focus:outline-none overflow-x-hidden max-w-full",children:[e.jsx("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:e.jsxs("h3",{className:"text-lg sm:text-xl md:text-2xl font-bold text-foreground",children:["Fiyat Teklifleri (",b.length,")"]})}),S?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(B,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Yükleniyor..."})]}):b.length===0?e.jsx(w,{className:"border-2 border-dashed",children:e.jsxs(k,{className:"p-12 text-center",children:[e.jsx(U,{className:"h-12 w-12 text-muted-foreground/50 mx-auto mb-4"}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Henüz teklif bulunmuyor"})]})}):e.jsx("div",{className:"space-y-3",children:b.map(a=>{var t;return e.jsx(w,{className:"border-2 hover:border-primary/50 hover:shadow-md transition-all duration-200",children:e.jsx(k,{className:"p-5",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-base mb-2 text-foreground",children:a.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:C(a.createdAt)})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[e.jsxs(W,{variant:"outline",className:"text-sm font-semibold px-3 py-1 whitespace-nowrap",children:["₺",(((t=a.metadata)==null?void 0:t.grandTotal)||0).toLocaleString("tr-TR")]}),e.jsxs(p,{size:"sm",variant:"outline",className:"font-semibold",onClick:async()=>{try{if(!a.fileUrl){x.error("Dosya bağlantısı bulunamadı");return}const v=await(await fetch(a.fileUrl)).blob(),y=window.URL.createObjectURL(v),l=document.createElement("a");l.href=y;const A=a.fileName||`${a.title||"teklif"}.pdf`;l.download=A,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(y),document.body.removeChild(l)}catch(d){console.error("Download error:",d),a.fileUrl?window.open(a.fileUrl,"_blank"):x.error("Dosya bağlantısı bulunamadı")}},children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"İndir"]})]})]})})},a.id)})})]}),e.jsxs(R,{value:"orders",className:"space-y-4 mt-6 focus:outline-none overflow-x-hidden max-w-full",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h3",{className:"text-xl md:text-2xl font-bold text-foreground",children:["Siparişler (",f.length,")"]})}),S?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(B,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Yükleniyor..."})]}):f.length===0?e.jsx(w,{className:"border-2 border-dashed",children:e.jsxs(k,{className:"p-12 text-center",children:[e.jsx(fe,{className:"h-12 w-12 text-muted-foreground/50 mx-auto mb-4"}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Henüz sipariş bulunmuyor"})]})}):e.jsx("div",{className:"space-y-3",children:f.map(a=>{const d=(v=>({pending:{label:"Beklemede",variant:"outline"},in_progress:{label:"Üretimde",variant:"default"},quality_check:{label:"Kalite Kontrol",variant:"secondary"},completed:{label:"Tamamlandı",variant:"default"},delivered:{label:"Teslim Edildi",variant:"default"},cancelled:{label:"İptal",variant:"destructive"}})[v]||{label:v,variant:"outline"})(a.status);return e.jsx(w,{className:"border-2 hover:border-primary/50 hover:shadow-md transition-all duration-200",children:e.jsx(k,{className:"p-5",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-base mb-2 text-foreground",children:a.orderNumber}),e.jsx("p",{className:"text-xs text-muted-foreground",children:C(a.createdAt)})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[e.jsx(W,{variant:d.variant,className:"text-sm font-semibold px-3 py-1 whitespace-nowrap",children:d.label}),e.jsxs("span",{className:"font-bold text-base whitespace-nowrap text-foreground",children:["₺",(a.totalAmount||0).toLocaleString("tr-TR")]})]})]})})},a.id)})})]}),e.jsxs(R,{value:"notes",className:"space-y-4 mt-6 focus:outline-none overflow-x-hidden max-w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl md:text-2xl font-bold text-foreground",children:["Notlar (",h.length,")"]}),e.jsxs(p,{size:"sm",onClick:()=>M(!0),className:"font-semibold shadow-md hover:shadow-lg transition-all duration-200",children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Not Ekle"}),e.jsx("span",{className:"sm:hidden",children:"Ekle"})]})]}),S?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(B,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Yükleniyor..."})]}):h.length===0?e.jsx(w,{className:"border-2 border-dashed",children:e.jsxs(k,{className:"p-12 text-center",children:[e.jsx(pe,{className:"h-12 w-12 text-muted-foreground/50 mx-auto mb-4"}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Henüz not bulunmuyor"})]})}):e.jsx("div",{className:"space-y-3",children:h.map(a=>{const t=ve(a.type);return e.jsx(w,{className:"border-2 hover:border-primary/50 hover:shadow-md transition-all duration-200",children:e.jsxs(k,{className:"p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-9 w-9 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(t,{className:"h-4 w-4 text-primary"})}),e.jsx(W,{variant:"outline",className:"text-xs font-semibold flex-shrink-0",children:be(a.type)}),e.jsx("p",{className:"font-bold text-sm text-foreground truncate",children:a.title})]}),e.jsx("p",{className:"text-xs text-muted-foreground flex-shrink-0 whitespace-nowrap",children:C(a.createdAt)})]}),e.jsx("p",{className:"text-sm text-foreground whitespace-pre-wrap break-words leading-relaxed pl-12",children:a.content})]})},a.id)})})]})]})]})})})]}),e.jsx(Ye,{open:ge,onOpenChange:H,children:e.jsxs($e,{children:[e.jsxs(We,{children:[e.jsx(Xe,{children:"Müşteriyi sil?"}),e.jsx(Ze,{children:"Bu işlem geri alınamaz. Müşteri kalıcı olarak silinecek."})]}),e.jsxs(Je,{children:[e.jsx(Ie,{children:"İptal"}),e.jsx(es,{onClick:Ne,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Sil"})]})]})}),e.jsx(me,{open:ue,onOpenChange:M,children:e.jsxs(oe,{className:"rounded-2xl",children:[e.jsxs(ce,{children:[e.jsx(xe,{className:"text-xl font-bold",children:"Not Ekle"}),e.jsx(he,{className:"text-sm",children:"Müşteri için yeni bir not ekleyin. Telefon görüşmeleri, arıza kayıtları veya genel notlar ekleyebilirsiniz."})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-sm font-semibold",children:"Not Tipi"}),e.jsxs(Oe,{value:c.type,onValueChange:a=>z({...c,type:a}),children:[e.jsx(Be,{className:"h-11",children:e.jsx(Le,{})}),e.jsxs(Re,{children:[e.jsx(P,{value:"phone_call_out",children:"Telefonla Aradık"}),e.jsx(P,{value:"phone_call_in",children:"Bizi Aradı"}),e.jsx(P,{value:"warranty",children:"Arıza Kaydı"}),e.jsx(P,{value:"general",children:"Genel Not"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-sm font-semibold",children:"Başlık *"}),e.jsx(T,{value:c.title,onChange:a=>z({...c,title:a.target.value}),placeholder:"Not başlığı",className:"h-11"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"text-sm font-semibold",children:"İçerik *"}),e.jsx($,{value:c.content,onChange:a=>z({...c,content:a.target.value}),placeholder:"Not içeriği",rows:5,className:"resize-none"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(p,{variant:"outline",onClick:()=>M(!1),className:"font-semibold",children:"İptal"}),e.jsx(p,{onClick:je,className:"font-semibold shadow-md hover:shadow-lg transition-all duration-200",children:"Ekle"})]})]})})]})}):null};export{As as C};

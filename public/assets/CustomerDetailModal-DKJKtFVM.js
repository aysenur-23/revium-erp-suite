var ve=Object.defineProperty,we=Object.defineProperties;var ye=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var ke=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable;var le=(n,r,s)=>r in n?ve(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s,x=(n,r)=>{for(var s in r||(r={}))ke.call(r,s)&&le(n,s,r[s]);if(te)for(var s of te(r))De.call(r,s)&&le(n,s,r[s]);return n},h=(n,r)=>we(n,ye(r));var D=(n,r,s)=>new Promise((M,T)=>{var p=d=>{try{S(s.next(d))}catch(A){T(A)}},_=d=>{try{S(s.throw(d))}catch(A){T(A)}},S=d=>d.done?M(d.value):Promise.resolve(d.value).then(p,_);S((s=s.apply(n,r)).next())});import{u as Ce,w as P,a as f,j as e,B as u,x as Te,m as _e,n as Se,o as U,y as V,C as w,b as y,L as g,I as C,S as Ae,c as ze,d as Fe,e as Me,f as K,z as Be}from"./index-BQmY0BmM.js";import{g as Ee,D as re,a as ie,b as ne,c as de,e as q,T as J,B as W,s as Oe,v as Re,t as Le}from"./MainLayout-Dv9j77B5.js";import{S as me}from"./separator-C1rUq6WW.js";import{r as m,l as oe,N as X,K as Z,S as Pe,T as Ue,X as Ve,m as Q,I as Ke,o as ce,q as Qe,Q as I,i as He,J as Ye,R as Ge,V as $e,W as qe,P as Je,M as xe,s as We,Y as Xe,Z as Ze}from"./lucide-react-CAeuRJQk.js";import{g as Ie,c as es}from"./CreateCustomerDialog-C7Uvoya8.js";import{getSavedReports as ss}from"./reportService-yUgxtgcG.js";import{A as as,a as ts,b as ls,c as rs,d as is,e as ns,f as ds,g as ms}from"./alert-dialog-vDPnsgl6.js";import{f as os}from"./format-CN3feEER.js";const bs=({open:n,onOpenChange:r,customer:s,onUpdate:M,onDelete:T})=>{const{user:p}=Ce(),[_,S]=m.useState([]),[d,A]=m.useState([]),[b,he]=m.useState([]),[B,ee]=m.useState(!1),[fe,E]=m.useState(!1),[c,O]=m.useState({type:"general",title:"",content:""}),[k,R]=m.useState(!1),[H,se]=m.useState(!1),[pe,Y]=m.useState(!1),[l,j]=m.useState({name:"",email:"",phone:"",company:"",address:"",tax_number:"",notes:""});m.useEffect(()=>{n&&(s!=null&&s.id)&&(G(),R(!1))},[n,s==null?void 0:s.id]),m.useEffect(()=>{s&&!k&&j({name:s.name||"",email:s.email||"",phone:P(s.phone)||"",company:s.company||"",address:s.address||"",tax_number:s.taxId||s.tax_number||s.tax_id||"",notes:s.notes||""})},[s,k]);const G=()=>D(void 0,null,function*(){if(s!=null&&s.id){ee(!0);try{const[a,t,o]=yield Promise.all([Ie(s.id),ss({reportType:"sales_quote"}),Ee({customerId:s.id})]);S(a);const N=t.filter(v=>{const i=v.metadata;return(i==null?void 0:i.customerId)===s.id});A(N),he(o)}catch(a){f.error("Veriler yüklenirken hata: "+a.message)}finally{ee(!1)}}}),ue=()=>D(void 0,null,function*(){if(!(!(s!=null&&s.id)||!(p!=null&&p.id))){if(!c.title.trim()||!c.content.trim()){f.error("Başlık ve içerik gereklidir");return}try{yield es({customerId:s.id,type:c.type,title:c.title.trim(),content:c.content.trim(),createdBy:p.id}),f.success("Not eklendi"),E(!1),O({type:"general",title:"",content:""}),G()}catch(a){f.error("Not eklenirken hata: "+a.message)}}}),ae=a=>D(void 0,null,function*(){if(a.preventDefault(),!(!(s!=null&&s.id)||!(p!=null&&p.id))){if(!l.name.trim()){f.error("İsim gereklidir");return}se(!0);try{yield Oe(s.id,{name:l.name.trim(),company:l.company.trim()||null,email:l.email.trim()||null,phone:Be(l.phone),address:l.address.trim()||null,taxId:l.tax_number.trim()||null,notes:l.notes.trim()||null},p.id),f.success("Müşteri başarıyla güncellendi"),R(!1),M&&M(),G()}catch(t){console.error("Update customer error:",t),f.error(t.message||"Müşteri güncellenirken hata oluştu")}finally{se(!1)}}}),ge=()=>D(void 0,null,function*(){if(s!=null&&s.id)try{yield Re(s.id),f.success("Müşteri silindi"),Y(!1),r(!1),T&&T()}catch(a){console.error("Delete customer error:",a),f.error(a.message||"Müşteri silinirken hata oluştu")}}),je=a=>{switch(a){case"phone_call_out":return"Telefonla Aradık";case"phone_call_in":return"Bizi Aradı";case"warranty":return"Arıza Kaydı";case"general":return"Genel Not";default:return a}},Ne=a=>{switch(a){case"phone_call_out":return Ze;case"phone_call_in":return Xe;case"warranty":return We;case"general":return xe;default:return I}},L=m.useMemo(()=>{const a=b.length,t=b.reduce((i,F)=>i+(F.totalAmount||0),0),o=d.length,N=d.reduce((i,F)=>{const $=F.metadata;return i+(($==null?void 0:$.grandTotal)||0)},0),v=b.filter(i=>i.status==="completed"||i.status==="delivered").length;return{totalOrders:a,totalOrderAmount:t,totalQuotes:o,totalQuoteAmount:N,completedOrders:v}},[b,d]),be=a=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:2}).format(a),z=a=>{if(!a)return"-";try{let t;if(a!=null&&a.toDate&&typeof a.toDate=="function")t=a.toDate();else if(a!=null&&a.seconds)t=new Date(a.seconds*1e3);else if(a!=null&&a.nanoseconds)t=new Date(a.seconds*1e3+a.nanoseconds/1e6);else if(a instanceof Date)t=a;else if(typeof a=="string"){const o=new Date(a);if(!Number.isNaN(o.getTime()))t=o;else return"-"}else typeof a=="number"?t=new Date(a):t=new Date(a);return Number.isNaN(t.getTime())?"-":os(t,"dd MMM yyyy",{locale:Le})}catch(t){return console.error("Date formatting error:",t,a),"-"}};return s?e.jsx(re,{open:n,onOpenChange:r,children:e.jsxs(ie,{className:"!max-w-[100vw] sm:!max-w-[95vw] !w-[100vw] sm:!w-[95vw] !h-[100vh] sm:!h-[90vh] !max-h-[100vh] sm:!max-h-[90vh] !left-0 sm:!left-[2.5vw] !top-0 sm:!top-[5vh] !right-0 sm:!right-auto !bottom-0 sm:!bottom-auto !translate-x-0 !translate-y-0 overflow-hidden !p-0 gap-0 bg-white flex flex-col !m-0 !rounded-none sm:!rounded-lg !border-0 sm:!border",children:[e.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[e.jsx(ne,{className:"p-3 sm:p-4 border-b bg-white flex-shrink-0 relative pr-12 sm:pr-16",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-8 w-8 sm:h-10 sm:w-10 rounded-lg bg-primary/10 flex items-center justify-center border border-primary/20 flex-shrink-0",children:e.jsx(oe,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(de,{className:"text-lg sm:text-xl font-semibold text-foreground truncate",children:k?"Müşteri Düzenle":s.name}),!k&&s.company?e.jsx(q,{className:"text-xs text-muted-foreground truncate mt-0.5",children:s.company}):e.jsx(q,{className:"sr-only",children:"Müşteri detayları ve bilgileri"})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 flex-shrink-0",children:k?e.jsxs(e.Fragment,{children:[e.jsxs(u,{variant:"outline",size:"sm",className:"border-primary/20 hover:bg-primary/5 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0",onClick:()=>{R(!1),j({name:s.name||"",email:s.email||"",phone:P(s.phone)||"",company:s.company||"",address:s.address||"",tax_number:s.taxId||s.tax_number||s.tax_id||"",notes:s.notes||""})},disabled:H,children:[e.jsx(Ve,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"İptal"]}),e.jsxs(u,{variant:"default",size:"sm",className:"bg-primary hover:bg-primary/90 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0 text-white",onClick:ae,disabled:H,children:[H?e.jsx(Q,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0 animate-spin"}):e.jsx(Ke,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Kaydet"]})]}):e.jsxs(e.Fragment,{children:[s.email&&e.jsxs(u,{variant:"secondary",size:"sm",className:"bg-primary/10 text-primary hover:bg-primary/20 rounded-lg px-3 py-1.5 font-medium shadow-sm text-xs sm:text-sm flex-shrink-0",onClick:()=>window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(s.email)}`,"_blank"),"aria-label":"E-posta gönder",children:[e.jsx(X,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Mail"]}),s.phone&&e.jsxs(u,{variant:"outline",size:"sm",className:"border-primary/20 hover:bg-primary/5 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0",onClick:()=>window.location.href=`tel:${Te(s.phone)}`,"aria-label":"Telefon ara",children:[e.jsx(Z,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Ara"]}),e.jsxs(u,{variant:"outline",size:"sm",className:"border-primary/20 hover:bg-primary/5 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0",onClick:()=>R(!0),children:[e.jsx(Pe,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Düzenle"]}),e.jsxs(u,{variant:"outline",size:"sm",className:"border-destructive/20 hover:bg-destructive/5 text-destructive rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0",onClick:()=>Y(!0),children:[e.jsx(Ue,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Sil"]})]})})]})}),(s.email||s.phone||s.tax_number||s.taxId||s.tax_id)&&e.jsxs("div",{className:"px-3 sm:px-6 py-2 sm:py-3 border-b bg-gray-50/50 flex flex-wrap items-center gap-2 flex-shrink-0",children:[s.email&&e.jsxs("div",{className:"flex items-center gap-1 rounded-full border bg-muted/40 px-3 py-1.5 text-xs font-medium text-muted-foreground",children:[e.jsx(X,{className:"h-3 w-3"}),e.jsx("span",{className:"text-muted-foreground/70",children:"E-posta:"}),e.jsx("span",{className:"text-foreground truncate max-w-[200px]",children:s.email})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-1 rounded-full border bg-muted/40 px-3 py-1.5 text-xs font-medium text-muted-foreground",children:[e.jsx(Z,{className:"h-3 w-3"}),e.jsx("span",{className:"text-muted-foreground/70",children:"Telefon:"}),e.jsx("span",{className:"text-foreground",children:P(s.phone)})]}),(s.tax_number||s.taxId||s.tax_id)&&e.jsxs("div",{className:"flex items-center gap-1 rounded-full border bg-muted/40 px-3 py-1.5 text-xs font-medium text-muted-foreground",children:[e.jsx("span",{className:"text-muted-foreground/70",children:"Vergi No:"}),e.jsx("span",{className:"text-foreground",children:s.tax_number||s.taxId||s.tax_id})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden bg-gray-50/50 p-3 sm:p-4 min-h-0",children:e.jsx("div",{className:"max-w-full mx-auto h-full overflow-y-auto",children:B?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx("div",{className:"rounded-2xl border bg-gradient-to-br from-primary/10 via-white to-white border-primary/20 text-card-foreground p-4 shadow-sm transition hover:shadow-md hover:-translate-y-0.5 flex flex-col h-full",children:e.jsxs("div",{className:"flex items-start justify-between flex-1",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-muted-foreground mb-1",children:"Toplam Sipariş"}),e.jsx("p",{className:"text-2xl font-semibold leading-tight",children:L.totalOrders})]}),e.jsx("div",{className:"rounded-full border p-2 bg-white/75 shadow-inner shrink-0 ml-2",children:e.jsx(ce,{className:"h-5 w-5 text-primary"})})]})}),e.jsx("div",{className:"rounded-2xl border bg-gradient-to-br from-emerald-50/80 via-white to-white border-emerald-100 text-card-foreground p-4 shadow-sm transition hover:shadow-md hover:-translate-y-0.5 flex flex-col h-full",children:e.jsxs("div",{className:"flex items-start justify-between flex-1",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-muted-foreground mb-1",children:"Sipariş Tutarı"}),e.jsx("p",{className:"text-2xl font-semibold leading-tight",children:be(L.totalOrderAmount)})]}),e.jsx("div",{className:"rounded-full border p-2 bg-white/75 shadow-inner shrink-0 ml-2",children:e.jsx(Qe,{className:"h-5 w-5 text-emerald-600"})})]})}),e.jsx("div",{className:"rounded-2xl border bg-gradient-to-br from-blue-50/80 via-white to-white border-blue-100 text-card-foreground p-4 shadow-sm transition hover:shadow-md hover:-translate-y-0.5 flex flex-col h-full",children:e.jsxs("div",{className:"flex items-start justify-between flex-1",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-muted-foreground mb-1",children:"Fiyat Teklifleri"}),e.jsx("p",{className:"text-2xl font-semibold leading-tight",children:L.totalQuotes})]}),e.jsx("div",{className:"rounded-full border p-2 bg-white/75 shadow-inner shrink-0 ml-2",children:e.jsx(I,{className:"h-5 w-5 text-blue-600"})})]})}),e.jsx("div",{className:"rounded-2xl border bg-gradient-to-br from-amber-50/80 via-white to-white border-amber-100 text-card-foreground p-4 shadow-sm transition hover:shadow-md hover:-translate-y-0.5 flex flex-col h-full",children:e.jsxs("div",{className:"flex items-start justify-between flex-1",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-muted-foreground mb-1",children:"Tamamlanan"}),e.jsx("p",{className:"text-2xl font-semibold leading-tight",children:L.completedOrders})]}),e.jsx("div",{className:"rounded-full border p-2 bg-white/75 shadow-inner shrink-0 ml-2",children:e.jsx(He,{className:"h-5 w-5 text-amber-600"})})]})})]}),e.jsxs(_e,{defaultValue:"info",className:"w-full overflow-x-hidden max-w-full px-3 sm:px-4 md:px-6 lg:px-12",children:[e.jsxs(Se,{className:"grid w-full grid-cols-4 h-auto sm:h-10 md:h-11 bg-muted/50 rounded-lg p-1 border gap-1",children:[e.jsx(U,{value:"info",className:"rounded-md data-[state=active]:bg-background data-[state=active]:shadow-sm data-[state=active]:text-primary text-xs md:text-sm font-medium transition-all duration-200 min-h-[44px] sm:min-h-0",children:"Bilgiler"}),e.jsx(U,{value:"quotes",className:"rounded-md data-[state=active]:bg-background data-[state=active]:shadow-sm data-[state=active]:text-primary text-xs md:text-sm font-medium transition-all duration-200 min-h-[44px] sm:min-h-0",children:"Fiyat Teklifleri"}),e.jsx(U,{value:"orders",className:"rounded-md data-[state=active]:bg-background data-[state=active]:shadow-sm data-[state=active]:text-primary text-xs md:text-sm font-medium transition-all duration-200 min-h-[44px] sm:min-h-0",children:"Siparişler"}),e.jsx(U,{value:"notes",className:"rounded-md data-[state=active]:bg-background data-[state=active]:shadow-sm data-[state=active]:text-primary text-xs md:text-sm font-medium transition-all duration-200 min-h-[44px] sm:min-h-0",children:"Notlar"})]}),e.jsx(V,{value:"info",className:"space-y-4 sm:space-y-6 mt-4 sm:mt-6 focus:outline-none overflow-x-hidden max-w-full",children:k?e.jsx("form",{onSubmit:ae,className:"space-y-4 sm:space-y-6",children:e.jsx(w,{children:e.jsxs(y,{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-1",children:"Müşteri Bilgileri"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Temel müşteri bilgilerini güncelleyin"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"name",showRequired:!0,className:"text-sm sm:text-base",children:"İsim"}),e.jsx(C,{id:"name",value:l.name,onChange:a=>j(h(x({},l),{name:a.target.value})),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"company",className:"text-sm sm:text-base",children:"Şirket"}),e.jsx(C,{id:"company",value:l.company,onChange:a=>j(h(x({},l),{company:a.target.value})),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"email",className:"text-sm sm:text-base",children:"E-posta"}),e.jsx(C,{id:"email",type:"email",value:l.email,onChange:a=>j(h(x({},l),{email:a.target.value})),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"phone",className:"text-sm sm:text-base",children:"Telefon"}),e.jsx(C,{id:"phone",value:l.phone,onChange:a=>j(h(x({},l),{phone:a.target.value})),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"address",className:"text-sm sm:text-base",children:"Adres"}),e.jsx(J,{id:"address",value:l.address,onChange:a=>j(h(x({},l),{address:a.target.value})),rows:3,className:"min-h-[44px] sm:min-h-0 resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"tax_number",className:"text-sm sm:text-base",children:"Vergi No"}),e.jsx(C,{id:"tax_number",value:l.tax_number,onChange:a=>j(h(x({},l),{tax_number:a.target.value})),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"notes",className:"text-sm sm:text-base",children:"Notlar"}),e.jsx(J,{id:"notes",value:l.notes,onChange:a=>j(h(x({},l),{notes:a.target.value})),rows:4,className:"min-h-[44px] sm:min-h-0 resize-none",placeholder:"Müşteri hakkında notlar..."})]})]})})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(oe,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-0.5",children:"İsim"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.name})]})]}),s.company&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ye,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-0.5",children:"Şirket"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.company})]})]}),s.email&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(X,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-0.5",children:"E-posta"}),e.jsx("p",{className:"text-sm text-muted-foreground break-all",children:s.email})]})]}),s.phone&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Z,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-0.5",children:"Telefon"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:P(s.phone)})]})]}),(s.tax_number||s.taxId||s.tax_id)&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ge,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-0.5",children:"Vergi No"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.tax_number||s.taxId||s.tax_id})]})]})]}),s.address&&e.jsxs(e.Fragment,{children:[e.jsx(me,{}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx($e,{className:"h-5 w-5 text-muted-foreground mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground mb-0.5",children:"Adres"}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap break-words leading-relaxed",children:s.address})]})]})]}),e.jsx(me,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide mb-1.5",children:"Oluşturma Tarihi"}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:z(s.createdAt||s.created_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide mb-1.5",children:"Son Güncelleme"}),e.jsx("p",{className:"text-sm font-medium text-foreground",children:z(s.updatedAt||s.updated_at)})]})]})]})}),e.jsxs(V,{value:"quotes",className:"space-y-3 sm:space-y-4 mt-4 sm:mt-6 focus:outline-none overflow-x-hidden max-w-full",children:[e.jsx("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:e.jsxs("h3",{className:"text-lg sm:text-xl md:text-2xl font-bold text-foreground",children:["Fiyat Teklifleri (",d.length,")"]})}),B?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(Q,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Yükleniyor..."})]}):d.length===0?e.jsx(w,{className:"border-2 border-dashed",children:e.jsxs(y,{className:"p-12 text-center",children:[e.jsx(I,{className:"h-12 w-12 text-muted-foreground/50 mx-auto mb-4"}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Henüz teklif bulunmuyor"})]})}):e.jsx("div",{className:"space-y-3",children:d.map(a=>{var t;return e.jsx(w,{className:"border-2 hover:border-primary/50 hover:shadow-md transition-all duration-200",children:e.jsx(y,{className:"p-5",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-base mb-2 text-foreground",children:a.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:z(a.createdAt)})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[e.jsxs(W,{variant:"outline",className:"text-sm font-semibold px-3 py-1 whitespace-nowrap",children:["₺",(((t=a.metadata)==null?void 0:t.grandTotal)||0).toLocaleString("tr-TR")]}),e.jsxs(u,{size:"sm",variant:"outline",className:"font-semibold",onClick:()=>D(void 0,null,function*(){try{if(!a.fileUrl){f.error("Dosya bağlantısı bulunamadı");return}const N=yield(yield fetch(a.fileUrl)).blob(),v=window.URL.createObjectURL(N),i=document.createElement("a");i.href=v;const F=a.fileName||`${a.title||"teklif"}.pdf`;i.download=F,document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(v),document.body.removeChild(i)}catch(o){console.error("Download error:",o),a.fileUrl?window.open(a.fileUrl,"_blank"):f.error("Dosya bağlantısı bulunamadı")}}),children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"İndir"]})]})]})})},a.id)})})]}),e.jsxs(V,{value:"orders",className:"space-y-4 mt-6 focus:outline-none overflow-x-hidden max-w-full",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("h3",{className:"text-xl md:text-2xl font-bold text-foreground",children:["Siparişler (",b.length,")"]})}),B?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(Q,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Yükleniyor..."})]}):b.length===0?e.jsx(w,{className:"border-2 border-dashed",children:e.jsxs(y,{className:"p-12 text-center",children:[e.jsx(ce,{className:"h-12 w-12 text-muted-foreground/50 mx-auto mb-4"}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Henüz sipariş bulunmuyor"})]})}):e.jsx("div",{className:"space-y-3",children:b.map(a=>{const o=(N=>({pending:{label:"Beklemede",variant:"outline"},in_progress:{label:"Üretimde",variant:"default"},quality_check:{label:"Kalite Kontrol",variant:"secondary"},completed:{label:"Tamamlandı",variant:"default"},delivered:{label:"Teslim Edildi",variant:"default"},cancelled:{label:"İptal",variant:"destructive"}})[N]||{label:N,variant:"outline"})(a.status);return e.jsx(w,{className:"border-2 hover:border-primary/50 hover:shadow-md transition-all duration-200",children:e.jsx(y,{className:"p-5",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-base mb-2 text-foreground",children:a.orderNumber}),e.jsx("p",{className:"text-xs text-muted-foreground",children:z(a.createdAt)})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[e.jsx(W,{variant:o.variant,className:"text-sm font-semibold px-3 py-1 whitespace-nowrap",children:o.label}),e.jsxs("span",{className:"font-bold text-base whitespace-nowrap text-foreground",children:["₺",(a.totalAmount||0).toLocaleString("tr-TR")]})]})]})})},a.id)})})]}),e.jsxs(V,{value:"notes",className:"space-y-4 mt-6 focus:outline-none overflow-x-hidden max-w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl md:text-2xl font-bold text-foreground",children:["Notlar (",_.length,")"]}),e.jsxs(u,{size:"sm",onClick:()=>E(!0),className:"font-semibold shadow-md hover:shadow-lg transition-all duration-200",children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Not Ekle"}),e.jsx("span",{className:"sm:hidden",children:"Ekle"})]})]}),B?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx(Q,{className:"h-8 w-8 animate-spin text-primary mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Yükleniyor..."})]}):_.length===0?e.jsx(w,{className:"border-2 border-dashed",children:e.jsxs(y,{className:"p-12 text-center",children:[e.jsx(xe,{className:"h-12 w-12 text-muted-foreground/50 mx-auto mb-4"}),e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Henüz not bulunmuyor"})]})}):e.jsx("div",{className:"space-y-3",children:_.map(a=>{const t=Ne(a.type);return e.jsx(w,{className:"border-2 hover:border-primary/50 hover:shadow-md transition-all duration-200",children:e.jsxs(y,{className:"p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-9 w-9 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0",children:e.jsx(t,{className:"h-4 w-4 text-primary"})}),e.jsx(W,{variant:"outline",className:"text-xs font-semibold flex-shrink-0",children:je(a.type)}),e.jsx("p",{className:"font-bold text-sm text-foreground truncate",children:a.title})]}),e.jsx("p",{className:"text-xs text-muted-foreground flex-shrink-0 whitespace-nowrap",children:z(a.createdAt)})]}),e.jsx("p",{className:"text-sm text-foreground whitespace-pre-wrap break-words leading-relaxed pl-12",children:a.content})]})},a.id)})})]})]})]})})})]}),e.jsx(as,{open:pe,onOpenChange:Y,children:e.jsxs(ts,{children:[e.jsxs(ls,{children:[e.jsx(rs,{children:"Müşteriyi sil?"}),e.jsx(is,{children:"Bu işlem geri alınamaz. Müşteri kalıcı olarak silinecek."})]}),e.jsxs(ns,{children:[e.jsx(ds,{children:"İptal"}),e.jsx(ms,{onClick:ge,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Sil"})]})]})}),e.jsx(re,{open:fe,onOpenChange:E,children:e.jsxs(ie,{className:"rounded-2xl",children:[e.jsxs(ne,{children:[e.jsx(de,{className:"text-xl font-bold",children:"Not Ekle"}),e.jsx(q,{className:"text-sm",children:"Müşteri için yeni bir not ekleyin. Telefon görüşmeleri, arıza kayıtları veya genel notlar ekleyebilirsiniz."})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{className:"text-sm font-semibold",children:"Not Tipi"}),e.jsxs(Ae,{value:c.type,onValueChange:a=>O(h(x({},c),{type:a})),children:[e.jsx(ze,{className:"h-11",children:e.jsx(Fe,{})}),e.jsxs(Me,{children:[e.jsx(K,{value:"phone_call_out",children:"Telefonla Aradık"}),e.jsx(K,{value:"phone_call_in",children:"Bizi Aradı"}),e.jsx(K,{value:"warranty",children:"Arıza Kaydı"}),e.jsx(K,{value:"general",children:"Genel Not"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{className:"text-sm font-semibold",children:"Başlık *"}),e.jsx(C,{value:c.title,onChange:a=>O(h(x({},c),{title:a.target.value})),placeholder:"Not başlığı",className:"h-11"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{className:"text-sm font-semibold",children:"İçerik *"}),e.jsx(J,{value:c.content,onChange:a=>O(h(x({},c),{content:a.target.value})),placeholder:"Not içeriği",rows:5,className:"resize-none"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(u,{variant:"outline",onClick:()=>E(!1),className:"font-semibold",children:"İptal"}),e.jsx(u,{onClick:ue,className:"font-semibold shadow-md hover:shadow-lg transition-all duration-200",children:"Ekle"})]})]})})]})}):null};export{bs as C};

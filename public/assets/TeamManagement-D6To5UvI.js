var rt=Object.defineProperty,nt=Object.defineProperties;var it=Object.getOwnPropertyDescriptors;var gs=Object.getOwnPropertySymbols;var ct=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;var Ns=(a,i,k)=>i in a?rt(a,i,{enumerable:!0,configurable:!0,writable:!0,value:k}):a[i]=k,ss=(a,i)=>{for(var k in i||(i={}))ct.call(i,k)&&Ns(a,k,i[k]);if(gs)for(var k of gs(i))dt.call(i,k)&&Ns(a,k,i[k]);return a},ts=(a,i)=>nt(a,it(i));var P=(a,i,k)=>new Promise((S,w)=>{var g=N=>{try{p(k.next(N))}catch(f){w(f)}},T=N=>{try{p(k.throw(N))}catch(f){w(f)}},p=N=>N.done?S(N.value):Promise.resolve(N.value).then(g,T);p((k=k.apply(a,i)).next())});import{D as Ps,E as He,A as ot,G as mt,H as Ms,r as Te,ac as Ls,T as ye,O as Us,Q as Os,N as Gs,J as qs,u as Pe,a as Y,j as e,C as B,b as E,B as W,L as Fs,I as xt,k as We,R as as,a3 as pt,m as zs,n as $s,o as he,y as fe,S as Ks,c as _s,d as Hs,e as Ws,f as $e,w as vs,p as be,q as we,a2 as ut}from"./index-BQmY0BmM.js";import{r as m,m as ue,n as is,X as Ys,h as Ie,i as ge,B as ls,e as ht,C as Qs,U as Ke,Q as _e,a0 as ft,a2 as jt,ao as cs,j as Vs,J as ds,t as ys,N as bs,K as ws,q as Re,W as rs,f as Js,p as Xs,ap as gt,aq as Nt,v as Ts}from"./lucide-react-CAeuRJQk.js";import{B as J,D as os,a as ms,b as xs,c as ps,e as us,T as vt,k as Zs,t as Ds,M as yt}from"./MainLayout-Dv9j77B5.js";import{A as bt,a as wt,b as Tt,c as Dt,d as kt,e as St,f as At,g as Rt}from"./alert-dialog-vDPnsgl6.js";import{A as Ce,a as Be,b as ks}from"./avatar-CROuoa6p.js";import{b as Ne,a as Ct,c as hs,y as Bt,x as Et}from"./taskService-CI62TrOj.js";import{T as It}from"./TaskInlineForm-BjPlHrJk.js";import{i as Ee,a as et}from"./isBefore-DY2_5hKP.js";import{s as st,f as Ss}from"./format-CN3feEER.js";import{a as tt}from"./addDays-DpNspVkx.js";import{g as As}from"./pdfGenerator-CpYttanq.js";import{S as Pt}from"./search-input-DCf0xYml.js";import{T as Rs,a as Cs,b as me,c as je,d as Bs,e as G}from"./table-zhTdMUM_.js";import{getRoles as Mt}from"./rolePermissionsService-BQ7cNajw.js";import{D as Lt,A as Ut}from"./DepartmentDetailModal-CjqXK3b9.js";import{P as ns}from"./progress-DCzQFBA2.js";import{S as Es}from"./skeleton-jcdN6-ik.js";import{s as Ot}from"./subDays-DIU4Ell8.js";import"./storageService-BUAGZT8Z.js";import"./driveService-ChwQKMyd.js";import"./checkbox-DKBysPlW.js";import"./UserMultiSelect-BycFT8u0.js";import"./popover-Bq_PZ6uK.js";import"./permissions-gaCIgPOa.js";const at=a=>P(void 0,null,function*(){try{const i=Ps(He,"departments"),k=ot(i,mt("managerId","==",a)),w=(yield Ms(k)).docs.map(p=>p.id);if(w.length===0)return[];const g=yield Te(),T=[];for(const p of g)if(p.pendingTeams&&p.pendingTeams.length>0){for(const N of p.pendingTeams)if(w.includes(N)){const f=yield Ls(N);f&&T.push({userId:p.id,userName:p.fullName||p.displayName||p.email,userEmail:p.email,teamId:N,teamName:f.name,requestedAt:p.createdAt||ye.now(),status:"pending"})}}return T.sort((p,N)=>{var K,U;const f=((K=p.requestedAt)==null?void 0:K.toMillis())||0;return(((U=N.requestedAt)==null?void 0:U.toMillis())||0)-f})}catch(i){throw console.error("Get pending team requests error:",i),i}}),lt=()=>P(void 0,null,function*(){try{const a=Ps(He,"departments"),i=yield Ms(a),k=new Set;i.docs.forEach(g=>{const T=g.data();T.managerId&&T.managerId.trim()!==""&&k.add(g.id)});const S=yield Te(),w=[];for(const g of S)if(g.pendingTeams&&g.pendingTeams.length>0){for(const T of g.pendingTeams)if(!k.has(T)){const p=yield Ls(T);p&&w.push({userId:g.id,userName:g.fullName||g.displayName||g.email,userEmail:g.email,teamId:T,teamName:p.name,requestedAt:g.createdAt||ye.now(),status:"pending"})}}return w.sort((g,T)=>{var f,M;const p=((f=g.requestedAt)==null?void 0:f.toMillis())||0;return(((M=T.requestedAt)==null?void 0:M.toMillis())||0)-p})}catch(a){throw console.error("Get all pending team requests error:",a),a}}),Gt=(a,i,k)=>P(void 0,null,function*(){try{const S=Us(He,"users",a),w=yield Os(S);if(!w.exists())throw new Error("Kullanıcı bulunamadı");const g=w.data(),T=g.pendingTeams||[],p=g.approvedTeams||[];if(!T.includes(i))throw new Error("Bu ekip talebi bulunamadı");const N=T.filter(M=>M!==i),f=[...p,i];yield Gs(S,{pendingTeams:N,approvedTeams:f,updatedAt:qs()})}catch(S){throw console.error("Approve team request error:",S),S}}),qt=(a,i,k)=>P(void 0,null,function*(){try{const S=Us(He,"users",a),w=yield Os(S);if(!w.exists())throw new Error("Kullanıcı bulunamadı");const T=w.data().pendingTeams||[];if(!T.includes(i))throw new Error("Bu ekip talebi bulunamadı");const p=T.filter(N=>N!==i);yield Gs(S,{pendingTeams:p,updatedAt:qs()})}catch(S){throw console.error("Reject team request error:",S),S}}),Ft=()=>{const{user:a,isAdmin:i}=Pe(),[k,S]=m.useState(!0),[w,g]=m.useState([]),[T,p]=m.useState(!1),[N,f]=m.useState(null),[M,K]=m.useState("");m.useEffect(()=>{U()},[a]);const U=()=>P(void 0,null,function*(){if(a!=null&&a.id){S(!0);try{let b;i?b=yield lt():b=yield at(a.id),g(b)}catch(b){Y.error("Talepler yüklenirken hata: "+b.message)}finally{S(!1)}}}),X=b=>P(void 0,null,function*(){try{yield Gt(b.userId,b.teamId,(a==null?void 0:a.id)||""),Y.success(`${b.userName} kullanıcısı ${b.teamName} ekibine onaylandı`),U()}catch(O){Y.error("Onaylama hatası: "+O.message)}}),se=()=>P(void 0,null,function*(){if(N)try{yield qt(N.userId,N.teamId,M),Y.success(`${N.userName} kullanıcısının ${N.teamName} ekibi talebi reddedildi`),p(!1),f(null),K(""),U()}catch(b){Y.error("Reddetme hatası: "+b.message)}}),q=b=>{f(b),p(!0)};return k?e.jsx(B,{children:e.jsx(E,{className:"flex items-center justify-center py-8",children:e.jsx(ue,{className:"h-6 w-6 animate-spin text-primary"})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{children:e.jsxs(E,{className:"pt-6",children:[w.length>0&&e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsxs(J,{variant:"secondary",children:[w.length," bekleyen talep"]})}),w.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Onay bekleyen ekip talebi yok"}):e.jsx("div",{className:"space-y-3",children:w.map(b=>{var O;return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"font-semibold",children:b.userName}),e.jsx(J,{variant:"outline",children:b.teamName})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:b.userEmail}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Talep tarihi: ",(O=b.requestedAt)==null?void 0:O.toDate().toLocaleDateString("tr-TR")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(W,{size:"sm",variant:"default",onClick:()=>X(b),className:"gap-2",children:[e.jsx(is,{className:"h-4 w-4"}),"Onayla"]}),e.jsxs(W,{size:"sm",variant:"destructive",onClick:()=>q(b),className:"gap-2",children:[e.jsx(Ys,{className:"h-4 w-4"}),"Reddet"]})]})]},`${b.userId}-${b.teamId}`)})})]})}),e.jsx(bt,{open:T,onOpenChange:p,children:e.jsxs(wt,{children:[e.jsxs(Tt,{children:[e.jsx(Dt,{children:"Ekip Talebini Reddet"}),e.jsx(kt,{children:N&&e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:N.userName})," kullanıcısının"," ",e.jsx("strong",{children:N.teamName})," ekibi talebini reddetmek istediğinizden emin misiniz?"]})})]}),e.jsxs("div",{className:"space-y-2 py-4",children:[e.jsx(Fs,{htmlFor:"reject-reason",children:"Red Nedeni (Opsiyonel)"}),e.jsx(xt,{id:"reject-reason",value:M,onChange:b=>K(b.target.value),placeholder:"Red nedeni..."})]}),e.jsxs(St,{children:[e.jsx(At,{children:"İptal"}),e.jsx(Rt,{onClick:se,className:"bg-destructive text-destructive-foreground",children:"Reddet"})]})]})})]})},Is=a=>{if(!a)return"Tarih yok";try{let i;if(a!=null&&a.toDate)i=a.toDate();else if(a instanceof Date)i=a;else if(typeof a=="string")i=new Date(a);else return"Geçersiz tarih";return isNaN(i.getTime())?"Geçersiz tarih":i.toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(i){return"Tarih hatası"}},zt=()=>{const{user:a,isAdmin:i,isTeamLeader:k}=Pe(),[S,w]=m.useState(!0),[g,T]=m.useState([]),[p,N]=m.useState([]),[f,M]=m.useState([]),[K,U]=m.useState({}),[X,se]=m.useState({}),[q,b]=m.useState({}),[O,$]=m.useState(null),[Q,A]=m.useState(!1),[r,ve]=m.useState(""),[ne,ee]=m.useState("pending"),[De,n]=m.useState(!1),[u,h]=m.useState(null),[I,F]=m.useState("pending"),[Z,re]=m.useState("edit"),[te,c]=m.useState(new Map),[ae,Me]=m.useState([]),[s,l]=m.useState({}),[o,d]=m.useState(new Set);m.useEffect(()=>{x()},[a,i]);const x=()=>P(void 0,null,function*(){if(a!=null&&a.id){w(!0);try{const[t,R,ce,de,Le,Ue]=yield Promise.all([Ne({approvalStatus:"pending"}),Ne({approvalStatus:"approved"}),Ne({approvalStatus:"rejected"}),Te(),We(),Ct()]),Oe=new Map;Ue.forEach(v=>{Oe.set(v.id,v)}),c(Oe),Me(de);const ke=v=>{if(i)return v;const j=Le.filter(L=>L.managerId===a.id);if(j.length===0)return[];const oe=j.map(L=>L.id),pe=de.filter(L=>!!(L.approvedTeams&&L.approvedTeams.some(Ae=>oe.includes(Ae))||L.pendingTeams&&L.pendingTeams.some(Ae=>oe.includes(Ae))||L.departmentId&&oe.includes(L.departmentId))).map(L=>L.id);return v.filter(L=>L.createdBy===a.id||L.approvalRequestedBy&&pe.includes(L.approvalRequestedBy))},Ze=ke(t),le=ke(R),Se=ke(ce),C=[...Ze,...le,...Se],H=yield Promise.all(C.map(v=>P(void 0,null,function*(){try{const oe=(yield hs(v.id)).map(pe=>{const L=de.find(Ae=>Ae.id===pe.assignedTo);return L?{id:L.id,full_name:L.fullName||L.displayName||L.email||"Bilinmeyen",email:L.email}:null}).filter(pe=>pe!==null);return ts(ss({},v),{assignedUsers:oe})}catch(j){return console.error(`Error fetching assignments for task ${v.id}:`,j),ts(ss({},v),{assignedUsers:[]})}}))),y=H.filter(v=>Ze.some(j=>j.id===v.id)),Ge=H.filter(v=>le.some(j=>j.id===v.id)),xe=H.filter(v=>Se.some(j=>j.id===v.id));T(y),N(Ge),M(xe);const qe={},Fe={},ze={};yield Promise.all(C.map(v=>P(void 0,null,function*(){if(v.approvalRequestedBy&&!qe[v.approvalRequestedBy])try{const j=yield as(v.approvalRequestedBy,!0);qe[v.approvalRequestedBy]=(j==null?void 0:j.fullName)||(j==null?void 0:j.email)||"Silinmiş Kullanıcı"}catch(j){qe[v.approvalRequestedBy]="Silinmiş Kullanıcı"}if(v.approvedBy&&!Fe[v.approvedBy])try{const j=yield as(v.approvedBy,!0);Fe[v.approvedBy]=(j==null?void 0:j.fullName)||(j==null?void 0:j.email)||"Silinmiş Kullanıcı"}catch(j){Fe[v.approvedBy]="Silinmiş Kullanıcı"}if(v.rejectedBy&&!ze[v.rejectedBy])try{const j=yield as(v.rejectedBy,!0);ze[v.rejectedBy]=(j==null?void 0:j.fullName)||(j==null?void 0:j.email)||"Silinmiş Kullanıcı"}catch(j){ze[v.rejectedBy]="Silinmiş Kullanıcı"}}))),U(qe),se(Fe),b(ze);const es={},js=new Set;for(const v of H){const j=v.assignedUsers||[];for(const oe of j){const pe=typeof oe=="string"?oe:oe.id;pe&&js.add(pe)}}yield Promise.all(Array.from(js).map(v=>P(void 0,null,function*(){try{const j=yield pt({userId:v,limit:10});es[v]=j}catch(j){console.error(`Error fetching logs for user ${v}:`,j),es[v]=[]}}))),l(es)}catch(t){console.error("Fetch tasks error:",t),Y.error("Görevler yüklenemedi")}finally{w(!1)}}}),D=t=>P(void 0,null,function*(){if(a!=null&&a.id)try{yield Et(t.id,a.id),Y.success("Görev onaylandı"),x()}catch(R){Y.error("Onaylama hatası: "+R.message)}}),_=()=>P(void 0,null,function*(){if(!(!O||!(a!=null&&a.id)))try{yield Bt(O.id,a.id,r||null),Y.success("Görev onayı reddedildi"),A(!1),$(null),ve(""),x()}catch(t){Y.error("Reddetme hatası: "+t.message)}}),z=t=>{h(t.id);const R=t.status==="cancelled"?"completed":t.status;F(R),re("edit"),n(!0)},ie=()=>{x()},Ye=t=>{switch(t){case"completed":return e.jsx(ge,{className:"h-5 w-5 text-success"});case"in_progress":return e.jsx(Ie,{className:"h-5 w-5 text-warning"});default:return e.jsx(Vs,{className:"h-5 w-5 text-muted-foreground"})}},Qe=t=>({pending:"Beklemede",in_progress:"Devam Ediyor",completed:"Tamamlandı",cancelled:"İptal"})[t]||t,V=t=>{if(!t.dueDate)return!1;let R;return t.dueDate instanceof ye||t.dueDate&&typeof t.dueDate=="object"&&"toDate"in t.dueDate?R=t.dueDate.toDate():R=new Date(t.dueDate),Ee(R,new Date)&&t.status!=="completed"},fs=t=>{if(!t.dueDate)return!1;let R;t.dueDate instanceof ye||t.dueDate&&typeof t.dueDate=="object"&&"toDate"in t.dueDate?R=t.dueDate.toDate():R=new Date(t.dueDate);const ce=st(new Date),de=tt(ce,3);return!V(t)&&(et(R,ce)||R.getTime()===ce.getTime())&&Ee(R,de)&&t.status!=="completed"},Ve=t=>{if(!t)return"-";try{let R;if(t instanceof ye)R=t.toDate();else if(typeof t=="string")R=new Date(t);else if(t&&typeof t=="object"&&"toDate"in t)R=t.toDate();else return"-";return R.toLocaleDateString("tr-TR",{day:"2-digit",month:"short"})}catch(R){return"-"}},Je=t=>t.split(" ").map(R=>R[0]).join("").toUpperCase().slice(0,2),Xe=(t,R=!0)=>{var Se;K[t.approvalRequestedBy||""];const ce=t.approvedBy?X[t.approvedBy]||"...":null,de=t.rejectedBy?q[t.rejectedBy]||"...":null,Le=t.approvedAt?Is(t.approvedAt):null,Ue=t.rejectedAt?Is(t.rejectedAt):null,Oe=V(t),ke=fs(t),le=(t.assignedUsers||[]).map(C=>{if(typeof C=="string"){const H=ae.find(y=>y.id===C);return H?{id:H.id,full_name:H.fullName||H.email||"Bilinmeyen"}:null}return C}).filter(Boolean);return e.jsx("div",{className:"p-6 rounded-xl border-2 border-border hover:border-primary/40 hover:bg-primary/5 transition-all duration-200 shadow-sm hover:shadow-md",children:e.jsxs("div",{className:"flex flex-col gap-5 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>z(t),children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[Ye(t.status),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:t.title}),t.projectId&&te.has(t.projectId)&&e.jsxs(J,{variant:"outline",className:"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 border-blue-300 hover:from-blue-100 hover:to-indigo-100 transition-all shadow-sm",children:[e.jsx(ht,{className:"h-3 w-3 mr-1.5"}),e.jsx("span",{className:"font-semibold text-xs",children:(Se=te.get(t.projectId))==null?void 0:Se.name})]})]})})]}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2 mb-4 line-clamp-2 leading-relaxed",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx(J,{variant:"secondary",children:Qe(t.status)}),e.jsxs(J,{variant:"outline",className:"text-xs",children:["Öncelik ",t.priority]}),ke&&e.jsx(J,{className:"bg-amber-100 text-amber-900 border-amber-200",children:"Yaklaşan Termin"}),Oe&&e.jsx(J,{variant:"destructive",children:"Termin Geçti"}),t.approvalStatus==="pending"&&e.jsx(J,{className:"bg-yellow-100 text-yellow-900 border-yellow-300",children:"Görev Onayı Bekleniyor"}),t.approvalStatus==="approved"&&e.jsx(J,{className:"bg-green-100 text-green-900 border-green-300",children:"Görev Onaylandı"}),t.approvalStatus==="rejected"&&e.jsx(J,{className:"bg-red-100 text-red-900 border-red-300",children:"Görev Onayı Reddedildi"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-4 text-sm text-muted-foreground",children:[t.dueDate&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Qs,{className:"h-4 w-4"}),"Termin: ",Ve(t.dueDate)]}),le.length>0&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"h-4 w-4"}),le.length," kişi"]})]}),le.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx("div",{className:"flex -space-x-2",children:le.slice(0,4).map(C=>e.jsx(Ce,{className:"h-7 w-7 border-2 border-background",children:e.jsx(Be,{className:"text-[11px]",children:Je(C.full_name)})},C.id))}),le.length>4&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",le.length-4," daha"]})]}),(ce||de||t.rejectionReason)&&e.jsxs("div",{className:"flex flex-col gap-2 mt-4 p-3 bg-muted/30 rounded-lg border border-border",children:[ce&&Le&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ge,{className:"h-4 w-4 text-emerald-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-semibold text-emerald-700",children:"Onaylayan Kişi:"}),e.jsxs("div",{className:"flex flex-col gap-0.5 mt-0.5",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:ce}),e.jsx("span",{className:"text-xs text-muted-foreground",children:Le})]})]})]}),de&&Ue&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ls,{className:"h-4 w-4 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-semibold text-red-700",children:"Reddeden Kişi:"}),e.jsxs("div",{className:"flex flex-col gap-0.5 mt-0.5",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:de}),e.jsx("span",{className:"text-xs text-muted-foreground",children:Ue})]})]})]}),t.rejectionReason&&e.jsxs("div",{className:"text-sm text-red-700 font-medium mt-1 pt-2 border-t border-border",children:[e.jsx("span",{className:"font-semibold",children:"Red Nedeni:"})," ",t.rejectionReason]})]})]}),le.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-border",children:[e.jsxs("button",{type:"button",onClick:C=>{C.stopPropagation(),d(H=>{const y=new Set(H);return y.has(t.id)?y.delete(t.id):y.add(t.id),y})},className:"flex items-center gap-2 text-sm font-medium text-muted-foreground hover:text-foreground transition-colors w-full",children:[e.jsx(_e,{className:"h-4 w-4"}),e.jsx("span",{children:"Ekip Üyelerinin Logları"}),o.has(t.id)?e.jsx(ft,{className:"h-4 w-4 ml-auto"}):e.jsx(jt,{className:"h-4 w-4 ml-auto"})]}),o.has(t.id)&&e.jsx("div",{className:"mt-3 space-y-3",children:le.map(C=>{const H=s[C.id]||[];return H.length===0?e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30 border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ce,{className:"h-6 w-6",children:e.jsx(Be,{className:"text-[10px]",children:Je(C.full_name)})}),e.jsx("span",{className:"font-medium text-sm",children:C.full_name})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Henüz log bulunmuyor"})]},C.id):e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30 border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ce,{className:"h-6 w-6",children:e.jsx(Be,{className:"text-[10px]",children:Je(C.full_name)})}),e.jsx("span",{className:"font-medium text-sm",children:C.full_name}),e.jsxs(J,{variant:"secondary",className:"text-xs ml-auto",children:[H.length," log"]})]}),e.jsxs("div",{className:"space-y-2",children:[H.slice(0,5).map(y=>{const Ge={CREATE:{color:"bg-green-500",label:"Oluşturma"},UPDATE:{color:"bg-blue-500",label:"Güncelleme"},DELETE:{color:"bg-red-500",label:"Silme"}}[y.action]||{color:"bg-gray-500",label:y.action};let xe;return y.createdAt instanceof ye||y.createdAt&&typeof y.createdAt=="object"&&"toDate"in y.createdAt?xe=y.createdAt.toDate():y.createdAt&&typeof y.createdAt=="object"&&y.createdAt.constructor===Date?xe=y.createdAt:typeof y.createdAt=="string"||typeof y.createdAt=="number"?xe=new Date(y.createdAt):xe=new Date,e.jsxs("div",{className:"flex items-start gap-2 text-xs",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${Ge.color} mt-1.5 flex-shrink-0`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium",children:Ge.label}),y.tableName&&e.jsx("span",{className:"text-muted-foreground",children:y.tableName==="tasks"?"Görev":y.tableName==="profiles"?"Profil":y.tableName==="departments"?"Departman":y.tableName})]}),y.tableName&&y.recordId&&e.jsxs("p",{className:"text-muted-foreground mt-0.5 line-clamp-1",children:[y.tableName==="tasks"?"Görev":y.tableName==="profiles"?"Profil":y.tableName," - ",y.recordId.substring(0,8)]}),e.jsx("p",{className:"text-muted-foreground mt-0.5",children:xe.toLocaleDateString("tr-TR",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})})]})]},y.id)}),H.length>5&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["+",H.length-5," log daha"]})]})]},C.id)})})]}),e.jsxs("div",{className:"flex items-center gap-2",onClick:C=>C.stopPropagation(),children:[R&&t.approvalStatus==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(W,{size:"sm",variant:"default",className:"bg-green-600 hover:bg-green-700 text-white",onClick:C=>{C.stopPropagation(),D(t)},children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"Onayla"]}),e.jsxs(W,{size:"sm",variant:"outline",className:"border-red-200 text-red-700 hover:bg-red-50 hover:text-red-800",onClick:C=>{C.stopPropagation(),$(t),A(!0)},children:[e.jsx(Ys,{className:"h-4 w-4 mr-2"}),"Reddet"]})]}),e.jsxs(W,{size:"sm",variant:"outline",onClick:C=>{C.stopPropagation(),z(t)},children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),"Detay"]})]})]})},t.id)};return S?e.jsx(B,{children:e.jsx(E,{className:"flex items-center justify-center py-8",children:e.jsx(ue,{className:"h-6 w-6 animate-spin text-primary"})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{children:e.jsx(E,{className:"pt-6",children:e.jsxs(zs,{value:ne,onValueChange:ee,className:"w-full",children:[e.jsxs($s,{className:"grid w-full grid-cols-3",children:[e.jsxs(he,{value:"pending",className:"gap-2",children:[e.jsx(Ie,{className:"h-4 w-4"}),"Bekleyen (",g.length,")"]}),e.jsxs(he,{value:"approved",className:"gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),"Onaylandı (",p.length,")"]}),e.jsxs(he,{value:"rejected",className:"gap-2",children:[e.jsx(ls,{className:"h-4 w-4"}),"Reddedildi (",f.length,")"]})]}),e.jsx(fe,{value:"pending",className:"space-y-4 mt-4",children:g.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(is,{className:"h-10 w-10 text-muted-foreground/20"})}),e.jsx("p",{children:"Onayınızı bekleyen görev bulunmuyor."})]}):e.jsx("div",{className:"space-y-4",children:g.map(t=>Xe(t,!0))})}),e.jsx(fe,{value:"approved",className:"space-y-4 mt-4",children:p.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(ge,{className:"h-10 w-10 text-muted-foreground/20"})}),e.jsx("p",{children:"Onaylanmış görev bulunmuyor."})]}):e.jsx("div",{className:"space-y-4",children:p.map(t=>Xe(t,!1))})}),e.jsx(fe,{value:"rejected",className:"space-y-4 mt-4",children:f.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(ls,{className:"h-10 w-10 text-muted-foreground/20"})}),e.jsx("p",{children:"Reddedilmiş görev bulunmuyor."})]}):e.jsx("div",{className:"space-y-4",children:f.map(t=>Xe(t,!1))})})]})})}),e.jsx(os,{open:Q,onOpenChange:A,children:e.jsxs(ms,{children:[e.jsxs(xs,{children:[e.jsx(ps,{children:"Görevi Reddet"}),e.jsx(us,{children:'Görevi neden reddettiğinizi belirtebilirsiniz. Görev "Devam Ediyor" statüsüne geri dönecektir.'})]}),e.jsxs("div",{className:"space-y-2 py-2",children:[e.jsx(Fs,{children:"Red Nedeni"}),e.jsx(vt,{placeholder:"Eksik kısımlar var, lütfen kontrol et...",value:r,onChange:t=>ve(t.target.value)})]}),e.jsxs(Zs,{children:[e.jsx(W,{variant:"outline",onClick:()=>A(!1),children:"İptal"}),e.jsx(W,{variant:"destructive",onClick:_,children:"Reddet"})]})]})}),e.jsx(os,{open:De,onOpenChange:n,children:e.jsxs(ms,{className:"max-w-4xl w-[95vw] overflow-y-auto max-h-[90vh]",children:[e.jsxs(xs,{children:[e.jsx(ps,{children:"Görev Detayları"}),e.jsx(us,{children:"Görev detaylarını, ekibi ve checklist'i görüntüleyin."})]}),u&&e.jsx(It,{mode:Z,projectId:null,taskId:u,defaultStatus:I,onCancel:()=>{n(!1),h(null),F("pending")},onSuccess:()=>{ie(),n(!1),h(null),F("pending")},className:"border-0 shadow-none p-0"},`${Z}-${u}`)]})})]})},$t=()=>{const{user:a,isAdmin:i,isTeamLeader:k}=Pe(),[S,w]=m.useState(!0),[g,T]=m.useState([]),[p,N]=m.useState([]),[f,M]=m.useState([]),[K,U]=m.useState(null),[X,se]=m.useState(""),[q,b]=m.useState("all"),[O,$]=m.useState({}),[Q,A]=m.useState(!1),[r,ve]=m.useState(null),[ne,ee]=m.useState(!1);m.useEffect(()=>{De()},[a,i]);const De=()=>P(void 0,null,function*(){if(a!=null&&a.id){w(!0);try{const[s,l,o]=yield Promise.all([Te(),We(),Mt()]);N(l),M(o);let d=[];if(i)d=s;else{const D=l.filter(_=>_.managerId===a.id);if(D.length===0)d=[];else{const _=D.map(z=>z.id);d=s.filter(z=>!!(z.approvedTeams&&z.approvedTeams.some(ie=>_.includes(ie))||z.pendingTeams&&z.pendingTeams.some(ie=>_.includes(ie))||z.departmentId&&_.includes(z.departmentId)))}}T(d);const x={};yield Promise.all(d.map(D=>P(void 0,null,function*(){try{const _=yield Ne({assignedTo:D.id}),z=yield Promise.all(_.map(V=>P(void 0,null,function*(){return(yield hs(V.id)).find(Ve=>Ve.assignedTo===D.id)}))),ie=z.filter(V=>(V==null?void 0:V.status)==="completed").length,Ye=z.filter(V=>(V==null?void 0:V.status)==="pending").length,Qe=z.filter(V=>(V==null?void 0:V.status)==="accepted").length;x[D.id]={total:_.length,completed:ie,pending:Ye,inProgress:Qe}}catch(_){console.error(`Error fetching stats for ${D.id}:`,_),x[D.id]={total:0,completed:0,pending:0,inProgress:0}}}))),$(x)}catch(s){console.error("Fetch team members error:",s),Y.error("Ekip üyeleri yüklenemedi")}finally{w(!1)}}}),n=m.useMemo(()=>{let s=g;if(X.trim()){const l=X.toLowerCase();s=s.filter(o=>{var d,x,D;return((d=o.fullName)==null?void 0:d.toLowerCase().includes(l))||((x=o.email)==null?void 0:x.toLowerCase().includes(l))||((D=o.phone)==null?void 0:D.toLowerCase().includes(l))})}return q!=="all"&&(s=s.filter(l=>{var o,d;return!!((o=l.approvedTeams)!=null&&o.includes(q)||(d=l.pendingTeams)!=null&&d.includes(q)||l.departmentId===q)})),s},[g,X,q]),u=m.useMemo(()=>{if(!i)return null;const s={};return p.forEach(l=>{s[l.id]=[]}),s["no-department"]=[],n.forEach(l=>{const o=[];l.approvedTeams&&l.approvedTeams.length>0&&o.push(...l.approvedTeams),l.pendingTeams&&l.pendingTeams.length>0&&l.pendingTeams.forEach(d=>{o.includes(d)||o.push(d)}),l.departmentId&&!o.includes(l.departmentId)&&o.push(l.departmentId),o.length>0?o.forEach(d=>{s[d]&&(s[d].find(x=>x.id===l.id)||s[d].push(l))}):s["no-department"].push(l)}),s},[n,p,i]),h=s=>{var o;return p.some(d=>d.managerId===s.id)?"team_leader":((o=s.role)==null?void 0:o[0])||"viewer"},I=s=>{const l=f.find(o=>o.key===s);return l?l.label:s},F=s=>{const l=f.find(o=>o.key===s);return l?l.color.replace("bg-","bg-"):"bg-gray-500"},Z=s=>p.some(l=>l.managerId===s.id),re=s=>P(void 0,null,function*(){try{const l=yield Ne({assignedTo:s.id}),o=yield Promise.all(l.map(d=>P(void 0,null,function*(){var _,z;const D=(yield hs(d.id)).find(ie=>ie.assignedTo===s.id);return{taskTitle:d.title,status:(D==null?void 0:D.status)||"pending",assignedAt:((_=D==null?void 0:D.assignedAt)==null?void 0:_.toDate())||d.createdAt.toDate(),completedAt:((z=D==null?void 0:D.completedAt)==null?void 0:z.toDate())||(d.status==="completed"?d.updatedAt.toDate():null)}})));return{userName:s.fullName||s.email,userEmail:s.email,total:l.length,accepted:o.filter(d=>d.status==="accepted").length,rejected:o.filter(d=>d.status==="rejected").length,pending:o.filter(d=>d.status==="pending").length,completed:o.filter(d=>d.status==="completed").length,active:o.filter(d=>d.status==="accepted").length,assignments:o}}catch(l){throw console.error("Error fetching user stats:",l),l}}),te=s=>P(void 0,null,function*(){ee(!0);try{const l=yield re(s);ve({member:s,stats:l}),A(!0)}catch(l){Y.error("Rapor yüklenemedi: "+l.message)}finally{ee(!1)}}),c=s=>P(void 0,null,function*(){U(s.id);try{const l=yield re(s),o=yield As(l),d=URL.createObjectURL(o),x=document.createElement("a");x.href=d,x.download=`${s.fullName||"Kullanici"}-Raporu.pdf`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(d),Y.success("Rapor indirildi")}catch(l){console.error("Report generation error:",l),Y.error("Rapor oluşturulamadı: "+l.message)}finally{U(null)}}),ae=()=>P(void 0,null,function*(){if(r){U(r.member.id);try{const s=yield As(r.stats),l=URL.createObjectURL(s),o=document.createElement("a");o.href=l,o.download=`${r.member.fullName||"Kullanici"}-Raporu.pdf`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(l),Y.success("Rapor indirildi")}catch(s){console.error("Report generation error:",s),Y.error("Rapor oluşturulamadı: "+s.message)}finally{U(null)}}}),Me=s=>{const l=[];if(s.approvedTeams&&s.approvedTeams.length>0&&l.push(...s.approvedTeams),s.pendingTeams&&s.pendingTeams.length>0&&s.pendingTeams.forEach(d=>{l.includes(d)||l.push(d)}),s.departmentId&&!l.includes(s.departmentId)&&l.push(s.departmentId),l.length===0)return"-";const o=l.map(d=>{var x;return(x=p.find(D=>D.id===d))==null?void 0:x.name}).filter(Boolean);return o.length>0?o.join(", "):"-"};return S?e.jsx(B,{children:e.jsx(E,{className:"flex items-center justify-center py-8",children:e.jsx(ue,{className:"h-6 w-6 animate-spin text-primary"})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{children:e.jsxs(E,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(Pt,{placeholder:"İsim, e-posta veya telefon ara...",value:X,onChange:s=>se(s.target.value),containerClassName:"flex-1"}),e.jsxs(Ks,{value:q,onValueChange:b,children:[e.jsx(_s,{className:"w-full sm:w-[200px]",children:e.jsx(Hs,{placeholder:"Departman Filtrele"})}),e.jsxs(Ws,{children:[e.jsx($e,{value:"all",children:"Tüm Departmanlar"}),p.map(s=>e.jsx($e,{value:s.id,children:s.name},s.id))]})]})]}),n.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(Ke,{className:"h-12 w-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:X||q!=="all"?"Arama kriterlerinize uygun üye bulunamadı.":"Ekibinizde üye bulunmuyor."})]}):i&&u?e.jsx("div",{className:"space-y-6",children:Object.entries(u).map(([s,l])=>{if(l.length===0)return null;const o=p.find(x=>x.id===s),d=o?o.name:s==="no-department"?"Departmanı Olmayan Üyeler":"Bilinmeyen Departman";return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx(ds,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:d}),e.jsxs(J,{variant:"secondary",className:"ml-auto",children:[l.length," üye"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(x=>{var _,z;const D=O[x.id]||{total:0,completed:0,pending:0,inProgress:0};return e.jsx(B,{className:"hover:shadow-md transition-shadow h-full flex flex-col",children:e.jsxs(E,{className:"p-4 space-y-4 flex flex-col h-full",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsxs(Ce,{className:"h-12 w-12 flex-shrink-0",children:[e.jsx(ks,{src:void 0}),e.jsx(Be,{className:"bg-primary/10 text-primary",children:x.fullName?x.fullName.substring(0,2).toUpperCase():"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-semibold line-clamp-1",children:x.fullName||"İsimsiz"}),(((_=x.role)==null?void 0:_.includes("admin"))||((z=x.role)==null?void 0:z.includes("super_admin"))||Z(x))&&e.jsx(ys,{className:"h-4 w-4 text-primary flex-shrink-0"})]}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:x.email}),x.phone&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:vs(x.phone)})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[x.email&&e.jsxs(W,{variant:"outline",size:"sm",className:"flex-1 gap-2",onClick:()=>window.location.href=`mailto:${x.email}`,children:[e.jsx(bs,{className:"h-3.5 w-3.5"}),"Mail"]}),x.phone&&e.jsxs(W,{variant:"outline",size:"sm",className:"flex-1 gap-2",onClick:()=>window.location.href=`tel:${x.phone}`,children:[e.jsx(ws,{className:"h-3.5 w-3.5"}),"Ara"]})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Toplam Görev:"}),e.jsx("span",{className:"font-semibold",children:D.total})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center p-2 bg-green-50 rounded min-h-[70px] w-full",children:[e.jsx(ge,{className:"h-4 w-4 text-green-600 mb-1"}),e.jsx("span",{className:"text-xs font-semibold text-green-700",children:D.completed}),e.jsx("span",{className:"text-[10px] text-green-600",children:"Tamamlandı"})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-blue-50 rounded min-h-[70px] w-full",children:[e.jsx(Re,{className:"h-4 w-4 text-blue-600 mb-1"}),e.jsx("span",{className:"text-xs font-semibold text-blue-700",children:D.inProgress}),e.jsx("span",{className:"text-[10px] text-blue-600",children:"Devam Ediyor"})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-yellow-50 rounded min-h-[70px] w-full",children:[e.jsx(Ie,{className:"h-4 w-4 text-yellow-600 mb-1"}),e.jsx("span",{className:"text-xs font-semibold text-yellow-700",children:D.pending}),e.jsx("span",{className:"text-[10px] text-yellow-600",children:"Bekliyor"})]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm pt-2 border-t",children:[e.jsxs("div",{className:"flex justify-between text-muted-foreground",children:[e.jsx("span",{children:"Departman:"}),e.jsx("span",{className:"text-foreground font-medium text-right",children:Me(x)})]}),e.jsxs("div",{className:"flex justify-between text-muted-foreground",children:[e.jsx("span",{children:"Rol:"}),e.jsx(J,{className:`${F(h(x))} text-white hover:opacity-80`,children:I(h(x))})]})]}),e.jsxs("div",{className:"flex gap-2 mt-auto",children:[e.jsxs(W,{variant:"outline",className:"flex-1 gap-2",onClick:()=>te(x),disabled:ne,children:[ne?e.jsx(ue,{className:"h-4 w-4 animate-spin"}):e.jsx(cs,{className:"h-4 w-4"}),"Önizle"]}),e.jsxs(W,{variant:"default",className:"flex-1 gap-2",onClick:()=>c(x),disabled:K===x.id,children:[K===x.id?e.jsx(ue,{className:"h-4 w-4 animate-spin"}):e.jsx(rs,{className:"h-4 w-4"}),"İndir"]})]})]})},x.id)})})]},s)})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(s=>{var o,d;const l=O[s.id]||{total:0,completed:0,pending:0,inProgress:0};return e.jsx(B,{className:"hover:shadow-md transition-shadow h-full flex flex-col",children:e.jsxs(E,{className:"p-4 space-y-4 flex flex-col h-full",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsxs(Ce,{className:"h-12 w-12 flex-shrink-0",children:[e.jsx(ks,{src:void 0}),e.jsx(Be,{className:"bg-primary/10 text-primary",children:s.fullName?s.fullName.substring(0,2).toUpperCase():"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-semibold line-clamp-1",children:s.fullName||"İsimsiz"}),(((o=s.role)==null?void 0:o.includes("admin"))||((d=s.role)==null?void 0:d.includes("super_admin"))||Z(s))&&e.jsx(ys,{className:"h-4 w-4 text-primary flex-shrink-0"})]}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:s.email}),s.phone&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:vs(s.phone)})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[s.email&&e.jsxs(W,{variant:"outline",size:"sm",className:"flex-1 gap-2",onClick:()=>window.location.href=`mailto:${s.email}`,children:[e.jsx(bs,{className:"h-3.5 w-3.5"}),"Mail"]}),s.phone&&e.jsxs(W,{variant:"outline",size:"sm",className:"flex-1 gap-2",onClick:()=>window.location.href=`tel:${s.phone}`,children:[e.jsx(ws,{className:"h-3.5 w-3.5"}),"Ara"]})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Toplam Görev:"}),e.jsx("span",{className:"font-semibold",children:l.total})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center p-2 bg-green-50 rounded min-h-[70px] w-full",children:[e.jsx(ge,{className:"h-4 w-4 text-green-600 mb-1"}),e.jsx("span",{className:"text-xs font-semibold text-green-700",children:l.completed}),e.jsx("span",{className:"text-[10px] text-green-600",children:"Tamamlandı"})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-blue-50 rounded min-h-[70px] w-full",children:[e.jsx(Re,{className:"h-4 w-4 text-blue-600 mb-1"}),e.jsx("span",{className:"text-xs font-semibold text-blue-700",children:l.inProgress}),e.jsx("span",{className:"text-[10px] text-blue-600",children:"Devam Ediyor"})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-yellow-50 rounded min-h-[70px] w-full",children:[e.jsx(Ie,{className:"h-4 w-4 text-yellow-600 mb-1"}),e.jsx("span",{className:"text-xs font-semibold text-yellow-700",children:l.pending}),e.jsx("span",{className:"text-[10px] text-yellow-600",children:"Bekliyor"})]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm pt-2 border-t",children:[e.jsxs("div",{className:"flex justify-between text-muted-foreground",children:[e.jsx("span",{children:"Departman:"}),e.jsx("span",{className:"text-foreground font-medium text-right",children:Me(s)})]}),e.jsxs("div",{className:"flex justify-between text-muted-foreground",children:[e.jsx("span",{children:"Rol:"}),e.jsx(J,{className:`${F(h(s))} text-white hover:opacity-80`,children:I(h(s))})]})]}),e.jsxs("div",{className:"flex gap-2 mt-auto",children:[e.jsxs(W,{variant:"outline",className:"flex-1 gap-2",onClick:()=>te(s),disabled:ne,children:[ne?e.jsx(ue,{className:"h-4 w-4 animate-spin"}):e.jsx(cs,{className:"h-4 w-4"}),"Önizle"]}),e.jsxs(W,{variant:"default",className:"flex-1 gap-2",onClick:()=>c(s),disabled:K===s.id,children:[K===s.id?e.jsx(ue,{className:"h-4 w-4 animate-spin"}):e.jsx(rs,{className:"h-4 w-4"}),"İndir"]})]})]})},s.id)})})]})}),e.jsx(os,{open:Q,onOpenChange:A,children:e.jsxs(ms,{className:"w-full max-w-[98vw] md:max-w-6xl max-h-[95vh] overflow-y-auto",children:[e.jsxs(xs,{children:[e.jsxs(ps,{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5"}),"Kullanıcı Performans Raporu - ",(r==null?void 0:r.member.fullName)||(r==null?void 0:r.member.email)]}),e.jsxs(us,{children:[r==null?void 0:r.member.email," - ",new Date().toLocaleDateString("tr-TR",{day:"2-digit",month:"long",year:"numeric"})]})]}),r&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(B,{className:"bg-gradient-to-br from-blue-50 to-blue-100/50 border-blue-200",children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Toplam Görev"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900 mt-1",children:r.stats.total})]}),e.jsx(_e,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(B,{className:"bg-gradient-to-br from-green-50 to-green-100/50 border-green-200",children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-700",children:"Tamamlanan"}),e.jsx("p",{className:"text-2xl font-bold text-green-900 mt-1",children:r.stats.completed}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:r.stats.total>0?`%${Math.round(r.stats.completed/r.stats.total*100)}`:"%0"})]}),e.jsx(ge,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(B,{className:"bg-gradient-to-br from-yellow-50 to-yellow-100/50 border-yellow-200",children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-700",children:"Aktif Görevler"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900 mt-1",children:r.stats.active})]}),e.jsx(Re,{className:"h-8 w-8 text-yellow-600"})]})})})]}),e.jsxs(B,{children:[e.jsx(be,{children:e.jsx(we,{children:"Detaylı İstatistikler"})}),e.jsx(E,{children:e.jsxs(Rs,{children:[e.jsx(Cs,{children:e.jsxs(me,{children:[e.jsx(je,{children:"Metrik"}),e.jsx(je,{className:"text-center",children:"Değer"}),e.jsx(je,{className:"text-center",children:"Oran"})]})}),e.jsxs(Bs,{children:[e.jsxs(me,{children:[e.jsx(G,{className:"font-medium",children:"Toplam Görev"}),e.jsx(G,{className:"text-center",children:r.stats.total}),e.jsx(G,{className:"text-center",children:"%100"})]}),e.jsxs(me,{children:[e.jsx(G,{className:"font-medium",children:"Tamamlanan"}),e.jsx(G,{className:"text-center",children:r.stats.completed}),e.jsx(G,{className:"text-center",children:r.stats.total>0?`%${Math.round(r.stats.completed/r.stats.total*100)}`:"%0"})]}),e.jsxs(me,{children:[e.jsx(G,{className:"font-medium",children:"Kabul Edilen"}),e.jsx(G,{className:"text-center",children:r.stats.accepted}),e.jsx(G,{className:"text-center",children:r.stats.total>0?`%${Math.round(r.stats.accepted/r.stats.total*100)}`:"%0"})]}),e.jsxs(me,{children:[e.jsx(G,{className:"font-medium",children:"Beklemede"}),e.jsx(G,{className:"text-center",children:r.stats.pending}),e.jsx(G,{className:"text-center",children:r.stats.total>0?`%${Math.round(r.stats.pending/r.stats.total*100)}`:"%0"})]}),e.jsxs(me,{children:[e.jsx(G,{className:"font-medium",children:"Reddedilen"}),e.jsx(G,{className:"text-center",children:r.stats.rejected}),e.jsx(G,{className:"text-center",children:r.stats.total>0?`%${Math.round(r.stats.rejected/r.stats.total*100)}`:"%0"})]}),e.jsxs(me,{children:[e.jsx(G,{className:"font-medium",children:"Aktif Görevler"}),e.jsx(G,{className:"text-center",children:r.stats.active}),e.jsx(G,{className:"text-center",children:r.stats.total>0?`%${Math.round(r.stats.active/r.stats.total*100)}`:"%0"})]})]})]})})]}),r.stats.assignments.length>0&&e.jsxs(B,{children:[e.jsx(be,{children:e.jsx(we,{children:"Görev Detayları"})}),e.jsx(E,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Rs,{children:[e.jsx(Cs,{children:e.jsxs(me,{children:[e.jsx(je,{children:"Görev Başlığı"}),e.jsx(je,{className:"text-center",children:"Durum"}),e.jsx(je,{className:"text-center",children:"Atanma Tarihi"}),e.jsx(je,{className:"text-center",children:"Tamamlanma Tarihi"})]})}),e.jsx(Bs,{children:r.stats.assignments.map((s,l)=>{const o={pending:"Beklemede",accepted:"Kabul Edildi",rejected:"Reddedildi",completed:"Tamamlandı",in_progress:"Devam Ediyor"},d=s.assignedAt instanceof Date?s.assignedAt:new Date(s.assignedAt),x=s.completedAt?s.completedAt instanceof Date?s.completedAt:new Date(s.completedAt):null;return e.jsxs(me,{children:[e.jsx(G,{className:"font-medium",children:s.taskTitle}),e.jsx(G,{className:"text-center",children:e.jsx(J,{variant:s.status==="completed"?"default":s.status==="accepted"||s.status==="in_progress"?"secondary":s.status==="rejected"?"destructive":"outline",children:o[s.status]||s.status})}),e.jsx(G,{className:"text-center",children:Ss(d,"dd.MM.yyyy",{locale:Ds})}),e.jsx(G,{className:"text-center",children:x?Ss(x,"dd.MM.yyyy",{locale:Ds}):"-"})]},l)})})]})})})]}),e.jsx(B,{className:"bg-gradient-to-r from-primary/10 to-primary/5 border-primary/20",children:e.jsx(E,{className:"p-4",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:r.stats.userName})," kullanıcısı toplam"," ",e.jsx("strong",{children:r.stats.total})," görev almış,"," ",e.jsx("strong",{children:r.stats.completed})," görevi tamamlamıştır."," ","Tamamlanma oranı:"," ",e.jsxs("strong",{children:["%",r.stats.total>0?Math.round(r.stats.completed/r.stats.total*100):0]})]})})})]}),e.jsxs(Zs,{children:[e.jsx(W,{variant:"outline",onClick:()=>A(!1),children:"Kapat"}),e.jsx(W,{onClick:ae,disabled:!r||K===(r==null?void 0:r.member.id),children:K===(r==null?void 0:r.member.id)?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"h-4 w-4 mr-2 animate-spin"}),"İndiriliyor..."]}):e.jsxs(e.Fragment,{children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),"PDF İndir"]})})]})]})})]})},Kt=()=>{const{user:a,isAdmin:i,isTeamLeader:k}=Pe(),[S,w]=m.useState([]),[g,T]=m.useState([]),[p,N]=m.useState([]),[f,M]=m.useState([]),[K,U]=m.useState(!0),[X,se]=m.useState(null),[q,b]=m.useState("all");m.useEffect(()=>{a!=null&&a.id&&O()},[a,q]);const O=()=>P(void 0,null,function*(){if(a!=null&&a.id){U(!0);try{const[n,u,h]=yield Promise.all([We(),Te(),Ne()]);if(w(n),i){T(n);let I=n;if(q!=="all"&&(I=n.filter(c=>c.id===q)),I.length===0){N([]),M([]),U(!1);return}const F=I.map(c=>c.id),Z=u.filter(c=>!!(c.approvedTeams&&c.approvedTeams.some(ae=>F.includes(ae))||c.pendingTeams&&c.pendingTeams.some(ae=>F.includes(ae))||c.departmentId&&F.includes(c.departmentId)));N(Z);const re=Z.map(c=>c.id),te=h.filter(c=>re.includes(c.createdBy)||c.createdBy===a.id);M(te)}else{const I=S.filter(c=>c.managerId===a.id);if(I.length===0){T([]),N([]),M([]),U(!1);return}T(I);const F=I.map(c=>c.id),Z=u.filter(c=>!!(c.approvedTeams&&c.approvedTeams.some(ae=>F.includes(ae))||c.pendingTeams&&c.pendingTeams.some(ae=>F.includes(ae))||c.departmentId&&F.includes(c.departmentId)));N(Z);const re=Z.map(c=>c.id),te=h.filter(c=>re.includes(c.createdBy)||c.createdBy===a.id);M(te)}}catch(n){console.error("Error fetching team stats:",n)}finally{U(!1)}}}),$=f.filter(n=>{if(!n.dueDate||n.status==="completed"||n.status==="cancelled")return!1;let u;const h=n.dueDate;return h!=null&&h.toDate&&typeof h.toDate=="function"?u=h.toDate():h instanceof Date?u=h:u=new Date(h),Ee(u,new Date)}),Q=f.filter(n=>{if(!n.dueDate||n.status==="completed"||n.status==="cancelled")return!1;let u;const h=n.dueDate;h!=null&&h.toDate&&typeof h.toDate=="function"?u=h.toDate():h instanceof Date?u=h:u=new Date(h);const I=st(new Date),F=tt(I,3);return!Ee(u,I)&&Ee(u,F)}),A=Ot(new Date,7),r=f.filter(n=>{if(n.status!=="completed"||!n.updatedAt)return!1;let u;const h=n.updatedAt;return h!=null&&h.toDate&&typeof h.toDate=="function"?u=h.toDate():h instanceof Date?u=h:u=new Date(h),et(u,A)}),ve=f.length>0?f.reduce((n,u)=>n+(u.priority||0),0)/f.length:0,ne=p.map(n=>{const u=f.filter(I=>I.createdBy===n.id),h=u.filter(I=>I.status==="completed").length;return{member:n,totalTasks:u.length,completedTasks:h,completionRate:u.length>0?h/u.length*100:0}}).sort((n,u)=>u.completedTasks-n.completedTasks).slice(0,5),ee={completedTasks:f.filter(n=>n.status==="completed").length,completionRate:f.length>0?f.filter(n=>n.status==="completed").length/f.length*100:0,overdueTasks:$.length,dueSoonTasks:Q.length,recentCompleted:r.length,avgPriority:ve.toFixed(1)},De=n=>{const u=p.filter(c=>!!(c.approvedTeams&&c.approvedTeams.includes(n)||c.pendingTeams&&c.pendingTeams.includes(n)||c.departmentId===n)),h=u.map(c=>c.id),I=f.filter(c=>!!(c.productionProcessId===n||h.includes(c.createdBy))),F=I.filter(c=>c.status==="completed").length;I.filter(c=>c.status==="cancelled").length;const Z=I.length,re=I.filter(c=>c.status!=="completed"&&c.status!=="cancelled").length,te=Z>0?F/Z*100:0;return{members:u.length,activeTasks:re,completedTasks:F,totalTasks:Z,completionRate:te}};return K?e.jsxs("div",{className:"space-y-4",children:[e.jsx(Es,{className:"h-32 w-full"}),e.jsx(Es,{className:"h-64 w-full"})]}):e.jsxs("div",{className:"space-y-6",children:[i&&e.jsx(B,{children:e.jsx(E,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Ekip Seç:"}),e.jsxs(Ks,{value:q,onValueChange:b,children:[e.jsx(_s,{className:"w-full sm:w-[250px]",children:e.jsx(Hs,{placeholder:"Ekip seçiniz"})}),e.jsxs(Ws,{children:[e.jsx($e,{value:"all",children:"Tüm Ekipler"}),S.map(n=>e.jsx($e,{value:n.id,children:n.name},n.id))]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(B,{className:"bg-gradient-to-br from-green-50 to-green-100/50 border-green-200",children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-700",children:"Tamamlanan"}),e.jsx("p",{className:"text-2xl font-bold text-green-900 mt-1",children:ee.completedTasks})]}),e.jsx(Js,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(B,{className:"bg-gradient-to-br from-purple-50 to-purple-100/50 border-purple-200",children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-700",children:"Tamamlanma Oranı"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-900 mt-1",children:[ee.completionRate.toFixed(0),"%"]})]}),e.jsx(Re,{className:"h-8 w-8 text-purple-600"})]})})}),e.jsx(B,{className:"bg-gradient-to-br from-red-50 to-red-100/50 border-red-200",children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-700",children:"Geciken Görevler"}),e.jsx("p",{className:"text-2xl font-bold text-red-900 mt-1",children:ee.overdueTasks})]}),e.jsx(Vs,{className:"h-8 w-8 text-red-600"})]})})}),e.jsx(B,{className:"bg-gradient-to-br from-amber-50 to-amber-100/50 border-amber-200",children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-700",children:"Yaklaşan Terminler"}),e.jsx("p",{className:"text-2xl font-bold text-amber-900 mt-1",children:ee.dueSoonTasks}),e.jsx("p",{className:"text-xs text-amber-600 mt-1",children:"3 gün içinde"})]}),e.jsx(Qs,{className:"h-8 w-8 text-amber-600"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(B,{children:[e.jsx(be,{children:e.jsxs(we,{className:"text-lg flex items-center gap-2",children:[e.jsx(Xs,{className:"h-5 w-5"}),"Son 7 Gün Aktivite"]})}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Tamamlanan Görevler"}),e.jsx("span",{className:"text-muted-foreground",children:ee.recentCompleted})]}),e.jsx(ns,{value:f.length>0?ee.recentCompleted/f.length*100:0,className:"h-3"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Son 7 gün içinde ",ee.recentCompleted," görev tamamlandı"]})]})]}),e.jsxs(B,{children:[e.jsx(be,{children:e.jsxs(we,{className:"text-lg flex items-center gap-2",children:[e.jsx(gt,{className:"h-5 w-5"}),"Görev Öncelik Analizi"]})}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Ortalama Öncelik"}),e.jsx("span",{className:"text-muted-foreground",children:ee.avgPriority})]}),e.jsx(ns,{value:f.length>0?parseFloat(ee.avgPriority)/5*100:0,className:"h-3"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Yüksek Öncelik:"}),e.jsx("span",{className:"ml-2 font-semibold",children:f.filter(n=>(n.priority||0)>=4).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Kritik:"}),e.jsx("span",{className:"ml-2 font-semibold text-red-600",children:f.filter(n=>(n.priority||0)===5).length})]})]})]})]})]}),ne.length>0&&e.jsxs(B,{children:[e.jsx(be,{children:e.jsxs(we,{className:"text-lg flex items-center gap-2",children:[e.jsx(Nt,{className:"h-5 w-5"}),"En Aktif Üyeler"]})}),e.jsx(E,{children:e.jsx("div",{className:"space-y-3",children:ne.map(({member:n,totalTasks:u,completedTasks:h,completionRate:I},F)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary/10 text-primary font-semibold text-sm",children:F+1}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.fullName||n.email}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[h," tamamlanan / ",u," toplam"]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs(J,{variant:"secondary",className:"text-xs",children:[I.toFixed(0),"%"]})})]},n.id))})})]}),e.jsxs(B,{children:[e.jsx(be,{children:e.jsxs(we,{className:"text-lg flex items-center gap-2",children:[e.jsx(ds,{className:"h-5 w-5"}),i?"Tüm Ekipler":"Yönettiğim Ekipler"," (",g.length,")"]})}),e.jsx(E,{children:e.jsx("div",{className:"space-y-4",children:g.map(n=>{const u=De(n.id);return e.jsxs("button",{onClick:()=>{i&&b(n.id)},className:"w-full text-left p-4 rounded-lg bg-muted/50 space-y-2 hover:bg-muted transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("h4",{className:"font-medium",children:n.name})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[u.completionRate.toFixed(0),"%"]})]}),e.jsx(ns,{value:u.completionRate,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Üye: ",u.members]}),e.jsxs("span",{children:["Aktif: ",u.activeTasks]}),e.jsxs("span",{children:["Tamamlanan: ",u.completedTasks]}),e.jsxs("span",{children:["Toplam: ",u.totalTasks]})]})]},n.id)})})})]}),!i&&X&&e.jsx(Lt,{open:!!X,onOpenChange:n=>!n&&se(null),departmentId:X})]})},fa=()=>{const{user:a,isAdmin:i,isTeamLeader:k}=Pe(),[S,w]=m.useState("approvals"),[g,T]=m.useState({totalMembers:0,pendingApprovals:0,pendingRequests:0,activeTasks:0}),[p,N]=m.useState(!0);if(!i&&!k)return e.jsx(ut,{to:"/",replace:!0});m.useEffect(()=>{f()},[a,i]);const f=()=>P(void 0,null,function*(){if(a!=null&&a.id){N(!0);try{const[M,K,U,X]=yield Promise.all([Te(),We(),Ne(),i?lt():at(a.id)]);let se=[];if(i)se=M;else{const O=K.filter($=>$.managerId===a.id);if(O.length===0)se=[];else{const $=O.map(Q=>Q.id);se=M.filter(Q=>!!(Q.approvedTeams&&Q.approvedTeams.some(A=>$.includes(A))||Q.pendingTeams&&Q.pendingTeams.some(A=>$.includes(A))||Q.departmentId&&$.includes(Q.departmentId)))}}let q=U;if(!i){const O=K.filter($=>$.managerId===a.id);if(O.length>0){const $=O.map(A=>A.id),Q=M.filter(A=>!!(A.approvedTeams&&A.approvedTeams.some(r=>$.includes(r))||A.pendingTeams&&A.pendingTeams.some(r=>$.includes(r))||A.departmentId&&$.includes(A.departmentId))).map(A=>A.id);q=U.filter(A=>Q.includes(A.createdBy)||A.createdBy===a.id)}else q=U.filter($=>$.createdBy===a.id)}const b=q.filter(O=>O.approvalStatus==="pending");T({totalMembers:se.length,pendingApprovals:b.length,pendingRequests:X.length,activeTasks:q.filter(O=>O.status==="in_progress").length})}catch(M){console.error("Error fetching stats:",M),Y.error("İstatistikler yüklenirken hata oluştu")}finally{N(!1)}}});return e.jsx(yt,{children:e.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-foreground",children:"Ekip Yönetimi"}),e.jsx("p",{className:"text-muted-foreground mt-0.5 sm:mt-1 text-xs sm:text-sm",children:"Ekip üyelerinizi, görev onaylarını ve katılım isteklerini yönetin."})]}),!p&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("button",{type:"button",onClick:()=>w("members"),className:"text-left group focus:outline-none touch-manipulation h-full",children:e.jsx(B,{className:"bg-gradient-to-br from-blue-50 to-blue-100/50 border-blue-200 group-hover:border-blue-400 transition-colors h-full",children:e.jsxs(E,{className:"p-3 sm:p-4 h-full flex items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-blue-700",children:"Toplam Üye"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-blue-900 mt-1",children:g.totalMembers}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-1",children:"Ekip üyelerini görüntüleyin"})]}),e.jsx(Ke,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-600 flex-shrink-0"})]})})}),e.jsx("button",{type:"button",onClick:()=>w("approvals"),className:"text-left group focus:outline-none touch-manipulation h-full",children:e.jsx(B,{className:"bg-gradient-to-br from-yellow-50 to-yellow-100/50 border-yellow-200 group-hover:border-yellow-400 transition-colors h-full",children:e.jsxs(E,{className:"p-3 sm:p-4 h-full flex items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-yellow-700",children:"Bekleyen Onaylar"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-yellow-900 mt-1",children:g.pendingApprovals}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-1",children:"Görev onay taleplerini inceleyin"})]}),e.jsx(Ie,{className:"h-6 w-6 sm:h-8 sm:w-8 text-yellow-600 flex-shrink-0"})]})})}),e.jsx("button",{type:"button",onClick:()=>w("approvals"),className:"text-left group focus:outline-none touch-manipulation h-full",children:e.jsx(B,{className:"bg-gradient-to-br from-green-50 to-green-100/50 border-green-200 group-hover:border-green-400 transition-colors h-full",children:e.jsxs(E,{className:"p-3 sm:p-4 h-full flex items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-green-700",children:"Aktif Görevler"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-900 mt-1",children:g.activeTasks}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-1",children:"Görev durumlarına göz atın"})]}),e.jsx(Re,{className:"h-6 w-6 sm:h-8 sm:w-8 text-green-600 flex-shrink-0"})]})})}),e.jsx("button",{type:"button",onClick:()=>w("join-requests"),className:"text-left group focus:outline-none touch-manipulation h-full",children:e.jsx(B,{className:"bg-gradient-to-br from-purple-50 to-purple-100/50 border-purple-200 group-hover:border-purple-400 transition-colors h-full",children:e.jsxs(E,{className:"p-3 sm:p-4 h-full flex items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-purple-700",children:"Katılım İstekleri"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-purple-900 mt-1",children:g.pendingRequests}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-1",children:"Bekleyen katılım taleplerini yönetin"})]}),e.jsx(Ts,{className:"h-6 w-6 sm:h-8 sm:w-8 text-purple-600 flex-shrink-0"})]})})})]}),e.jsxs(zs,{value:S,onValueChange:w,className:"space-y-6",children:[e.jsx("div",{className:"overflow-x-auto pb-2 -mx-4 px-4 sm:mx-0 sm:px-0 sm:pb-0",children:e.jsxs($s,{className:"w-full justify-start sm:justify-between h-auto p-1 gap-1",children:[e.jsxs(he,{value:"approvals",className:"gap-2 flex-1 min-w-[140px]",children:[e.jsx(Js,{className:"h-4 w-4"}),e.jsx("span",{children:"Görev Onayları"})]}),e.jsxs(he,{value:"members",className:"gap-2 flex-1 min-w-[140px]",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{children:"Ekip Üyeleri"})]}),e.jsxs(he,{value:"logs",className:"gap-2 flex-1 min-w-[140px]",children:[e.jsx(_e,{className:"h-4 w-4"}),e.jsx("span",{children:"Ekip Logları"})]}),e.jsxs(he,{value:"join-requests",className:"gap-2 flex-1 min-w-[140px]",children:[e.jsx(Ts,{className:"h-4 w-4"}),e.jsx("span",{children:"Katılım İstekleri"})]}),e.jsxs(he,{value:"stats",className:"gap-2 flex-1 min-w-[140px]",children:[e.jsx(Xs,{className:"h-4 w-4"}),e.jsx("span",{children:"İstatistikler"})]})]})}),e.jsx(fe,{value:"approvals",className:"space-y-4",children:e.jsx(zt,{})}),e.jsx(fe,{value:"members",className:"space-y-4",children:e.jsx($t,{})}),e.jsx(fe,{value:"logs",className:"space-y-4",children:e.jsx(Ut,{mode:i?"admin":"team",userId:a==null?void 0:a.id})}),e.jsx(fe,{value:"join-requests",className:"space-y-4",children:e.jsx(Ft,{})}),e.jsx(fe,{value:"stats",className:"space-y-4",children:e.jsx(Kt,{})})]})]})})};export{fa as default};

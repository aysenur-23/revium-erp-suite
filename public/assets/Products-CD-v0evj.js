import{a3 as be,k as Te,r as c,j as e,B as S,X as re,L as de,C,c as Z,d as J,e as D,w as o,R as h,S as B,p as G,q as O,s as z,t as u,b as f,l as _e,m as Me,n as fe,aj as Ne,U as Ae,g as Pe,K as Ke,V as ke}from"./index-Xd90qdO9.js";import{D as xe,a as he,b as ue,P as V,c as ge,T as je,ad as Le,ae as we,B as se,j as Re,A as Ee,E as Ie,G as Be,H as ce,g as Ge,af as Oe,M as ve}from"./MainLayout-DW7UjMSA.js";import{S as ze}from"./search-input-QX7HVhJf.js";import{A as Ve,a as He,b as Ue,c as qe,d as $e,e as Ye,f as We,g as Qe}from"./alert-dialog-BVp-ELLM.js";import{S as pe}from"./save-Bgz0wbo5.js";import{b as Xe,a as Ze,d as Je,u as es}from"./recipeService-CoAKsRoE.js";import{g as ss}from"./materialService-fdlP1ZS7.js";import{T as as,a as ts,b as ye,c as Q,d as ls,e as X}from"./table-CHpYTcky.js";import{S as oe}from"./square-pen-zeHrcQ7c.js";import{T as Se}from"./trash-2-DlZRXDqX.js";import{P as Ce}from"./plus-D9uLCipi.js";import{D as is}from"./DetailedValueReportModal-Hb3qQukI.js";import{L as rs}from"./loading-state-CyTUOPV3.js";import{E as ns}from"./ellipsis-vertical-gVlTlFy-.js";import{D as ms}from"./exchangeRateService-Cpnvl6ZU.js";import{M as cs}from"./map-pin-CYdnXw-f.js";import{T as os}from"./trending-up-DyiN6Ad2.js";import"./taskService-CQO0i9v5.js";import"./currency-BpxR3_y8.js";import"./chart-column-tcYl_7Fa.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=be("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=be("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),hs=["Taşınabilir Güç Paketleri","Kabin Tipi Güç Paketleri","Araç Tipi Güç Paketleri","Endüstriyel Güç Paketleri","Güneş Enerji Sistemleri"],us=({open:i,onOpenChange:g,onSuccess:s})=>{const{user:x}=Te(),[v,p]=c.useState(!1),[a,d]=c.useState({name:"",sku:`PRD-${Date.now()}`,description:"",category:"",stock:"0",unit:"Adet",price:"",cost:"",min_stock:"0",max_stock:"",location:""}),y=async l=>{l&&l.preventDefault(),p(!0);try{if(!x){f.error("Oturumunuz sona erdi. Lütfen tekrar giriş yapın."),p(!1);return}await Le({name:a.name,sku:a.sku||null,description:a.description||null,category:a.category||null,imageUrl:null,image_url:null,stock:parseInt(a.stock)||0,unit:a.unit,price:a.price?parseFloat(a.price):null,unitPrice:a.price?parseFloat(a.price):null,cost:a.cost?parseFloat(a.cost):null,minStock:parseInt(a.min_stock)||0,maxStock:a.max_stock?parseInt(a.max_stock):null,location:a.location||null,createdBy:x.id}),f.success("Ürün başarıyla oluşturuldu"),s(),g(!1),d({name:"",sku:`PRD-${Date.now()}`,description:"",category:"",stock:"0",unit:"Adet",price:"",cost:"",min_stock:"0",max_stock:"",location:""})}catch(b){f.error(b.message||"Ürün oluşturulurken hata oluştu")}finally{p(!1)}};return e.jsx(xe,{open:i,onOpenChange:g,children:e.jsx(he,{className:"!max-w-[100vw] sm:!max-w-[95vw] !w-[100vw] sm:!w-[95vw] !h-[100vh] sm:!h-[90vh] !max-h-[100vh] sm:!max-h-[90vh] !left-0 sm:!left-[2.5vw] !top-0 sm:!top-[5vh] !right-0 sm:!right-auto !bottom-0 sm:!bottom-auto !translate-x-0 !translate-y-0 overflow-hidden !p-0 gap-0 bg-white flex flex-col !m-0 !rounded-none sm:!rounded-lg !border-0 sm:!border",children:e.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[e.jsx(ue,{className:"p-3 sm:p-4 border-b bg-white flex-shrink-0 relative pr-12 sm:pr-16",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-8 w-8 sm:h-10 sm:w-10 rounded-lg bg-primary/10 flex items-center justify-center border border-primary/20 flex-shrink-0",children:e.jsx(V,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),e.jsx(ge,{className:"text-lg sm:text-xl font-semibold text-foreground truncate",children:"Yeni Ürün"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 flex-shrink-0",children:[e.jsxs(S,{variant:"outline",size:"sm",className:"border-primary/20 hover:bg-primary/5 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0",onClick:()=>g(!1),disabled:v,children:[e.jsx(re,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"İptal"]}),e.jsxs(S,{variant:"default",size:"sm",className:"bg-primary hover:bg-primary/90 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0 text-white",onClick:y,disabled:v,children:[v?e.jsx(de,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0 animate-spin"}):e.jsx(pe,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Kaydet"]})]})]})}),e.jsx("div",{className:"flex-1 overflow-hidden bg-gray-50/50 p-3 sm:p-4 min-h-0",children:e.jsx("div",{className:"max-w-full mx-auto h-full overflow-y-auto",children:e.jsx("form",{onSubmit:l=>{l.preventDefault(),y(l)},className:"space-y-4 sm:space-y-6",children:e.jsxs(C,{children:[e.jsx(Z,{children:e.jsx(J,{className:"text-lg sm:text-xl",children:"Temel Bilgiler"})}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"name",className:"text-sm sm:text-base",children:"Ürün Adı"}),e.jsx(h,{id:"name",value:a.name,onChange:l=>d({...a,name:l.target.value}),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"sku",className:"text-sm sm:text-base",children:"SKU"}),e.jsx(h,{id:"sku",value:a.sku,onChange:l=>d({...a,sku:l.target.value}),className:"min-h-[44px] sm:min-h-0",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"description",className:"text-sm sm:text-base",children:"Açıklama"}),e.jsx(je,{id:"description",value:a.description,onChange:l=>d({...a,description:l.target.value}),rows:3,className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"category",className:"text-sm sm:text-base",children:"Kategori"}),e.jsxs(B,{value:a.category||"none",onValueChange:l=>d({...a,category:l==="none"?"":l}),children:[e.jsx(G,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(O,{placeholder:"Kategori seçin"})}),e.jsxs(z,{children:[e.jsx(u,{value:"none",children:"Kategori Yok"}),hs.map(l=>e.jsx(u,{value:l,children:l},l))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"stock",className:"text-sm sm:text-base",children:"Stok"}),e.jsx(h,{id:"stock",type:"number",value:a.stock,onChange:l=>d({...a,stock:l.target.value}),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"unit",className:"text-sm sm:text-base",children:"Birim"}),e.jsxs(B,{value:a.unit||"",onValueChange:l=>d({...a,unit:l}),children:[e.jsx(G,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(O,{})}),e.jsxs(z,{children:[e.jsx(u,{value:"Adet",children:"Adet"}),e.jsx(u,{value:"Kg",children:"Kg"}),e.jsx(u,{value:"Lt",children:"Lt"}),e.jsx(u,{value:"Mt",children:"Mt"}),e.jsx(u,{value:"M2",children:"M²"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"price",className:"text-sm sm:text-base",children:"Satış Fiyatı"}),e.jsx(h,{id:"price",type:"number",step:"0.01",value:a.price,onChange:l=>d({...a,price:l.target.value}),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"cost",className:"text-sm sm:text-base",children:"Maliyet"}),e.jsx(h,{id:"cost",type:"number",step:"0.01",value:a.cost,onChange:l=>d({...a,cost:l.target.value}),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"min_stock",className:"text-sm sm:text-base",children:"Min. Stok"}),e.jsx(h,{id:"min_stock",type:"number",value:a.min_stock,onChange:l=>d({...a,min_stock:l.target.value}),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"max_stock",className:"text-sm sm:text-base",children:"Max. Stok"}),e.jsx(h,{id:"max_stock",type:"number",value:a.max_stock,onChange:l=>d({...a,max_stock:l.target.value}),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"location",className:"text-sm sm:text-base",children:"Konum"}),e.jsx(h,{id:"location",value:a.location,onChange:l=>d({...a,location:l.target.value}),className:"min-h-[44px] sm:min-h-0"})]})]})]})]})})})})]})})})},gs=["Taşınabilir Güç Paketleri","Kabin Tipi Güç Paketleri","Araç Tipi Güç Paketleri","Endüstriyel Güç Paketleri","Güneş Enerji Sistemleri"],js=({open:i,onOpenChange:g,onSuccess:s,product:x})=>{const[v,p]=c.useState(!1),[a,d]=c.useState({name:"",sku:"",description:"",category:"",stock:"0",unit:"Adet",price:"",cost:"",min_stock:"0",max_stock:"",location:""});c.useEffect(()=>{var l,b,K,F,_;x&&d({name:x.name||"",sku:x.sku||"",description:x.description||"",category:x.category||"",stock:((l=x.stock)==null?void 0:l.toString())||"0",unit:x.unit||"Adet",price:((b=x.price)==null?void 0:b.toString())||"",cost:((K=x.cost)==null?void 0:K.toString())||"",min_stock:((F=x.min_stock)==null?void 0:F.toString())||"0",max_stock:((_=x.max_stock)==null?void 0:_.toString())||"",location:x.location||""})},[x]);const y=async l=>{l&&l.preventDefault(),p(!0);try{await we(x.id,{name:a.name,sku:a.sku||null,description:a.description||null,category:a.category||null,imageUrl:null,image_url:null,stock:parseInt(a.stock)||0,unit:a.unit,price:a.price?parseFloat(a.price):null,unitPrice:a.price?parseFloat(a.price):null,cost:a.cost?parseFloat(a.cost):null,minStock:parseInt(a.min_stock)||0,maxStock:a.max_stock?parseInt(a.max_stock):null,location:a.location||null}),f.success("Ürün başarıyla güncellendi"),s(),g(!1)}catch(b){f.error(b.message||"Ürün güncellenirken hata oluştu")}finally{p(!1)}};return e.jsx(xe,{open:i,onOpenChange:g,children:e.jsx(he,{className:"!max-w-[100vw] sm:!max-w-[95vw] !w-[100vw] sm:!w-[95vw] !h-[100vh] sm:!h-[90vh] !max-h-[100vh] sm:!max-h-[90vh] !left-0 sm:!left-[2.5vw] !top-0 sm:!top-[5vh] !right-0 sm:!right-auto !bottom-0 sm:!bottom-auto !translate-x-0 !translate-y-0 overflow-hidden !p-0 gap-0 bg-white flex flex-col !m-0 !rounded-none sm:!rounded-lg !border-0 sm:!border",children:e.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[e.jsx(ue,{className:"p-3 sm:p-4 border-b bg-white flex-shrink-0 relative pr-12 sm:pr-16",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-8 w-8 sm:h-10 sm:w-10 rounded-lg bg-primary/10 flex items-center justify-center border border-primary/20 flex-shrink-0",children:e.jsx(V,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),e.jsx(ge,{className:"text-lg sm:text-xl font-semibold text-foreground truncate",children:"Ürünü Düzenle"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 flex-shrink-0",children:[e.jsxs(S,{variant:"outline",size:"sm",className:"border-primary/20 hover:bg-primary/5 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0",onClick:()=>g(!1),disabled:v,children:[e.jsx(re,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"İptal"]}),e.jsxs(S,{variant:"default",size:"sm",className:"bg-primary hover:bg-primary/90 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0 text-white",onClick:y,disabled:v,children:[v?e.jsx(de,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0 animate-spin"}):e.jsx(pe,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Kaydet"]})]})]})}),e.jsx("div",{className:"flex-1 overflow-hidden bg-gray-50/50 p-3 sm:p-4 min-h-0",children:e.jsx("div",{className:"max-w-full mx-auto h-full overflow-y-auto",children:e.jsx("form",{onSubmit:l=>{l.preventDefault(),y(l)},className:"space-y-4 sm:space-y-6",children:e.jsxs(C,{children:[e.jsx(Z,{children:e.jsx(J,{className:"text-lg sm:text-xl",children:"Temel Bilgiler"})}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"name",className:"text-sm sm:text-base",children:"Ürün Adı"}),e.jsx(h,{id:"name",value:a.name,onChange:l=>d({...a,name:l.target.value}),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"sku",className:"text-sm sm:text-base",children:"SKU"}),e.jsx(h,{id:"sku",value:a.sku,onChange:l=>d({...a,sku:l.target.value}),className:"min-h-[44px] sm:min-h-0",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"description",className:"text-sm sm:text-base",children:"Açıklama"}),e.jsx(je,{id:"description",value:a.description,onChange:l=>d({...a,description:l.target.value}),rows:3,className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"category",className:"text-sm sm:text-base",children:"Kategori"}),e.jsxs(B,{value:a.category||"none",onValueChange:l=>d({...a,category:l==="none"?"":l}),children:[e.jsx(G,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(O,{placeholder:"Kategori seçin"})}),e.jsxs(z,{children:[e.jsx(u,{value:"none",children:"Kategori Yok"}),gs.map(l=>e.jsx(u,{value:l,children:l},l))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"stock",className:"text-sm sm:text-base",children:"Stok"}),e.jsx(h,{id:"stock",type:"number",value:a.stock,onChange:l=>d({...a,stock:l.target.value}),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"unit",className:"text-sm sm:text-base",children:"Birim"}),e.jsxs(B,{value:a.unit||"",onValueChange:l=>d({...a,unit:l}),children:[e.jsx(G,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(O,{})}),e.jsxs(z,{children:[e.jsx(u,{value:"Adet",children:"Adet"}),e.jsx(u,{value:"Kg",children:"Kg"}),e.jsx(u,{value:"Lt",children:"Lt"}),e.jsx(u,{value:"Mt",children:"Mt"}),e.jsx(u,{value:"M2",children:"M²"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"price",className:"text-sm sm:text-base",children:"Satış Fiyatı"}),e.jsx(h,{id:"price",type:"number",step:"0.01",value:a.price,onChange:l=>d({...a,price:l.target.value}),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"cost",className:"text-sm sm:text-base",children:"Maliyet"}),e.jsx(h,{id:"cost",type:"number",step:"0.01",value:a.cost,onChange:l=>d({...a,cost:l.target.value}),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"min_stock",className:"text-sm sm:text-base",children:"Min. Stok"}),e.jsx(h,{id:"min_stock",type:"number",value:a.min_stock,onChange:l=>d({...a,min_stock:l.target.value}),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"max_stock",className:"text-sm sm:text-base",children:"Max. Stok"}),e.jsx(h,{id:"max_stock",type:"number",value:a.max_stock,onChange:l=>d({...a,max_stock:l.target.value}),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"location",className:"text-sm sm:text-base",children:"Konum"}),e.jsx(h,{id:"location",value:a.location,onChange:l=>d({...a,location:l.target.value}),className:"min-h-[44px] sm:min-h-0"})]})]})]})]})})})})]})})})},ps=["Taşınabilir Güç Paketleri","Kabin Tipi Güç Paketleri","Araç Tipi Güç Paketleri","Endüstriyel Güç Paketleri","Güneş Enerji Sistemleri"],fs=({open:i,onOpenChange:g,product:s,onUpdate:x})=>{const[v,p]=c.useState(!1),[a,d]=c.useState(!1),[y,l]=c.useState("details"),[b,K]=c.useState([]),[F,_]=c.useState([]),[T,$]=c.useState(null),[L,ae]=c.useState(""),[M,R]=c.useState(!1),[m,N]=c.useState({name:"",sku:"",description:"",category:"",stock:"0",unit:"Adet",price:"",cost:"",min_stock:"0",max_stock:"",location:""});c.useEffect(()=>{var t,r,k,U,q;s&&(N({name:s.name||"",sku:s.sku||"",description:s.description||"",category:s.category||"",stock:((t=s.stock)==null?void 0:t.toString())||"0",unit:s.unit||"Adet",price:((r=s.price)==null?void 0:r.toString())||"",cost:((k=s.cost)==null?void 0:k.toString())||"",min_stock:((U=s.min_stock)==null?void 0:U.toString())||"0",max_stock:((q=s.max_stock)==null?void 0:q.toString())||"",location:s.location||""}),p(!1))},[s,i]),c.useEffect(()=>{i&&(s!=null&&s.id)&&y==="recipe"&&(Y(),te())},[i,s,y]);const Y=async()=>{if(s!=null&&s.id)try{const t=await Xe(s.id);K(t)}catch(t){f.error("Reçeteler yüklenemedi: "+t.message)}},te=async()=>{try{const t=await ss();_(t)}catch(t){f.error("Hammaddeler yüklenemedi: "+t.message)}},W=async()=>{if(!T||!L||!(s!=null&&s.id)){f.error("Lütfen hammadde ve miktar seçin");return}R(!0);try{await Ze(s.id,T,parseFloat(L)),f.success("Hammadde eklendi"),Y(),$(null),ae("")}catch(t){f.error("Hata: "+t.message)}finally{R(!1)}},A=async t=>{if(confirm("Bu hammaddeyi reçeteden çıkarmak istediğinizden emin misiniz?"))try{await Je(t),f.success("Hammadde çıkarıldı"),Y()}catch(r){f.error("Hata: "+r.message)}},ne=async(t,r)=>{if(!(!r||parseFloat(r)<=0))try{await es(t,parseFloat(r)),f.success("Miktar güncellendi"),Y()}catch(k){f.error("Hata: "+k.message)}},me=()=>b.reduce((t,r)=>{const k=r.rawMaterial;return t+((k==null?void 0:k.cost)||0)*r.quantityPerUnit},0),P=async t=>{if(t.preventDefault(),!!(s!=null&&s.id)){d(!0);try{await we(s.id,{name:m.name,sku:m.sku||null,description:m.description||null,category:m.category||null,imageUrl:null,image_url:null,stock:parseInt(m.stock)||0,unit:m.unit,price:m.price?parseFloat(m.price):null,unitPrice:m.price?parseFloat(m.price):null,cost:m.cost?parseFloat(m.cost):null,minStock:parseInt(m.min_stock)||0,maxStock:m.max_stock?parseInt(m.max_stock):null,location:m.location||null}),f.success("Ürün başarıyla güncellendi"),p(!1),x==null||x()}catch(r){console.error("Update product error:",r),f.error(r.message||"Ürün güncellenirken hata oluştu")}finally{d(!1)}}};if(!s)return null;const le=(t,r)=>t===0?"destructive":t<=r?"secondary":"default",H=(t,r)=>t===0?"Tükendi":t<=r?"Düşük Stok":"Stokta";return e.jsx(xe,{open:i,onOpenChange:g,children:e.jsx(he,{className:"!max-w-[100vw] sm:!max-w-[95vw] !w-[100vw] sm:!w-[95vw] !h-[100vh] sm:!h-[90vh] !max-h-[100vh] sm:!max-h-[90vh] !left-0 sm:!left-[2.5vw] !top-0 sm:!top-[5vh] !right-0 sm:!right-auto !bottom-0 sm:!bottom-auto !translate-x-0 !translate-y-0 overflow-hidden !p-0 gap-0 bg-white flex flex-col !m-0 !rounded-none sm:!rounded-lg !border-0 sm:!border",children:e.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[e.jsx(ue,{className:"p-3 sm:p-4 border-b bg-white flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-8 w-8 sm:h-10 sm:w-10 rounded-lg bg-primary/10 flex items-center justify-center border border-primary/20 flex-shrink-0",children:e.jsx(V,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),e.jsx(ge,{className:"text-lg sm:text-xl font-semibold text-foreground truncate",children:s.name})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 flex-shrink-0 relative z-10 pr-10 sm:pr-12",children:[e.jsx(se,{variant:le(s.stock,s.min_stock),className:"text-xs px-2 sm:px-3 py-1 relative z-10",children:H(s.stock,s.min_stock)}),v?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>{var t,r,k,U,q;p(!1),s&&N({name:s.name||"",sku:s.sku||"",description:s.description||"",category:s.category||"",stock:((t=s.stock)==null?void 0:t.toString())||"0",unit:s.unit||"Adet",price:((r=s.price)==null?void 0:r.toString())||"",cost:((k=s.cost)==null?void 0:k.toString())||"",min_stock:((U=s.min_stock)==null?void 0:U.toString())||"0",max_stock:((q=s.max_stock)==null?void 0:q.toString())||"",location:s.location||""})},disabled:a,className:"min-h-[44px] sm:min-h-0",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"İptal"]}),e.jsx(S,{size:"sm",onClick:P,disabled:a,className:"min-h-[44px] sm:min-h-0",children:a?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"h-4 w-4 mr-2 animate-spin"}),"Kaydediliyor..."]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Kaydet"]})})]}):e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>p(!0),className:"min-h-[44px] sm:min-h-0",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Düzenle"]})]})]})}),e.jsx("div",{className:"flex-1 overflow-hidden bg-gray-50/50 p-3 sm:p-4 min-h-0",children:e.jsx("div",{className:"max-w-full mx-auto h-full overflow-y-auto",children:v?e.jsx("form",{onSubmit:P,className:"space-y-4 sm:space-y-6",children:e.jsxs(C,{children:[e.jsx(Z,{children:e.jsx(J,{className:"text-lg sm:text-xl",children:"Temel Bilgiler"})}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"name",className:"text-sm sm:text-base",children:"Ürün Adı"}),e.jsx(h,{id:"name",value:m.name,onChange:t=>N({...m,name:t.target.value}),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"sku",className:"text-sm sm:text-base",children:"SKU"}),e.jsx(h,{id:"sku",value:m.sku,onChange:t=>N({...m,sku:t.target.value}),className:"min-h-[44px] sm:min-h-0",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"description",className:"text-sm sm:text-base",children:"Açıklama"}),e.jsx(je,{id:"description",value:m.description,onChange:t=>N({...m,description:t.target.value}),rows:3,className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"category",className:"text-sm sm:text-base",children:"Kategori"}),e.jsxs(B,{value:m.category||"none",onValueChange:t=>N({...m,category:t==="none"?"":t}),children:[e.jsx(G,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(O,{placeholder:"Kategori seçin"})}),e.jsxs(z,{children:[e.jsx(u,{value:"none",children:"Kategori Yok"}),ps.map(t=>e.jsx(u,{value:t,children:t},t))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"stock",className:"text-sm sm:text-base",children:"Stok"}),e.jsx(h,{id:"stock",type:"number",value:m.stock,onChange:t=>N({...m,stock:t.target.value}),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"unit",className:"text-sm sm:text-base",children:"Birim"}),e.jsxs(B,{value:m.unit||"",onValueChange:t=>N({...m,unit:t}),children:[e.jsx(G,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(O,{})}),e.jsxs(z,{children:[e.jsx(u,{value:"Adet",children:"Adet"}),e.jsx(u,{value:"Kg",children:"Kg"}),e.jsx(u,{value:"Lt",children:"Lt"}),e.jsx(u,{value:"Mt",children:"Mt"}),e.jsx(u,{value:"M2",children:"M²"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"price",className:"text-sm sm:text-base",children:"Satış Fiyatı"}),e.jsx(h,{id:"price",type:"number",step:"0.01",value:m.price,onChange:t=>N({...m,price:t.target.value}),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"cost",className:"text-sm sm:text-base",children:"Maliyet"}),e.jsx(h,{id:"cost",type:"number",step:"0.01",value:m.cost,onChange:t=>N({...m,cost:t.target.value}),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"min_stock",className:"text-sm sm:text-base",children:"Min. Stok"}),e.jsx(h,{id:"min_stock",type:"number",value:m.min_stock,onChange:t=>N({...m,min_stock:t.target.value}),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"max_stock",className:"text-sm sm:text-base",children:"Max. Stok"}),e.jsx(h,{id:"max_stock",type:"number",value:m.max_stock,onChange:t=>N({...m,max_stock:t.target.value}),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"location",className:"text-sm sm:text-base",children:"Konum"}),e.jsx(h,{id:"location",value:m.location,onChange:t=>N({...m,location:t.target.value}),className:"min-h-[44px] sm:min-h-0"})]})]})]})]})}):e.jsxs(_e,{value:y,onValueChange:l,className:"w-full",children:[e.jsxs(Me,{className:"grid w-full grid-cols-2 mb-4 sm:mb-6",children:[e.jsx(fe,{value:"details",className:"min-h-[44px] sm:min-h-0",children:"Detaylar"}),e.jsx(fe,{value:"recipe",className:"min-h-[44px] sm:min-h-0",children:"Reçete"})]}),e.jsx(Ne,{value:"details",className:"space-y-4 sm:space-y-6 mt-0",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[s.image_url&&e.jsx(C,{children:e.jsx(D,{className:"pt-6",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative w-full max-w-md h-64 rounded-lg overflow-hidden border border-border bg-muted",children:[e.jsx("img",{src:(()=>{if(!s.image_url)return"";if(s.image_url.startsWith("http://")||s.image_url.startsWith("https://"))return s.image_url;const t="http://localhost:3000",r=s.image_url.startsWith("/")?s.image_url:`/${s.image_url}`;return`${t}${r}`})(),alt:s.name,className:"w-full h-full object-cover",loading:"lazy",decoding:"async",onError:t=>{t.currentTarget.style.display="none";const r=t.currentTarget.nextElementSibling;r&&r.classList.remove("hidden")}}),e.jsx("div",{className:"hidden w-full h-full items-center justify-center bg-muted",children:e.jsx(xs,{className:"h-16 w-16 text-muted-foreground"})})]})})})}),e.jsxs(C,{children:[e.jsx(Z,{children:e.jsx(J,{className:"text-lg sm:text-xl",children:"Temel Bilgiler"})}),e.jsx(D,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"SKU"}),e.jsx("p",{className:"font-medium font-mono text-sm sm:text-base",children:s.sku||"-"})]}),s.category&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Kategori"}),e.jsx(se,{variant:"outline",className:"font-normal",children:s.category})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Mevcut Stok"}),e.jsxs("p",{className:"font-medium text-base sm:text-lg",children:[s.stock||0," ",s.unit||"Adet"]})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Durum"}),e.jsx(se,{variant:le(s.stock||0,s.min_stock||0),children:H(s.stock||0,s.min_stock||0)})]}),s.price&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Satış Fiyatı"}),e.jsxs("p",{className:"font-semibold text-base sm:text-lg",children:["₺",new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(s.price||0)]})]}),s.cost&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Maliyet"}),e.jsxs("p",{className:"font-medium text-sm sm:text-base",children:["₺",new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(s.cost||0)]})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Minimum Stok"}),e.jsxs("p",{className:"font-medium text-sm sm:text-base",children:[s.min_stock||0," ",s.unit||"Adet"]})]}),s.max_stock&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Maksimum Stok"}),e.jsxs("p",{className:"font-medium text-sm sm:text-base",children:[s.max_stock," ",s.unit||"Adet"]})]}),s.location&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Konum"}),e.jsx("p",{className:"font-medium text-sm sm:text-base",children:s.location})]})]})})]}),s.description&&e.jsxs(C,{children:[e.jsx(Z,{children:e.jsx(J,{className:"text-lg sm:text-xl",children:"Açıklama"})}),e.jsx(D,{children:e.jsx("p",{className:"text-sm sm:text-base whitespace-pre-wrap",children:s.description})})]})]})}),e.jsx(Ne,{value:"recipe",className:"space-y-4 sm:space-y-6 mt-0",children:e.jsxs(C,{children:[e.jsx(Z,{children:e.jsx(J,{className:"text-lg sm:text-xl",children:"Reçete Yönetimi"})}),e.jsxs(D,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3 text-sm sm:text-base",children:"Hammadde Listesi"}),b.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8 text-sm sm:text-base",children:"Henüz hammadde eklenmemiş"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0",children:e.jsx("div",{className:"inline-block min-w-full align-middle px-4 sm:px-0",children:e.jsxs(as,{className:"w-full",children:[e.jsx(ts,{children:e.jsxs(ye,{children:[e.jsx(Q,{children:"Hammadde"}),e.jsx(Q,{children:"Miktar (Birim üretim için)"}),e.jsx(Q,{children:"Mevcut Stok"}),e.jsx(Q,{children:"Birim Maliyet"}),e.jsx(Q,{children:"Toplam Maliyet"}),e.jsx(Q,{className:"w-[80px]",children:"İşlem"})]})}),e.jsx(ls,{children:b.map(t=>{const r=t.rawMaterial;return e.jsxs(ye,{children:[e.jsx(X,{className:"font-medium",children:(r==null?void 0:r.name)||"Silinmiş"}),e.jsx(X,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{type:"number",step:"0.01",value:t.quantityPerUnit,onChange:k=>ne(t.id,k.target.value),className:"w-24 min-h-[44px] sm:min-h-0"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:r==null?void 0:r.unit})]})}),e.jsxs(X,{children:[r==null?void 0:r.stock," ",r==null?void 0:r.unit]}),e.jsxs(X,{children:["₺",new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format((r==null?void 0:r.cost)||0)]}),e.jsxs(X,{children:["₺",new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(((r==null?void 0:r.cost)||0)*t.quantityPerUnit)]}),e.jsx(X,{children:e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>A(t.id),className:"min-h-[44px] sm:min-h-0",children:e.jsx(Se,{className:"h-4 w-4 text-destructive"})})})]},t.id)})})]})})}),e.jsx("div",{className:"flex justify-end mt-3 pt-3 border-t",children:e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Toplam Hammadde Maliyeti (Birim)"}),e.jsxs("p",{className:"text-xl sm:text-2xl font-bold",children:["₺",new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(me()||0)]})]})})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium mb-3 text-sm sm:text-base",children:"Yeni Hammadde Ekle"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(o,{className:"text-sm sm:text-base",children:"Hammadde"}),e.jsxs(B,{value:T??void 0,onValueChange:$,children:[e.jsx(G,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(O,{placeholder:"Hammadde seçin..."})}),e.jsx(z,{children:F.map(t=>e.jsxs(u,{value:t.id,children:[t.name," (",t.currentStock," ",t.unit," - ₺",new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(t.unitPrice||0),"/",t.unit,")"]},t.id))})]})]}),e.jsxs("div",{className:"w-full sm:w-32",children:[e.jsx(o,{className:"text-sm sm:text-base",children:"Miktar"}),e.jsx(h,{type:"number",step:"1",min:"0",placeholder:"Miktar",value:L,onChange:t=>ae(t.target.value),className:"min-h-[44px] sm:min-h-0"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(S,{onClick:W,disabled:M,className:"w-full sm:w-auto min-h-[44px] sm:min-h-0",children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"}),"Ekle"]})})]})]})]})]})})]})})})]})})})},De=c.memo(({product:i,usersMap:g={},onSelect:s,onEdit:x,onDelete:v})=>{const p=Number(i.stock)||0,a=Number(i.min_stock??i.minStock??0),d=p>0&&p<=a,y=p===0;return e.jsx(C,{className:"group hover:shadow-xl transition-all duration-300 cursor-pointer border border-border/60 hover:border-primary/50 flex flex-col h-full overflow-hidden bg-white hover:-translate-y-1 max-w-full",onClick:()=>s(i),children:e.jsxs(D,{className:"p-5 sm:p-6 flex flex-col flex-1 gap-4 sm:gap-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-bold text-base sm:text-lg truncate text-foreground flex-1",title:i.name,children:i.name}),y&&e.jsx(se,{variant:"destructive",className:"flex-shrink-0 whitespace-nowrap text-xs px-2 py-0.5",children:"Tükendi"}),d&&!y&&e.jsx(se,{variant:"secondary",className:"flex-shrink-0 whitespace-nowrap text-xs px-2 py-0.5",children:"Düşük"})]}),i.category&&e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[e.jsx(Re,{className:"h-3.5 w-3.5 text-muted-foreground flex-shrink-0"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",title:i.category,children:i.category})]}),i.sku&&e.jsxs("p",{className:"text-xs text-muted-foreground font-mono mt-1 truncate",title:i.sku,children:["SKU: ",i.sku]})]}),e.jsxs(Ee,{children:[e.jsx(Ie,{asChild:!0,children:e.jsx(S,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0 hover:bg-muted/80 rounded-lg",onClick:l=>l.stopPropagation(),children:e.jsx(ns,{className:"h-4 w-4"})})}),e.jsxs(Be,{align:"end",children:[e.jsxs(ce,{onClick:l=>{l.stopPropagation(),s(i)},children:[e.jsx(oe,{className:"mr-2 h-4 w-4"})," Detayları Görüntüle"]}),e.jsxs(ce,{onClick:l=>{l.stopPropagation(),x(i)},children:[e.jsx(oe,{className:"mr-2 h-4 w-4"})," Düzenle"]}),e.jsxs(ce,{className:"text-destructive focus:text-destructive",onClick:l=>{l.stopPropagation(),v(i)},children:[e.jsx(Se,{className:"mr-2 h-4 w-4"})," Sil"]})]})]})]}),e.jsxs("div",{className:"space-y-2.5 flex-1 min-h-[60px]",children:[i.sku&&e.jsxs("div",{className:"flex items-center gap-2.5 text-xs sm:text-sm bg-gradient-to-r from-muted/40 to-muted/30 rounded-lg px-3.5 py-2.5 border border-muted/60 shadow-sm hover:shadow transition-shadow",children:[e.jsx(V,{className:"h-4 w-4 sm:h-4.5 sm:w-4.5 text-primary flex-shrink-0"}),e.jsx("span",{className:"truncate text-foreground font-medium font-mono",title:i.sku,children:i.sku})]}),i.description&&e.jsxs("div",{className:"flex items-start gap-2.5 text-xs sm:text-sm bg-gradient-to-r from-muted/40 to-muted/30 rounded-lg px-3.5 py-2.5 border border-muted/60 shadow-sm hover:shadow transition-shadow",children:[e.jsx(V,{className:"h-4 w-4 sm:h-4.5 sm:w-4.5 text-primary flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"line-clamp-2 text-foreground",children:i.description})]}),!i.sku&&!i.description&&e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground italic py-3 text-center bg-muted/20 rounded-lg border border-dashed border-muted",children:"Ürün bilgisi yok"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-border/60",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx(V,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Stok"})]}),e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-foreground",children:p}),e.jsx("div",{className:"h-4 mt-0.5",children:a>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Min: ",a]})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx(ms,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Fiyat"})]}),e.jsxs("span",{className:"text-xl sm:text-2xl font-bold text-foreground",children:["₺",new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(i.price||0)]}),e.jsx("div",{className:"h-4 mt-0.5"})]})]}),(i.location||i.createdBy)&&e.jsxs("div",{className:"pt-3 border-t border-border/60 space-y-1.5",children:[i.location&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(cs,{className:"h-3.5 w-3.5 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:i.location})]}),i.createdBy&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Ae,{className:"h-3.5 w-3.5 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:g[i.createdBy]||"Bilinmeyen Kullanıcı"})]})]})]})})},(i,g)=>{var s,x;return i.product.id===g.product.id&&i.product.name===g.product.name&&i.product.stock===g.product.stock&&i.product.price===g.product.price&&i.product.category===g.product.category&&i.product.sku===g.product.sku&&i.product.createdBy===g.product.createdBy&&((s=i.usersMap)==null?void 0:s[i.product.createdBy])===((x=g.usersMap)==null?void 0:x[g.product.createdBy])});De.displayName="ProductCard";const Ns=["Taşınabilir Güç Paketleri","Kabin Tipi Güç Paketleri","Araç Tipi Güç Paketleri","Endüstriyel Güç Paketleri","Güneş Enerji Sistemleri"],Gs=()=>{const[i,g]=c.useState([]),[s,x]=c.useState(!0),[v,p]=c.useState(!1),[a,d]=c.useState(!1),[y,l]=c.useState(!1),[b,K]=c.useState(!1),[F,_]=c.useState(null),[T,$]=c.useState(""),[L,ae]=c.useState(""),[M,R]=c.useState("all"),[m,N]=c.useState("all"),[Y,te]=c.useState(!1),[W,A]=c.useState(null),[ne,me]=c.useState({});c.useEffect(()=>{P()},[]),c.useEffect(()=>{const n=setTimeout(()=>{ae(T)},300);return()=>clearTimeout(n)},[T]);const P=c.useCallback(async()=>{try{x(!0);const[n,j]=await Promise.all([Ge(),Pe()]);g(n);const w={};j.forEach(E=>{w[E.id]=E.fullName||E.displayName||E.email||"Bilinmeyen"}),me(w)}catch(n){f.error(n.message||"Ürünler yüklenirken hata oluştu")}finally{x(!1)}},[]),le=c.useCallback(async()=>{if(F)try{await Oe(F.id),f.success("Ürün silindi"),P(),K(!1),_(null)}catch(n){f.error(n.message||"Ürün silinirken hata oluştu")}},[F,P]),H=c.useCallback(n=>{const j=Number(n.stock)||0,w=Number(n.min_stock??n.minStock??0);return j>0&&j<=w},[]),t=c.useCallback(n=>(Number(n.stock)||0)===0,[]),r=c.useMemo(()=>{const n=i.length,j=i.filter(I=>H(I)).length,w=i.filter(I=>t(I)).length,E=i.reduce((I,ee)=>{const ie=ee.price||0,Fe=ee.stock||0;return I+ie*Fe},0);return{total:n,lowStock:j,outOfStock:w,totalValue:E}},[i,H,t]),k=c.useMemo(()=>Array.isArray(i)?i.filter(n=>{var I,ee,ie;const j=((I=n.name)==null?void 0:I.toLocaleLowerCase("tr-TR").includes(L.toLocaleLowerCase("tr-TR")))||((ee=n.sku)==null?void 0:ee.toLocaleLowerCase("tr-TR").includes(L.toLocaleLowerCase("tr-TR")))||((ie=n.category)==null?void 0:ie.toLocaleLowerCase("tr-TR").includes(L.toLocaleLowerCase("tr-TR"))),w=M==="all"||n.category===M,E=m==="all"||m==="low"&&H(n)||m==="out"&&t(n);return j&&w&&E}):[],[i,L,M,m,H,t]),U=c.useMemo(()=>{var n,j;try{return`₺${new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(r.totalValue||0)}`}catch{return`₺${((j=(n=r.totalValue)==null?void 0:n.toFixed)==null?void 0:j.call(n,0))??"0"}`}},[r.totalValue]),q=[{key:"total-products",label:"Toplam Ürün",value:r.total,icon:V,accent:"bg-primary/10 text-primary",description:"Tüm ürün kayıtları",onClick:()=>{N("all"),R("all"),$(""),A("total-products")},isActive:W==="total-products"},{key:"low-stock",label:"Düşük Stok",value:r.lowStock,icon:Ke,accent:"bg-amber-100 text-amber-700",description:"Kritik stok seviyeleri",onClick:()=>{N("low"),R("all"),A("low-stock")},isActive:W==="low-stock"},{key:"out-of-stock",label:"Tükenen Ürünler",value:r.outOfStock,icon:ds,accent:"bg-red-100 text-red-700",description:"Stoğu tamamen bitenler",onClick:()=>{N("out"),R("all"),A("out-of-stock")},isActive:W==="out-of-stock"},{key:"total-value",label:"Toplam Değer",value:U,icon:os,accent:"bg-emerald-100 text-emerald-700",description:"Detaylı raporlar",onClick:()=>{A("total-value"),te(!0)},isActive:W==="total-value"}];return s?e.jsx(ve,{children:e.jsx(rs,{message:"Ürünler yükleniyor..."})}):e.jsxs(ve,{children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-foreground",children:"Ürünler"}),e.jsx("p",{className:"text-muted-foreground mt-0.5 sm:mt-1 text-xs sm:text-sm",children:"Stok ve ürün yönetimi"})]}),e.jsxs(S,{className:"gap-2 w-full sm:w-auto min-h-[44px] sm:min-h-0",onClick:()=>p(!0),children:[e.jsx(Ce,{className:"h-4 w-4"}),"Yeni Ürün"]})]}),e.jsx(C,{children:e.jsx(D,{className:"pt-6",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:q.map(n=>{const j=n.icon;return e.jsx(C,{className:ke("border border-border/60 shadow-none cursor-pointer transition-all hover:shadow-md focus-within:ring-2 focus-within:ring-primary/40",n.isActive&&"border-primary shadow-lg ring-2 ring-primary/20"),role:"button",tabIndex:0,onClick:n.onClick,onKeyDown:w=>{(w.key==="Enter"||w.key===" ")&&(w.preventDefault(),n.onClick())},"aria-label":`${n.label} kartı`,children:e.jsxs(D,{className:"p-4 flex items-center gap-4",children:[e.jsx("div",{className:ke("h-12 w-12 rounded-2xl flex items-center justify-center",n.accent),children:e.jsx(j,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:n.label}),e.jsx("p",{className:"text-2xl font-bold text-foreground mt-1",children:n.value}),e.jsx("p",{className:"text-[11px] text-muted-foreground mt-0.5",children:n.description})]})]})},n.key)})})})}),e.jsx(C,{children:e.jsx(D,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3 sm:gap-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px] sm:min-w-[250px]",children:e.jsx(ze,{placeholder:"Ürün, SKU veya kategori ara...",className:"w-full h-10",value:T,onChange:n=>{$(n.target.value),n.target.value===""&&A(null)}})}),e.jsx("div",{className:"w-full sm:w-auto sm:min-w-[180px]",children:e.jsxs(B,{value:M,onValueChange:n=>{R(n),A(null)},children:[e.jsx(G,{className:"w-full h-10",children:e.jsx(O,{placeholder:"Kategori"})}),e.jsxs(z,{children:[e.jsx(u,{value:"all",children:"Tüm Kategoriler"}),Ns.map(n=>e.jsx(u,{value:n,children:n},n))]})]})}),(T||M!=="all"||m!=="all")&&e.jsxs(S,{variant:"outline",size:"sm",onClick:()=>{$(""),R("all"),N("all"),A(null)},className:"h-10",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Temizle"]})]})})}),k.length===0?e.jsx(C,{children:e.jsx(D,{className:"p-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-muted/50 rounded-full flex items-center justify-center mb-4",children:e.jsx(V,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:T||M!=="all"?"Arama sonucu bulunamadı":"Henüz ürün bulunmuyor"}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-md mx-auto",children:T||M!=="all"?"Filtreleri değiştirerek tekrar deneyin":"Yeni ürün eklemek için yukarıdaki butona tıklayın"})]})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6",children:k.map(n=>e.jsx(De,{product:n,usersMap:ne,onSelect:j=>{_(j),l(!0)},onEdit:j=>{_(j),d(!0)},onDelete:j=>{_(j),K(!0)}},n.id))})]}),e.jsx(us,{open:v,onOpenChange:p,onSuccess:P}),F&&e.jsxs(e.Fragment,{children:[e.jsx(js,{open:a,onOpenChange:d,onSuccess:P,product:F}),e.jsx(fs,{open:y,onOpenChange:l,product:F,onUpdate:P})]}),e.jsx(Ve,{open:b,onOpenChange:K,children:e.jsxs(He,{children:[e.jsxs(Ue,{children:[e.jsx(qe,{children:"Ürünü sil?"}),e.jsx($e,{children:"Bu işlem geri alınamaz. Ürün kalıcı olarak silinecek."})]}),e.jsxs(Ye,{children:[e.jsx(We,{children:"İptal"}),e.jsx(Qe,{onClick:le,children:"Sil"})]})]})}),e.jsx(is,{open:Y,onOpenChange:te,title:"Ürün Değer Raporu",type:"products",data:i})]})};export{Gs as default};

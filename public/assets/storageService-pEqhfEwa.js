import{ad as l,ae as c,af as m}from"./index-Xd90qdO9.js";import{u as s,d as f}from"./driveService-020R8zku.js";const d=e=>({provider:"google_drive",fileId:e.fileId,webViewLink:e.webViewLink,webContentLink:e.webContentLink,url:e.webViewLink||e.webContentLink||""}),k=async(e,r,o)=>{if(e.size>10*1024*1024)throw new Error("Dosya boyutu 10MB'dan küçük olmalıdır");const a=Date.now(),t=`tasks/${r}/attachments/${a}_${e.name}`,n=await s(e,{type:"task",fileName:e.name,metadata:{taskId:r,path:t}});return d(n)},p=async(e,r,o,a)=>{const t=Date.now(),n=`reports/${r}/${t}.pdf`,i=e instanceof File?e:new File([e],`${t}.pdf`,{type:"application/pdf"}),w=await s(i,{type:"report",fileName:i.name,metadata:{reportType:r,reportId:null,path:n}});return d(w)},b=async(e,r)=>{var o;try{if((r==null?void 0:r.provider)==="google_drive"||r!=null&&r.fileId){if(!(r!=null&&r.fileId))throw new Error("Drive dosyasını silmek için fileId gerekli");await f(r.fileId);return}if(!l)throw new Error("Firebase Storage başlatılmamış");const a=new URL(e),t=decodeURIComponent(((o=a.pathname.split("/o/")[1])==null?void 0:o.split("?")[0])||"");if(!t)throw new Error("Geçersiz dosya URL'i");const n=c(l,t);await m(n)}catch(a){throw console.error("Delete file error:",a),new Error(a.message||"Dosya silinirken hata oluştu")}};export{b as deleteFile,p as uploadReportPDF,k as uploadTaskAttachment};

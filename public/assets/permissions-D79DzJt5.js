import{getPermission as o}from"./rolePermissionsService-CoZ8Qmsy.js";import"./index-Xd90qdO9.js";const a=r=>{var e,n;return r&&(((e=r.role)==null?void 0:e.includes("main_admin"))||((n=r.role)==null?void 0:n.includes("super_admin")))||!1},m=r=>{var e,n,t;return r&&(((e=r.role)==null?void 0:e.includes("admin"))||((n=r.role)==null?void 0:n.includes("main_admin"))||((t=r.role)==null?void 0:t.includes("super_admin")))||!1},y=async(r,e=[])=>r?a(r)?!0:await c(r,"tasks"):!1,P=async(r,e=[])=>r?a(r)?!0:await c(r,"projects"):!1,h=async(r,e)=>!e||!r?!1:a(e)?!0:await f(e,"tasks"),p=async(r,e,n=[])=>!e||!r?!1:!!(a(e)||await f(e,"tasks")||n.includes(e.id)||r.assignedUsers&&r.assignedUsers.includes(e.id)),w=async(r,e,n=[])=>!e||!r?!1:a(e)?!0:r.onlyInMyTasks?r.createdBy===e.id:r.isPrivate?r.isPrivate?!!(await l(e,"tasks")||n.includes(e.id)||r.assignedUsers&&r.assignedUsers.includes(e.id)||r.createdBy===e.id):!1:!0,s=async(r,e,n)=>{if(!r||!r.role||r.role.length===0)return!1;for(const t of r.role)try{const i=await o(t,e);if(i&&i[n])return!0}catch(i){console.error(`Error checking permission for role ${t} and resource ${e}:`,i)}return!1},g=async(r,e,n)=>{if(!r||!r.role||r.role.length===0)return!1;if(a(r))return!0;for(const t of r.role)try{const i=await o(t,e);if(i&&i.subPermissions&&i.subPermissions[n])return!0}catch(i){console.error(`Error checking sub-permission for role ${t}, resource ${e}, subPermission ${n}:`,i)}return!1},c=async(r,e)=>r?a(r)?!0:await s(r,e,"canCreate"):!1,l=async(r,e)=>r?a(r)?!0:await s(r,e,"canRead"):!1,f=async(r,e)=>r?a(r)?!0:await s(r,e,"canUpdate"):!1;export{P as canCreateProject,c as canCreateResource,y as canCreateTask,h as canEditTask,p as canInteractWithTask,g as canPerformSubPermission,l as canReadResource,f as canUpdateResource,w as canViewTask,m as isAdmin,a as isMainAdmin};

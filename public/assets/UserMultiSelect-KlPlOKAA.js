const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/toastHelpers-I2G9dhou.js","assets/index-Xd90qdO9.js","assets/index-HS3kTX7E.css","assets/taskService-CQO0i9v5.js"])))=>i.map(i=>d[i]);
import{a3 as C,r as l,g as _,_ as P,b as f,j as a,B as A,o as E,at as L,V as m,v as B,X as K}from"./index-Xd90qdO9.js";import{N as O,O as S,Q as T,R as I,U as V,V as $,B as z}from"./MainLayout-DW7UjMSA.js";import{P as D,a as F,b as M}from"./popover-BA39Kv9C.js";import{A as R,a as U}from"./avatar-KtUT5CWN.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=C("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),q=({selectedUsers:t,onSelectionChange:c,disabled:o})=>{const[n,p]=l.useState([]),[x,g]=l.useState(!1),[d,h]=l.useState(!0),[i,b]=l.useState("");l.useEffect(()=>{v()},[]);const v=async()=>{try{h(!0);const r=(await _()).filter(s=>s.id&&(s.fullName||s.displayName||s.email)).map(s=>({id:s.id,full_name:s.fullName||s.displayName||s.email||"İsimsiz Kullanıcı",email:s.email||"",department_id:s.departmentId||null}));p(r)}catch(e){const r=e.message||"Bilinmeyen hata";if(r.includes("permission")||r.includes("permissions")){const{showPermissionErrorToast:s}=await P(async()=>{const{showPermissionErrorToast:k}=await import("./toastHelpers-I2G9dhou.js");return{showPermissionErrorToast:k}},__vite__mapDeps([0,1,2,3]));s("read","user")}else r.includes("network")||r.includes("unavailable")?f.error("İnternet bağlantısı hatası. Lütfen bağlantınızı kontrol edin."):f.error("Kullanıcılar yüklenirken hata oluştu: "+r);p([])}finally{h(!1)}},u=l.useMemo(()=>{if(!i.trim())return n;const e=i.trim().toLowerCase();return n.filter(r=>r.full_name&&r.full_name.toLowerCase().includes(e)||r.email&&r.email.toLowerCase().includes(e))},[n,i]),y=e=>{t.includes(e)?c(t.filter(r=>r!==e)):c([...t,e])},j=e=>{c(t.filter(r=>r!==e))},N=()=>!n||n.length===0?[]:n.filter(e=>e&&e.id&&t.includes(e.id)).map(e=>e.full_name||"İsimsiz Kullanıcı"),w=e=>e.split(" ").map(r=>r[0]).join("").toUpperCase().slice(0,2);return a.jsxs("div",{className:"space-y-2",children:[a.jsxs(D,{open:x,onOpenChange:e=>!o&&g(e),children:[a.jsx(F,{asChild:!0,children:a.jsxs(A,{variant:"outline",className:"w-full justify-between h-11 border-2 hover:border-primary/50 transition-colors",disabled:o,children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(E,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{className:"text-sm font-medium",children:t.length>0?`${t.length} kullanıcı seçildi`:"Kullanıcı seçin"})]}),a.jsx(L,{className:m("h-4 w-4 text-muted-foreground transition-transform duration-200",x&&"transform rotate-180")})]})}),a.jsx(M,{className:"w-[90vw] sm:w-[400px] p-0 shadow-lg border-2",side:"bottom",align:"start",sideOffset:4,onOpenAutoFocus:e=>e.preventDefault(),collisionPadding:16,avoidCollisions:!1,children:a.jsxs(O,{shouldFilter:!1,className:"rounded-lg",children:[a.jsx("div",{className:"border-b px-3 py-2.5 bg-transparent",children:a.jsx(S,{placeholder:"Kullanıcı ara...",value:i,onValueChange:e=>b(e),className:"border-0 focus:ring-0 bg-transparent"})}),a.jsxs(T,{className:"max-h-[300px] overflow-y-auto overflow-x-hidden scroll-smooth",style:{height:"var(--cmdk-list-height)",maxHeight:"300px",scrollPaddingBlock:"10px"},children:[a.jsx(I,{className:"py-6 text-center text-sm text-muted-foreground",children:d?"Yükleniyor...":u.length===0?i?"Arama sonucu bulunamadı.":"Kullanıcı bulunamadı.":"Arama sonucu bulunamadı."}),!d&&u.length>0&&a.jsx(V,{children:u.map(e=>a.jsxs($,{value:`${e.id}-${e.full_name}-${e.email}`,onSelect:()=>{y(e.id)},className:m("flex items-center gap-3 cursor-pointer px-3 py-2.5 rounded-md mx-1 my-0.5 transition-colors","hover:bg-accent hover:text-accent-foreground",t.includes(e.id)&&"bg-primary/10"),children:[a.jsx("div",{className:m("flex h-5 w-5 items-center justify-center rounded border-2 shrink-0 pointer-events-none transition-all",t.includes(e.id)?"bg-primary border-primary text-primary-foreground":"border-muted-foreground/30 bg-background"),children:t.includes(e.id)&&a.jsx(B,{className:"h-3.5 w-3.5 stroke-[3]"})}),a.jsx(R,{className:"h-8 w-8 shrink-0 border-2 border-background shadow-sm",children:a.jsx(U,{className:"text-xs font-semibold bg-gradient-to-br from-primary/20 to-primary/10 text-primary",children:w(e.full_name)})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-medium truncate",children:e.full_name}),a.jsx("div",{className:"text-xs text-muted-foreground truncate",children:e.email})]})]},e.id))}),d&&a.jsxs("div",{className:"p-6 text-sm text-muted-foreground text-center",children:[a.jsx("div",{className:"inline-block h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"}),a.jsx("span",{className:"ml-2",children:"Yükleniyor..."})]})]})]})})]}),t.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 pt-1",children:N().map((e,r)=>{const s=t[r];return s?a.jsxs(z,{variant:"secondary",className:"gap-1.5 px-3 py-1.5 text-sm font-medium bg-primary/10 text-primary border-primary/20 hover:bg-primary/20 transition-colors",children:[a.jsx("span",{className:"truncate max-w-[120px] sm:max-w-none",children:e}),a.jsx(K,{className:m("h-3.5 w-3.5 shrink-0 rounded-full hover:bg-primary/20 p-0.5 transition-colors",!o&&"cursor-pointer"),onClick:()=>!o&&j(s)})]},s):null})})]})};export{X as P,q as U};

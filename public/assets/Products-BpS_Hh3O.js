var Ke=Object.defineProperty,Ie=Object.defineProperties;var Be=Object.getOwnPropertyDescriptors;var ye=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable;var be=(i,o,s)=>o in i?Ke(i,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[o]=s,h=(i,o)=>{for(var s in o||(o={}))Oe.call(o,s)&&be(i,s,o[s]);if(ye)for(var s of ye(o))ze.call(o,s)&&be(i,s,o[s]);return i},u=(i,o)=>Ie(i,Be(o));var E=(i,o,s)=>new Promise((g,w)=>{var k=f=>{try{d(s.next(f))}catch(l){w(l)}},a=f=>{try{d(s.throw(f))}catch(l){w(l)}},d=f=>f.done?g(f.value):Promise.resolve(f.value).then(k,a);d((s=s.apply(i,o)).next())});import{u as Ge,j as e,B as L,C as K,p as se,q as ae,b as I,L as x,I as j,S as U,c as V,d as H,e as Y,f as p,a as N,m as Ue,n as Ve,o as we,y as Se,r as He,l as Ce}from"./index-BQmY0BmM.js";import{r as m,o as J,X as ce,m as ue,I as ge,S as he,aj as Ye,T as Te,P as _e,J as qe,E as $e,D as We,V as Je,l as Qe,s as Xe,ak as Ze,q as es}from"./lucide-react-CAeuRJQk.js";import{D as je,a as pe,b as fe,c as Ne,e as ve,T as ke,a1 as ss,a2 as Me,B as ie,f as as,h as ts,i as ls,j as xe,l as is,a3 as rs,M as De}from"./MainLayout-Dv9j77B5.js";import{S as ns}from"./search-input-DCf0xYml.js";import{A as ms,a as cs,b as os,c as ds,d as xs,e as hs,f as us,g as gs}from"./alert-dialog-vDPnsgl6.js";import{getProductRecipes as js,addRecipeItem as ps,deleteRecipeItem as fs,updateRecipeItem as Ns}from"./recipeService-B644vMa2.js";import{getRawMaterials as vs}from"./materialService-BHW8dEom.js";import{T as ks,a as ys,b as Fe,c as Z,d as bs,e as ee}from"./table-zhTdMUM_.js";import{D as ws}from"./DetailedValueReportModal-BRj7dqdh.js";import{L as Ss}from"./loading-state-BC76X596.js";import{C as Cs,D as Ae,a as Ds}from"./currency-BpxR3_y8.js";import{a as Fs}from"./exchangeRateService-Ba2gZPdu.js";import"./taskService-CI62TrOj.js";const Ts=["Taşınabilir Güç Paketleri","Kabin Tipi Güç Paketleri","Araç Tipi Güç Paketleri","Endüstriyel Güç Paketleri","Güneş Enerji Sistemleri"],_s=({open:i,onOpenChange:o,onSuccess:s})=>{const{user:g}=Ge(),[w,k]=m.useState(!1),[a,d]=m.useState({name:"",sku:`PRD-${Date.now()}`,description:"",category:"",stock:"0",unit:"Adet",price:"",cost:"",min_stock:"0",max_stock:"",location:""}),f=l=>E(void 0,null,function*(){l&&l.preventDefault(),k(!0);try{if(!g){N.error("Oturumunuz sona erdi. Lütfen tekrar giriş yapın."),k(!1);return}yield ss({name:a.name,sku:a.sku||null,description:a.description||null,category:a.category||null,imageUrl:null,image_url:null,stock:parseInt(a.stock)||0,unit:a.unit,price:a.price?parseFloat(a.price):null,unitPrice:a.price?parseFloat(a.price):null,cost:a.cost?parseFloat(a.cost):null,minStock:parseInt(a.min_stock)||0,maxStock:a.max_stock?parseInt(a.max_stock):null,location:a.location||null,createdBy:g.id}),N.success("Ürün başarıyla oluşturuldu"),s(),o(!1),d({name:"",sku:`PRD-${Date.now()}`,description:"",category:"",stock:"0",unit:"Adet",price:"",cost:"",min_stock:"0",max_stock:"",location:""})}catch(F){N.error(F.message||"Ürün oluşturulurken hata oluştu")}finally{k(!1)}});return e.jsx(je,{open:i,onOpenChange:o,children:e.jsx(pe,{className:"!max-w-[100vw] sm:!max-w-[95vw] !w-[100vw] sm:!w-[95vw] !h-[100vh] sm:!h-[90vh] !max-h-[100vh] sm:!max-h-[90vh] !left-0 sm:!left-[2.5vw] !top-0 sm:!top-[5vh] !right-0 sm:!right-auto !bottom-0 sm:!bottom-auto !translate-x-0 !translate-y-0 overflow-hidden !p-0 gap-0 bg-white flex flex-col !m-0 !rounded-none sm:!rounded-lg !border-0 sm:!border",children:e.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[e.jsx(fe,{className:"p-3 sm:p-4 border-b bg-white flex-shrink-0 relative pr-12 sm:pr-16",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-8 w-8 sm:h-10 sm:w-10 rounded-lg bg-primary/10 flex items-center justify-center border border-primary/20 flex-shrink-0",children:e.jsx(J,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),e.jsx(Ne,{className:"text-lg sm:text-xl font-semibold text-foreground truncate",children:"Yeni Ürün"}),e.jsx(ve,{className:"sr-only",children:"Yeni ürün eklemek için formu doldurun"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 flex-shrink-0",children:[e.jsxs(L,{variant:"outline",size:"sm",className:"border-primary/20 hover:bg-primary/5 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0",onClick:()=>o(!1),disabled:w,children:[e.jsx(ce,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"İptal"]}),e.jsxs(L,{variant:"default",size:"sm",className:"bg-primary hover:bg-primary/90 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0 text-white",onClick:f,disabled:w,children:[w?e.jsx(ue,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0 animate-spin"}):e.jsx(ge,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Kaydet"]})]})]})}),e.jsx("div",{className:"flex-1 overflow-hidden bg-gray-50/50 p-3 sm:p-4 min-h-0",children:e.jsx("div",{className:"max-w-full mx-auto h-full overflow-y-auto",children:e.jsx("form",{onSubmit:l=>{l.preventDefault(),f(l)},className:"space-y-4 sm:space-y-6",children:e.jsxs(K,{children:[e.jsx(se,{children:e.jsx(ae,{className:"text-lg sm:text-xl",children:"Temel Bilgiler"})}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"name",className:"text-sm sm:text-base",children:"Ürün Adı"}),e.jsx(j,{id:"name",value:a.name,onChange:l=>d(u(h({},a),{name:l.target.value})),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"sku",className:"text-sm sm:text-base",children:"SKU"}),e.jsx(j,{id:"sku",value:a.sku,onChange:l=>d(u(h({},a),{sku:l.target.value})),className:"min-h-[44px] sm:min-h-0",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"description",className:"text-sm sm:text-base",children:"Açıklama"}),e.jsx(ke,{id:"description",value:a.description,onChange:l=>d(u(h({},a),{description:l.target.value})),rows:3,className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"category",className:"text-sm sm:text-base",children:"Kategori"}),e.jsxs(U,{value:a.category?a.category:"none",onValueChange:l=>d(u(h({},a),{category:l==="none"?"":l})),children:[e.jsx(V,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(H,{placeholder:"Kategori seçin"})}),e.jsxs(Y,{children:[e.jsx(p,{value:"none",children:"Kategori Yok"}),Ts.map(l=>e.jsx(p,{value:l,children:l},l))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"stock",className:"text-sm sm:text-base",children:"Stok"}),e.jsx(j,{id:"stock",type:"number",value:a.stock,onChange:l=>d(u(h({},a),{stock:l.target.value})),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"unit",className:"text-sm sm:text-base",children:"Birim"}),e.jsxs(U,{value:a.unit?a.unit:"",onValueChange:l=>d(u(h({},a),{unit:l})),children:[e.jsx(V,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(H,{})}),e.jsxs(Y,{children:[e.jsx(p,{value:"Adet",children:"Adet"}),e.jsx(p,{value:"Kg",children:"Kg"}),e.jsx(p,{value:"Lt",children:"Lt"}),e.jsx(p,{value:"Mt",children:"Mt"}),e.jsx(p,{value:"M2",children:"M²"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"price",className:"text-sm sm:text-base",children:"Satış Fiyatı"}),e.jsx(j,{id:"price",type:"number",step:"0.01",value:a.price,onChange:l=>d(u(h({},a),{price:l.target.value})),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"cost",className:"text-sm sm:text-base",children:"Maliyet"}),e.jsx(j,{id:"cost",type:"number",step:"0.01",value:a.cost,onChange:l=>d(u(h({},a),{cost:l.target.value})),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"min_stock",className:"text-sm sm:text-base",children:"Min. Stok"}),e.jsx(j,{id:"min_stock",type:"number",value:a.min_stock,onChange:l=>d(u(h({},a),{min_stock:l.target.value})),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"max_stock",className:"text-sm sm:text-base",children:"Max. Stok"}),e.jsx(j,{id:"max_stock",type:"number",value:a.max_stock,onChange:l=>d(u(h({},a),{max_stock:l.target.value})),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"location",className:"text-sm sm:text-base",children:"Konum"}),e.jsx(j,{id:"location",value:a.location,onChange:l=>d(u(h({},a),{location:l.target.value})),className:"min-h-[44px] sm:min-h-0"})]})]})]})]})})})})]})})})},Ms=["Taşınabilir Güç Paketleri","Kabin Tipi Güç Paketleri","Araç Tipi Güç Paketleri","Endüstriyel Güç Paketleri","Güneş Enerji Sistemleri"],As=({open:i,onOpenChange:o,onSuccess:s,product:g})=>{const[w,k]=m.useState(!1),[a,d]=m.useState({name:"",sku:"",description:"",category:"",stock:"0",unit:"Adet",price:"",cost:"",min_stock:"0",max_stock:"",location:""});m.useEffect(()=>{var l,F,M,T,A;g&&d({name:g.name||"",sku:g.sku||"",description:g.description||"",category:g.category||"",stock:((l=g.stock)==null?void 0:l.toString())||"0",unit:g.unit||"Adet",price:((F=g.price)==null?void 0:F.toString())||"",cost:((M=g.cost)==null?void 0:M.toString())||"",min_stock:((T=g.min_stock)==null?void 0:T.toString())||"0",max_stock:((A=g.max_stock)==null?void 0:A.toString())||"",location:g.location||""})},[g]);const f=l=>E(void 0,null,function*(){l&&l.preventDefault(),k(!0);try{yield Me(g.id,{name:a.name,sku:a.sku||null,description:a.description||null,category:a.category||null,imageUrl:null,image_url:null,stock:parseInt(a.stock)||0,unit:a.unit,price:a.price?parseFloat(a.price):null,unitPrice:a.price?parseFloat(a.price):null,cost:a.cost?parseFloat(a.cost):null,minStock:parseInt(a.min_stock)||0,maxStock:a.max_stock?parseInt(a.max_stock):null,location:a.location||null}),N.success("Ürün başarıyla güncellendi"),s(),o(!1)}catch(F){N.error(F.message||"Ürün güncellenirken hata oluştu")}finally{k(!1)}});return e.jsx(je,{open:i,onOpenChange:o,children:e.jsx(pe,{className:"!max-w-[100vw] sm:!max-w-[95vw] !w-[100vw] sm:!w-[95vw] !h-[100vh] sm:!h-[90vh] !max-h-[100vh] sm:!max-h-[90vh] !left-0 sm:!left-[2.5vw] !top-0 sm:!top-[5vh] !right-0 sm:!right-auto !bottom-0 sm:!bottom-auto !translate-x-0 !translate-y-0 overflow-hidden !p-0 gap-0 bg-white flex flex-col !m-0 !rounded-none sm:!rounded-lg !border-0 sm:!border",children:e.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[e.jsx(fe,{className:"p-3 sm:p-4 border-b bg-white flex-shrink-0 relative pr-12 sm:pr-16",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-8 w-8 sm:h-10 sm:w-10 rounded-lg bg-primary/10 flex items-center justify-center border border-primary/20 flex-shrink-0",children:e.jsx(J,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),e.jsx(Ne,{className:"text-lg sm:text-xl font-semibold text-foreground truncate",children:"Ürünü Düzenle"}),e.jsx(ve,{className:"sr-only",children:"Ürün bilgilerini düzenleyin"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 flex-shrink-0",children:[e.jsxs(L,{variant:"outline",size:"sm",className:"border-primary/20 hover:bg-primary/5 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0",onClick:()=>o(!1),disabled:w,children:[e.jsx(ce,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"İptal"]}),e.jsxs(L,{variant:"default",size:"sm",className:"bg-primary hover:bg-primary/90 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0 text-white",onClick:f,disabled:w,children:[w?e.jsx(ue,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0 animate-spin"}):e.jsx(ge,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Kaydet"]})]})]})}),e.jsx("div",{className:"flex-1 overflow-hidden bg-gray-50/50 p-3 sm:p-4 min-h-0",children:e.jsx("div",{className:"max-w-full mx-auto h-full overflow-y-auto",children:e.jsx("form",{onSubmit:l=>{l.preventDefault(),f(l)},className:"space-y-4 sm:space-y-6",children:e.jsxs(K,{children:[e.jsx(se,{children:e.jsx(ae,{className:"text-lg sm:text-xl",children:"Temel Bilgiler"})}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"name",className:"text-sm sm:text-base",children:"Ürün Adı"}),e.jsx(j,{id:"name",value:a.name,onChange:l=>d(u(h({},a),{name:l.target.value})),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"sku",className:"text-sm sm:text-base",children:"SKU"}),e.jsx(j,{id:"sku",value:a.sku,onChange:l=>d(u(h({},a),{sku:l.target.value})),className:"min-h-[44px] sm:min-h-0",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"description",className:"text-sm sm:text-base",children:"Açıklama"}),e.jsx(ke,{id:"description",value:a.description,onChange:l=>d(u(h({},a),{description:l.target.value})),rows:3,className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"category",className:"text-sm sm:text-base",children:"Kategori"}),e.jsxs(U,{value:a.category?a.category:"none",onValueChange:l=>d(u(h({},a),{category:l==="none"?"":l})),children:[e.jsx(V,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(H,{placeholder:"Kategori seçin"})}),e.jsxs(Y,{children:[e.jsx(p,{value:"none",children:"Kategori Yok"}),Ms.map(l=>e.jsx(p,{value:l,children:l},l))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"stock",className:"text-sm sm:text-base",children:"Stok"}),e.jsx(j,{id:"stock",type:"number",value:a.stock,onChange:l=>d(u(h({},a),{stock:l.target.value})),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"unit",className:"text-sm sm:text-base",children:"Birim"}),e.jsxs(U,{value:a.unit?a.unit:"",onValueChange:l=>d(u(h({},a),{unit:l})),children:[e.jsx(V,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(H,{})}),e.jsxs(Y,{children:[e.jsx(p,{value:"Adet",children:"Adet"}),e.jsx(p,{value:"Kg",children:"Kg"}),e.jsx(p,{value:"Lt",children:"Lt"}),e.jsx(p,{value:"Mt",children:"Mt"}),e.jsx(p,{value:"M2",children:"M²"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"price",className:"text-sm sm:text-base",children:"Satış Fiyatı"}),e.jsx(j,{id:"price",type:"number",step:"0.01",value:a.price,onChange:l=>d(u(h({},a),{price:l.target.value})),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"cost",className:"text-sm sm:text-base",children:"Maliyet"}),e.jsx(j,{id:"cost",type:"number",step:"0.01",value:a.cost,onChange:l=>d(u(h({},a),{cost:l.target.value})),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"min_stock",className:"text-sm sm:text-base",children:"Min. Stok"}),e.jsx(j,{id:"min_stock",type:"number",value:a.min_stock,onChange:l=>d(u(h({},a),{min_stock:l.target.value})),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"max_stock",className:"text-sm sm:text-base",children:"Max. Stok"}),e.jsx(j,{id:"max_stock",type:"number",value:a.max_stock,onChange:l=>d(u(h({},a),{max_stock:l.target.value})),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"location",className:"text-sm sm:text-base",children:"Konum"}),e.jsx(j,{id:"location",value:a.location,onChange:l=>d(u(h({},a),{location:l.target.value})),className:"min-h-[44px] sm:min-h-0"})]})]})]})]})})})})]})})})},Ps=["Taşınabilir Güç Paketleri","Kabin Tipi Güç Paketleri","Araç Tipi Güç Paketleri","Endüstriyel Güç Paketleri","Güneş Enerji Sistemleri"],Rs=({open:i,onOpenChange:o,product:s,onUpdate:g})=>{const[w,k]=m.useState(!1),[a,d]=m.useState(!1),[f,l]=m.useState("details"),[F,M]=m.useState([]),[T,A]=m.useState([]),[C,O]=m.useState(null),[S,q]=m.useState(""),[_,$]=m.useState(!1),[n,y]=m.useState({name:"",sku:"",description:"",category:"",stock:"0",unit:"Adet",price:"",cost:"",min_stock:"0",max_stock:"",location:""});m.useEffect(()=>{var t,c,b,P,W;s&&(y({name:s.name||"",sku:s.sku||"",description:s.description||"",category:s.category||"",stock:((t=s.stock)==null?void 0:t.toString())||"0",unit:s.unit||"Adet",price:((c=s.price)==null?void 0:c.toString())||"",cost:((b=s.cost)==null?void 0:b.toString())||"",min_stock:((P=s.min_stock)==null?void 0:P.toString())||"0",max_stock:((W=s.max_stock)==null?void 0:W.toString())||"",location:s.location||""}),k(!1))},[s,i]),m.useEffect(()=>{i&&(s!=null&&s.id)&&f==="recipe"&&(Q(),re())},[i,s,f]);const Q=()=>E(void 0,null,function*(){if(s!=null&&s.id)try{const t=yield js(s.id);M(t)}catch(t){N.error("Reçeteler yüklenemedi: "+t.message)}}),re=()=>E(void 0,null,function*(){try{const t=yield vs();A(t)}catch(t){N.error("Hammaddeler yüklenemedi: "+t.message)}}),X=()=>E(void 0,null,function*(){if(!C||!S||!(s!=null&&s.id)){N.error("Lütfen hammadde ve miktar seçin");return}const t=T.find(c=>c.id===C);if(!t){N.error("Seçilen hammadde bulunamadı veya silinmiş");return}if(t.deleted===!0||t.isDeleted===!0){N.error("Silinmiş hammaddeler reçeteye eklenemez");return}$(!0);try{yield ps(s.id,C,parseFloat(S)),N.success("Hammadde eklendi"),Q(),O(null),q("")}catch(c){N.error("Hata: "+c.message)}finally{$(!1)}}),z=t=>E(void 0,null,function*(){if(confirm("Bu hammaddeyi reçeteden çıkarmak istediğinizden emin misiniz?"))try{yield fs(t),N.success("Hammadde çıkarıldı"),Q()}catch(c){N.error("Hata: "+c.message)}}),oe=(t,c)=>E(void 0,null,function*(){if(!(!c||parseFloat(c)<=0))try{yield Ns(t,parseFloat(c)),N.success("Miktar güncellendi"),Q()}catch(b){N.error("Hata: "+b.message)}}),de=()=>F.reduce((t,c)=>{const b=c.rawMaterial;return t+((b==null?void 0:b.cost)||0)*c.quantityPerUnit},0),te=t=>E(void 0,null,function*(){if(t.preventDefault(),!!(s!=null&&s.id)){d(!0);try{yield Me(s.id,{name:n.name,sku:n.sku||null,description:n.description||null,category:n.category||null,imageUrl:null,image_url:null,stock:parseInt(n.stock)||0,unit:n.unit,price:n.price?parseFloat(n.price):null,unitPrice:n.price?parseFloat(n.price):null,cost:n.cost?parseFloat(n.cost):null,minStock:parseInt(n.min_stock)||0,maxStock:n.max_stock?parseInt(n.max_stock):null,location:n.location||null}),N.success("Ürün başarıyla güncellendi"),k(!1),g==null||g()}catch(c){console.error("Update product error:",c),N.error(c.message||"Ürün güncellenirken hata oluştu")}finally{d(!1)}}});if(!s)return null;const ne=(t,c)=>t===0?"destructive":t<=c?"secondary":"default",G=(t,c)=>t===0?"Tükendi":t<=c?"Düşük Stok":"Stokta";return e.jsx(je,{open:i,onOpenChange:o,children:e.jsx(pe,{className:"!max-w-[100vw] sm:!max-w-[95vw] !w-[100vw] sm:!w-[95vw] !h-[100vh] sm:!h-[90vh] !max-h-[100vh] sm:!max-h-[90vh] !left-0 sm:!left-[2.5vw] !top-0 sm:!top-[5vh] !right-0 sm:!right-auto !bottom-0 sm:!bottom-auto !translate-x-0 !translate-y-0 overflow-hidden !p-0 gap-0 bg-white flex flex-col !m-0 !rounded-none sm:!rounded-lg !border-0 sm:!border",children:e.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[e.jsx(fe,{className:"p-3 sm:p-4 border-b bg-white flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-8 w-8 sm:h-10 sm:w-10 rounded-lg bg-primary/10 flex items-center justify-center border border-primary/20 flex-shrink-0",children:e.jsx(J,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),e.jsx(Ne,{className:"text-lg sm:text-xl font-semibold text-foreground truncate",children:s.name}),e.jsx(ve,{className:"sr-only",children:"Ürün detayları ve bilgileri"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 flex-shrink-0 relative z-10 pr-10 sm:pr-12",children:[e.jsx(ie,{variant:ne(s.stock,s.min_stock),className:"text-xs px-2 sm:px-3 py-1 relative z-10",children:G(s.stock,s.min_stock)}),w?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>{var t,c,b,P,W;k(!1),s&&y({name:s.name||"",sku:s.sku||"",description:s.description||"",category:s.category||"",stock:((t=s.stock)==null?void 0:t.toString())||"0",unit:s.unit||"Adet",price:((c=s.price)==null?void 0:c.toString())||"",cost:((b=s.cost)==null?void 0:b.toString())||"",min_stock:((P=s.min_stock)==null?void 0:P.toString())||"0",max_stock:((W=s.max_stock)==null?void 0:W.toString())||"",location:s.location||""})},disabled:a,className:"min-h-[44px] sm:min-h-0",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"İptal"]}),e.jsx(L,{size:"sm",onClick:te,disabled:a,className:"min-h-[44px] sm:min-h-0",children:a?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"h-4 w-4 mr-2 animate-spin"}),"Kaydediliyor..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Kaydet"]})})]}):e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>k(!0),className:"min-h-[44px] sm:min-h-0",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Düzenle"]})]})]})}),e.jsx("div",{className:"flex-1 overflow-hidden bg-gray-50/50 p-3 sm:p-4 min-h-0",children:e.jsx("div",{className:"max-w-full mx-auto h-full overflow-y-auto",children:w?e.jsx("form",{onSubmit:te,className:"space-y-4 sm:space-y-6",children:e.jsxs(K,{children:[e.jsx(se,{children:e.jsx(ae,{className:"text-lg sm:text-xl",children:"Temel Bilgiler"})}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"name",className:"text-sm sm:text-base",children:"Ürün Adı"}),e.jsx(j,{id:"name",value:n.name,onChange:t=>y(u(h({},n),{name:t.target.value})),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"sku",className:"text-sm sm:text-base",children:"SKU"}),e.jsx(j,{id:"sku",value:n.sku,onChange:t=>y(u(h({},n),{sku:t.target.value})),className:"min-h-[44px] sm:min-h-0",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"description",className:"text-sm sm:text-base",children:"Açıklama"}),e.jsx(ke,{id:"description",value:n.description,onChange:t=>y(u(h({},n),{description:t.target.value})),rows:3,className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"category",className:"text-sm sm:text-base",children:"Kategori"}),e.jsxs(U,{value:n.category?n.category:"none",onValueChange:t=>y(u(h({},n),{category:t==="none"?"":t})),children:[e.jsx(V,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(H,{placeholder:"Kategori seçin"})}),e.jsxs(Y,{children:[e.jsx(p,{value:"none",children:"Kategori Yok"}),Ps.map(t=>e.jsx(p,{value:t,children:t},t))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"stock",className:"text-sm sm:text-base",children:"Stok"}),e.jsx(j,{id:"stock",type:"number",value:n.stock,onChange:t=>y(u(h({},n),{stock:t.target.value})),className:"min-h-[44px] sm:min-h-0",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"unit",className:"text-sm sm:text-base",children:"Birim"}),e.jsxs(U,{value:n.unit?n.unit:"",onValueChange:t=>y(u(h({},n),{unit:t})),children:[e.jsx(V,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(H,{})}),e.jsxs(Y,{children:[e.jsx(p,{value:"Adet",children:"Adet"}),e.jsx(p,{value:"Kg",children:"Kg"}),e.jsx(p,{value:"Lt",children:"Lt"}),e.jsx(p,{value:"Mt",children:"Mt"}),e.jsx(p,{value:"M2",children:"M²"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"price",className:"text-sm sm:text-base",children:"Satış Fiyatı"}),e.jsx(j,{id:"price",type:"number",step:"0.01",value:n.price,onChange:t=>y(u(h({},n),{price:t.target.value})),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"cost",className:"text-sm sm:text-base",children:"Maliyet"}),e.jsx(j,{id:"cost",type:"number",step:"0.01",value:n.cost,onChange:t=>y(u(h({},n),{cost:t.target.value})),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"min_stock",className:"text-sm sm:text-base",children:"Min. Stok"}),e.jsx(j,{id:"min_stock",type:"number",value:n.min_stock,onChange:t=>y(u(h({},n),{min_stock:t.target.value})),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"max_stock",className:"text-sm sm:text-base",children:"Max. Stok"}),e.jsx(j,{id:"max_stock",type:"number",value:n.max_stock,onChange:t=>y(u(h({},n),{max_stock:t.target.value})),className:"min-h-[44px] sm:min-h-0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"location",className:"text-sm sm:text-base",children:"Konum"}),e.jsx(j,{id:"location",value:n.location,onChange:t=>y(u(h({},n),{location:t.target.value})),className:"min-h-[44px] sm:min-h-0"})]})]})]})]})}):e.jsxs(Ue,{value:f,onValueChange:l,className:"w-full",children:[e.jsxs(Ve,{className:"grid w-full grid-cols-2 mb-4 sm:mb-6",children:[e.jsx(we,{value:"details",className:"min-h-[44px] sm:min-h-0",children:"Detaylar"}),e.jsx(we,{value:"recipe",className:"min-h-[44px] sm:min-h-0",children:"Reçete"})]}),e.jsx(Se,{value:"details",className:"space-y-4 sm:space-y-6 mt-0",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[s.image_url&&e.jsx(K,{children:e.jsx(I,{className:"pt-6",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative w-full max-w-md h-64 rounded-lg overflow-hidden border border-border bg-muted",children:[e.jsx("img",{src:(()=>{if(!s.image_url)return"";if(s.image_url.startsWith("http://")||s.image_url.startsWith("https://"))return s.image_url;const t="http://localhost:3000",c=s.image_url.startsWith("/")?s.image_url:`/${s.image_url}`;return`${t}${c}`})(),alt:s.name,className:"w-full h-full object-cover",loading:"lazy",decoding:"async",onError:t=>{t.currentTarget.style.display="none";const c=t.currentTarget.nextElementSibling;c&&c.classList.remove("hidden")}}),e.jsx("div",{className:"hidden w-full h-full items-center justify-center bg-muted",children:e.jsx(Ye,{className:"h-16 w-16 text-muted-foreground"})})]})})})}),e.jsxs(K,{children:[e.jsx(se,{children:e.jsx(ae,{className:"text-lg sm:text-xl",children:"Temel Bilgiler"})}),e.jsx(I,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"SKU"}),e.jsx("p",{className:"font-medium font-mono text-sm sm:text-base",children:s.sku||"-"})]}),s.category&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Kategori"}),e.jsx(ie,{variant:"outline",className:"font-normal",children:s.category})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Mevcut Stok"}),e.jsxs("p",{className:"font-medium text-base sm:text-lg",children:[s.stock||0," ",s.unit||"Adet"]})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Durum"}),e.jsx(ie,{variant:ne(s.stock||0,s.min_stock||0),children:G(s.stock||0,s.min_stock||0)})]}),s.price&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Satış Fiyatı"}),e.jsxs("p",{className:"font-semibold text-base sm:text-lg",children:["₺",new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(s.price||0)]})]}),s.cost&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Maliyet"}),e.jsxs("p",{className:"font-medium text-sm sm:text-base",children:["₺",new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(s.cost||0)]})]}),e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Minimum Stok"}),e.jsxs("p",{className:"font-medium text-sm sm:text-base",children:[s.min_stock||0," ",s.unit||"Adet"]})]}),s.max_stock&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Maksimum Stok"}),e.jsxs("p",{className:"font-medium text-sm sm:text-base",children:[s.max_stock," ",s.unit||"Adet"]})]}),s.location&&e.jsxs("div",{className:"rounded-lg border bg-muted/30 px-3 py-2",children:[e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Konum"}),e.jsx("p",{className:"font-medium text-sm sm:text-base",children:s.location})]})]})})]}),s.description&&e.jsxs(K,{children:[e.jsx(se,{children:e.jsx(ae,{className:"text-lg sm:text-xl",children:"Açıklama"})}),e.jsx(I,{children:e.jsx("p",{className:"text-sm sm:text-base whitespace-pre-wrap",children:s.description})})]})]})}),e.jsx(Se,{value:"recipe",className:"space-y-4 sm:space-y-6 mt-0",children:e.jsxs(K,{children:[e.jsx(se,{children:e.jsx(ae,{className:"text-lg sm:text-xl",children:"Reçete Yönetimi"})}),e.jsxs(I,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3 text-sm sm:text-base",children:"Hammadde Listesi"}),F.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8 text-sm sm:text-base",children:"Henüz hammadde eklenmemiş"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0",children:e.jsx("div",{className:"inline-block min-w-full align-middle px-4 sm:px-0",children:e.jsxs(ks,{className:"w-full",children:[e.jsx(ys,{children:e.jsxs(Fe,{children:[e.jsx(Z,{children:"Hammadde"}),e.jsx(Z,{children:"Miktar (Birim üretim için)"}),e.jsx(Z,{children:"Mevcut Stok"}),e.jsx(Z,{children:"Birim Maliyet"}),e.jsx(Z,{children:"Toplam Maliyet"}),e.jsx(Z,{className:"w-[80px]",children:"İşlem"})]})}),e.jsx(bs,{children:F.filter(t=>t.rawMaterial).map(t=>{const c=t.rawMaterial;return c?e.jsxs(Fe,{children:[e.jsx(ee,{className:"font-medium",children:c.name}),e.jsx(ee,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{type:"number",step:"0.01",value:t.quantityPerUnit,onChange:b=>oe(t.id,b.target.value),className:"w-24 min-h-[44px] sm:min-h-0"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:c.unit})]})}),e.jsxs(ee,{children:[c.stock," ",c.unit]}),e.jsxs(ee,{children:["₺",new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(c.cost||0)]}),e.jsxs(ee,{children:["₺",new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format((c.cost||0)*t.quantityPerUnit)]}),e.jsx(ee,{children:e.jsx(L,{variant:"ghost",size:"sm",onClick:()=>z(t.id),className:"min-h-[44px] sm:min-h-0",children:e.jsx(Te,{className:"h-4 w-4 text-destructive"})})})]},t.id):null})})]})})}),e.jsx("div",{className:"flex justify-end mt-3 pt-3 border-t",children:e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Toplam Hammadde Maliyeti (Birim)"}),e.jsxs("p",{className:"text-xl sm:text-2xl font-bold",children:["₺",new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(de()||0)]})]})})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium mb-3 text-sm sm:text-base",children:"Yeni Hammadde Ekle"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(x,{className:"text-sm sm:text-base",children:"Hammadde"}),e.jsxs(U,{value:C!=null?C:void 0,onValueChange:O,children:[e.jsx(V,{className:"min-h-[44px] sm:min-h-0",children:e.jsx(H,{placeholder:"Hammadde seçin..."})}),e.jsx(Y,{className:"max-h-[400px]",children:T.map(t=>e.jsxs(p,{value:t.id,children:[t.name," (",t.currentStock," ",t.unit," - ₺",new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(t.unitPrice||0),"/",t.unit,")"]},t.id))})]})]}),e.jsxs("div",{className:"w-full sm:w-32",children:[e.jsx(x,{className:"text-sm sm:text-base",children:"Miktar"}),e.jsx(j,{type:"number",step:"1",min:"0",placeholder:"Miktar",value:S,onChange:t=>q(t.target.value),className:"min-h-[44px] sm:min-h-0"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(L,{onClick:X,disabled:_,className:"w-full sm:w-auto min-h-[44px] sm:min-h-0",children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),"Ekle"]})})]})]})]})]})})]})})})]})})})},Pe=m.memo(({product:i,usersMap:o={},currency:s=Ae,onSelect:g,onEdit:w,onDelete:k})=>{var C,O;const a=Number(i.stock)||0,d=Number((O=(C=i.min_stock)!=null?C:i.minStock)!=null?O:0),f=a>0&&a<=d,l=a===0,[F,M]=m.useState(i.price||0),[T,A]=m.useState(!1);return m.useEffect(()=>{E(void 0,null,function*(){const q=i.price||0;if(s==="TRY"){M(q);return}A(!0);try{const _=yield Fs(q,s);M(_)}catch(_){console.error("Currency conversion error:",_),M(q)}finally{A(!1)}})},[i.price,s]),e.jsx(K,{className:"group hover:shadow-xl transition-all duration-300 cursor-pointer border border-border/60 hover:border-primary/50 flex flex-col h-full overflow-hidden bg-white hover:-translate-y-1 max-w-full",onClick:()=>g(i),children:e.jsxs(I,{className:"p-5 sm:p-6 flex flex-col flex-1 gap-4 sm:gap-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-bold text-base sm:text-lg truncate text-foreground flex-1",title:i.name,children:i.name}),l&&e.jsx(ie,{variant:"destructive",className:"flex-shrink-0 whitespace-nowrap text-xs px-2 py-0.5",children:"Tükendi"}),f&&!l&&e.jsx(ie,{variant:"secondary",className:"flex-shrink-0 whitespace-nowrap text-xs px-2 py-0.5",children:"Düşük"})]}),i.category&&e.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[e.jsx(qe,{className:"h-3.5 w-3.5 text-muted-foreground flex-shrink-0"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground truncate",title:i.category,children:i.category})]}),i.sku&&e.jsxs("p",{className:"text-xs text-muted-foreground font-mono mt-1 truncate",title:i.sku,children:["SKU: ",i.sku]})]}),e.jsxs(as,{children:[e.jsx(ts,{asChild:!0,children:e.jsx(L,{variant:"ghost",size:"icon",className:"h-8 w-8 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0 hover:bg-muted/80 rounded-lg",onClick:S=>S.stopPropagation(),children:e.jsx($e,{className:"h-4 w-4"})})}),e.jsxs(ls,{align:"end",children:[e.jsxs(xe,{onClick:S=>{S.stopPropagation(),g(i)},children:[e.jsx(he,{className:"mr-2 h-4 w-4"})," Detayları Görüntüle"]}),e.jsxs(xe,{onClick:S=>{S.stopPropagation(),w(i)},children:[e.jsx(he,{className:"mr-2 h-4 w-4"})," Düzenle"]}),e.jsxs(xe,{className:"text-destructive focus:text-destructive",onClick:S=>{S.stopPropagation(),k(i)},children:[e.jsx(Te,{className:"mr-2 h-4 w-4"})," Sil"]})]})]})]}),e.jsxs("div",{className:"space-y-2.5 flex-1 min-h-[60px]",children:[i.sku&&e.jsxs("div",{className:"flex items-center gap-2.5 text-xs sm:text-sm bg-gradient-to-r from-muted/40 to-muted/30 rounded-lg px-3.5 py-2.5 border border-muted/60 shadow-sm hover:shadow transition-shadow",children:[e.jsx(J,{className:"h-4 w-4 sm:h-4.5 sm:w-4.5 text-primary flex-shrink-0"}),e.jsx("span",{className:"truncate text-foreground font-medium font-mono",title:i.sku,children:i.sku})]}),i.description&&e.jsxs("div",{className:"flex items-start gap-2.5 text-xs sm:text-sm bg-gradient-to-r from-muted/40 to-muted/30 rounded-lg px-3.5 py-2.5 border border-muted/60 shadow-sm hover:shadow transition-shadow",children:[e.jsx(J,{className:"h-4 w-4 sm:h-4.5 sm:w-4.5 text-primary flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"line-clamp-2 text-foreground",children:i.description})]}),!i.sku&&!i.description&&e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground italic py-3 text-center bg-muted/20 rounded-lg border border-dashed border-muted",children:"Ürün bilgisi yok"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-border/60",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx(J,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Stok"})]}),e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-foreground",children:a}),e.jsx("div",{className:"h-4 mt-0.5",children:d>0&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Min: ",d]})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx(We,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium text-muted-foreground",children:"Fiyat"})]}),e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-foreground",children:T?"...":`${Cs[s]}${new Intl.NumberFormat(s==="TRY"?"tr-TR":"en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(F)}`}),e.jsx("div",{className:"h-4 mt-0.5"})]})]}),(i.location||i.createdBy)&&e.jsxs("div",{className:"pt-3 border-t border-border/60 space-y-1.5",children:[i.location&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Je,{className:"h-3.5 w-3.5 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:i.location})]}),i.createdBy&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Qe,{className:"h-3.5 w-3.5 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:o[i.createdBy]||"Bilinmeyen Kullanıcı"})]})]})]})})},(i,o)=>{var s,g;return i.product.id===o.product.id&&i.product.name===o.product.name&&i.product.stock===o.product.stock&&i.product.price===o.product.price&&i.product.category===o.product.category&&i.product.sku===o.product.sku&&i.product.createdBy===o.product.createdBy&&((s=i.usersMap)==null?void 0:s[i.product.createdBy])===((g=o.usersMap)==null?void 0:g[o.product.createdBy])&&i.currency===o.currency});Pe.displayName="ProductCard";const Es=["Taşınabilir Güç Paketleri","Kabin Tipi Güç Paketleri","Araç Tipi Güç Paketleri","Endüstriyel Güç Paketleri","Güneş Enerji Sistemleri"],Js=()=>{const[i,o]=m.useState([]),[s,g]=m.useState(!0),[w,k]=m.useState(!1),[a,d]=m.useState(!1),[f,l]=m.useState(!1),[F,M]=m.useState(!1),[T,A]=m.useState(null),[C,O]=m.useState(""),[S,q]=m.useState(""),[_,$]=m.useState("all"),[n,y]=m.useState("all"),[Q,re]=m.useState(!1),[X,z]=m.useState(null),[oe,de]=m.useState({}),[te,ne]=m.useState(()=>localStorage.getItem("productCurrency")||Ae);m.useEffect(()=>{G()},[]),m.useEffect(()=>{const r=setTimeout(()=>{q(C)},300);return()=>clearTimeout(r)},[C]);const G=m.useCallback(()=>E(void 0,null,function*(){try{g(!0);const[r,v]=yield Promise.all([is(),He()]);o(r);const D={};v.forEach(R=>{D[R.id]=R.fullName||R.displayName||R.email||"Bilinmeyen"}),de(D)}catch(r){N.error(r.message||"Ürünler yüklenirken hata oluştu")}finally{g(!1)}}),[]),t=m.useCallback(()=>E(void 0,null,function*(){if(T)try{yield rs(T.id),N.success("Ürün silindi"),G(),M(!1),A(null)}catch(r){N.error(r.message||"Ürün silinirken hata oluştu")}}),[T,G]),c=m.useCallback(r=>{var R,B;const v=Number(r.stock)||0,D=Number((B=(R=r.min_stock)!=null?R:r.minStock)!=null?B:0);return v>0&&v<=D},[]),b=m.useCallback(r=>(Number(r.stock)||0)===0,[]),P=m.useMemo(()=>{const r=i.length,v=i.filter(B=>c(B)).length,D=i.filter(B=>b(B)).length,R=i.reduce((B,le)=>{const me=le.price||0,Le=le.stock||0;return B+me*Le},0);return{total:r,lowStock:v,outOfStock:D,totalValue:R}},[i,c,b]),W=m.useMemo(()=>Array.isArray(i)?i.filter(r=>{var B,le,me;const v=((B=r.name)==null?void 0:B.toLocaleLowerCase("tr-TR").includes(S.toLocaleLowerCase("tr-TR")))||((le=r.sku)==null?void 0:le.toLocaleLowerCase("tr-TR").includes(S.toLocaleLowerCase("tr-TR")))||((me=r.category)==null?void 0:me.toLocaleLowerCase("tr-TR").includes(S.toLocaleLowerCase("tr-TR"))),D=_==="all"||r.category===_,R=n==="all"||n==="low"&&c(r)||n==="out"&&b(r);return v&&D&&R}):[],[i,S,_,n,c,b]),Re=m.useMemo(()=>{var r,v,D;try{return`₺${new Intl.NumberFormat("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(P.totalValue||0)}`}catch(R){return`₺${(D=(v=(r=P.totalValue)==null?void 0:r.toFixed)==null?void 0:v.call(r,0))!=null?D:"0"}`}},[P.totalValue]),Ee=[{key:"total-products",label:"Toplam Ürün",value:P.total,icon:J,accent:"bg-primary/10 text-primary",description:"Tüm ürün kayıtları",onClick:()=>{y("all"),$("all"),O(""),z("total-products")},isActive:X==="total-products"},{key:"low-stock",label:"Düşük Stok",value:P.lowStock,icon:Xe,accent:"bg-amber-100 text-amber-700",description:"Kritik stok seviyeleri",onClick:()=>{y("low"),$("all"),z("low-stock")},isActive:X==="low-stock"},{key:"out-of-stock",label:"Tükenen Ürünler",value:P.outOfStock,icon:Ze,accent:"bg-red-100 text-red-700",description:"Stoğu tamamen bitenler",onClick:()=>{y("out"),$("all"),z("out-of-stock")},isActive:X==="out-of-stock"},{key:"total-value",label:"Toplam Değer",value:Re,icon:es,accent:"bg-emerald-100 text-emerald-700",description:"Detaylı raporlar",onClick:()=>{z("total-value"),re(!0)},isActive:X==="total-value"}];return s?e.jsx(De,{children:e.jsx(Ss,{message:"Ürünler yükleniyor..."})}):e.jsxs(De,{children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3 md:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-foreground",children:"Ürünler"}),e.jsx("p",{className:"text-muted-foreground mt-0.5 sm:mt-1 text-xs sm:text-sm",children:"Stok ve ürün yönetimi"})]}),e.jsxs(L,{className:"gap-1.5 sm:gap-2 w-full sm:w-auto min-h-[44px] sm:min-h-10 text-xs sm:text-sm",onClick:()=>k(!0),children:[e.jsx(_e,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Yeni Ürün"}),e.jsx("span",{className:"sm:hidden",children:"Yeni"})]})]}),e.jsx(K,{children:e.jsx(I,{className:"p-4 sm:p-5 md:pt-6",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:Ee.map(r=>{const v=r.icon;return e.jsx(K,{className:Ce("border border-border/60 shadow-none cursor-pointer transition-all hover:shadow-md focus-within:ring-2 focus-within:ring-primary/40",r.isActive&&"border-primary shadow-lg ring-2 ring-primary/20"),role:"button",tabIndex:0,onClick:r.onClick,onKeyDown:D=>{(D.key==="Enter"||D.key===" ")&&(D.preventDefault(),r.onClick())},"aria-label":`${r.label} kartı`,children:e.jsxs(I,{className:"p-3 sm:p-4 flex items-center gap-2 sm:gap-3 md:gap-4",children:[e.jsx("div",{className:Ce("h-10 w-10 sm:h-12 sm:w-12 rounded-xl sm:rounded-2xl flex items-center justify-center flex-shrink-0",r.accent),children:e.jsx(v,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[10px] sm:text-xs uppercase tracking-wide text-muted-foreground",children:r.label}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-foreground mt-0.5 sm:mt-1",children:r.value}),e.jsx("p",{className:"text-[10px] sm:text-[11px] text-muted-foreground mt-0.5 hidden sm:block",children:r.description})]})]})},r.key)})})})}),e.jsx(K,{children:e.jsx(I,{className:"p-3 sm:p-4 md:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3 md:gap-4",children:[e.jsx("div",{className:"flex-1 min-w-0 w-full sm:w-auto sm:min-w-[200px] md:min-w-[250px]",children:e.jsx(ns,{placeholder:"Ürün, SKU veya kategori ara...",className:"w-full h-9 sm:h-10 text-xs sm:text-sm",value:C,onChange:r=>{O(r.target.value),r.target.value===""&&z(null)}})}),e.jsx("div",{className:"w-full sm:w-auto sm:min-w-[160px] md:min-w-[180px]",children:e.jsxs(U,{value:_,onValueChange:r=>{$(r),z(null)},children:[e.jsx(V,{className:"w-full h-9 sm:h-10 text-xs sm:text-sm",children:e.jsx(H,{placeholder:"Kategori"})}),e.jsxs(Y,{children:[e.jsx(p,{value:"all",children:"Tüm Kategoriler"}),Es.map(r=>e.jsx(p,{value:r,children:r},r))]})]})}),e.jsx("div",{className:"w-full sm:w-auto sm:min-w-[140px] md:min-w-[150px]",children:e.jsxs(U,{value:te,onValueChange:r=>{ne(r),localStorage.setItem("productCurrency",r)},children:[e.jsx(V,{className:"w-full h-9 sm:h-10 text-xs sm:text-sm",children:e.jsx(H,{placeholder:"Para Birimi"})}),e.jsx(Y,{children:Ds.map(r=>e.jsx(p,{value:r.value,children:r.label},r.value))})]})}),(C||_!=="all"||n!=="all")&&e.jsxs(L,{variant:"outline",size:"sm",onClick:()=>{O(""),$("all"),y("all"),z(null)},className:"h-9 sm:h-10 text-xs sm:text-sm",children:[e.jsx(ce,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Temizle"})]})]})})}),W.length===0?e.jsx(K,{children:e.jsx(I,{className:"p-8 sm:p-10 md:p-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-12 h-12 sm:w-14 sm:h-14 md:w-16 md:h-16 bg-muted/50 rounded-full flex items-center justify-center mb-3 sm:mb-4",children:e.jsx(J,{className:"h-6 w-6 sm:h-7 sm:w-7 md:h-8 md:w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-1.5 sm:mb-2",children:C||_!=="all"?"Arama sonucu bulunamadı":"Henüz ürün bulunmuyor"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground max-w-md mx-auto",children:C||_!=="all"?"Filtreleri değiştirerek tekrar deneyin":"Yeni ürün eklemek için yukarıdaki butona tıklayın"})]})})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 sm:gap-4 md:gap-5 lg:gap-6",children:W.map(r=>e.jsx(Pe,{product:r,usersMap:oe,currency:te,onSelect:v=>{A(v),l(!0)},onEdit:v=>{A(v),d(!0)},onDelete:v=>{A(v),M(!0)}},r.id))})]}),e.jsx(_s,{open:w,onOpenChange:k,onSuccess:G}),T&&e.jsxs(e.Fragment,{children:[e.jsx(As,{open:a,onOpenChange:d,onSuccess:G,product:T}),e.jsx(Rs,{open:f,onOpenChange:l,product:T,onUpdate:G})]}),e.jsx(ms,{open:F,onOpenChange:M,children:e.jsxs(cs,{children:[e.jsxs(os,{children:[e.jsx(ds,{children:"Ürünü sil?"}),e.jsx(xs,{children:"Bu işlem geri alınamaz. Ürün kalıcı olarak silinecek."})]}),e.jsxs(hs,{children:[e.jsx(us,{children:"İptal"}),e.jsx(gs,{onClick:t,children:"Sil"})]})]})}),e.jsx(ws,{open:Q,onOpenChange:re,title:"Ürün Değer Raporu",type:"products",data:i})]})};export{Js as default};

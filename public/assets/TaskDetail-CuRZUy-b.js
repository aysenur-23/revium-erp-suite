var G=Object.defineProperty,L=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var N=(m,a,t)=>a in m?G(m,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[a]=t,b=(m,a)=>{for(var t in a||(a={}))F.call(a,t)&&N(m,t,a[t]);if(g)for(var t of g(a))K.call(a,t)&&N(m,t,a[t]);return m},v=(m,a)=>L(m,z(a));var y=(m,a,t)=>new Promise((u,d)=>{var j=r=>{try{i(t.next(r))}catch(n){d(n)}},f=r=>{try{i(t.throw(r))}catch(n){d(n)}},i=r=>r.done?u(r.value):Promise.resolve(r.value).then(j,f);i((t=t.apply(m,a)).next())});import{g as q,h as R,r as J,a as w,T as p,j as e,B as Q,C as k,p as S,q as A,b as D}from"./index-BQmY0BmM.js";import{r as h,b as U,k as _,l as V,j as W,h as X,i as Y}from"./lucide-react-CAeuRJQk.js";import{M as T,B as x}from"./MainLayout-Dv9j77B5.js";import{A as Z,a as $}from"./avatar-CROuoa6p.js";import{S as P}from"./separator-C1rUq6WW.js";import{h as ee,c as se}from"./taskService-CI62TrOj.js";import{f as C}from"./format-CN3feEER.js";const ne=()=>{const{id:m}=q(),a=R(),[t,u]=h.useState(null),[d,j]=h.useState([]),[f,i]=h.useState(!0);h.useEffect(()=>{m&&r()},[m]);const r=()=>y(void 0,null,function*(){if(m)try{const[s,o,B]=yield Promise.all([ee(m),se(m),J()]);if(!s){w.error("Görev bulunamadı"),a("/tasks");return}const O=v(b({},s),{due_date:s.dueDate?s.dueDate instanceof p?s.dueDate.toDate().toISOString():new Date(s.dueDate).toISOString():null,created_at:s.createdAt instanceof p?s.createdAt.toDate().toISOString():new Date(s.createdAt).toISOString()});u(O);const H=o.map(l=>{const c=B.find(E=>E.id===l.assignedTo);return{id:l.assignedTo,full_name:(c==null?void 0:c.fullName)||(c==null?void 0:c.displayName)||"",email:(c==null?void 0:c.email)||"",accepted_at:l.acceptedAt?l.acceptedAt instanceof p?l.acceptedAt.toDate().toISOString():new Date(l.acceptedAt).toISOString():null,completed_at:l.completedAt?l.completedAt instanceof p?l.completedAt.toDate().toISOString():new Date(l.completedAt).toISOString():null}});j(H)}catch(s){console.error("Fetch task details error:",s),w.error("Görev detayları yüklenirken hata: "+(s.message||"Bilinmeyen hata")),a("/tasks")}finally{i(!1)}}),n=s=>{switch(s){case"completed":return e.jsx(Y,{className:"h-6 w-6 text-success"});case"in_progress":return e.jsx(X,{className:"h-6 w-6 text-warning"});default:return e.jsx(W,{className:"h-6 w-6 text-muted-foreground"})}},I=s=>({pending:"Beklemede",in_progress:"Devam Ediyor",completed:"Tamamlandı",cancelled:"İptal"})[s]||s,M=s=>s.split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2);return f?e.jsx(T,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})}):t?e.jsx(T,{children:e.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 md:gap-4",children:[e.jsx(Q,{variant:"ghost",size:"icon",className:"h-9 w-9 sm:h-10 sm:w-10",onClick:()=>a("/tasks"),children:e.jsx(U,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-foreground",children:"Görev Detayı"})})]}),e.jsxs("div",{className:"grid gap-3 sm:gap-4 md:gap-6 grid-cols-1 md:grid-cols-3",children:[e.jsx("div",{className:"md:col-span-2 space-y-3 sm:space-y-4 md:space-y-6",children:e.jsxs(k,{children:[e.jsx(S,{className:"p-3 sm:p-4 md:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0",children:n(t.status)}),e.jsx(A,{className:"text-lg sm:text-xl md:text-2xl truncate",children:t.title})]}),e.jsxs(x,{variant:t.priority>=3?"destructive":"secondary",className:"text-xs sm:text-sm flex-shrink-0",children:["Öncelik ",t.priority]})]})}),e.jsxs(D,{className:"p-3 sm:p-4 md:p-6 space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-1.5 sm:mb-2 text-sm sm:text-base",children:"Durum"}),e.jsx(x,{variant:"outline",className:"text-xs sm:text-sm",children:I(t.status)})]}),t.description&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-1.5 sm:mb-2 text-sm sm:text-base",children:"Açıklama"}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-muted-foreground",children:t.description})]}),e.jsx(P,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-1.5 sm:mb-2 text-sm sm:text-base flex items-center gap-1.5 sm:gap-2",children:[e.jsx(_,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),"Oluşturulma Tarihi"]}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-muted-foreground",children:C(new Date(t.created_at),"dd MMMM yyyy HH:mm")})]}),t.due_date&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-1.5 sm:mb-2 text-sm sm:text-base flex items-center gap-1.5 sm:gap-2",children:[e.jsx(_,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),"Bitiş Tarihi"]}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-muted-foreground",children:C(new Date(t.due_date),"dd MMMM yyyy HH:mm")})]})]})]})]})}),e.jsx("div",{children:e.jsxs(k,{children:[e.jsx(S,{className:"p-3 sm:p-4 md:p-6",children:e.jsxs(A,{className:"flex items-center gap-1.5 sm:gap-2 text-base sm:text-lg md:text-xl",children:[e.jsx(V,{className:"h-4 w-4 sm:h-5 sm:w-5"}),"Görevdeki Kişiler (",d.length,")"]})}),e.jsx(D,{className:"p-3 sm:p-4 md:p-6",children:e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[d.map(s=>e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 rounded-lg border border-border",children:[e.jsx(Z,{className:"h-8 w-8 sm:h-10 sm:w-10",children:e.jsx($,{className:"text-xs sm:text-sm",children:M(s.full_name)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium truncate text-xs sm:text-sm md:text-base",children:s.full_name}),e.jsx("div",{className:"text-[10px] sm:text-xs md:text-sm text-muted-foreground truncate",children:s.email}),e.jsxs("div",{className:"mt-1",children:[s.completed_at&&e.jsx(x,{variant:"default",className:"bg-success text-[10px] sm:text-xs",children:"Tamamlandı"}),s.accepted_at&&!s.completed_at&&e.jsx(x,{variant:"secondary",className:"text-[10px] sm:text-xs",children:"Kabul Edildi"}),!s.accepted_at&&e.jsx(x,{variant:"outline",className:"text-[10px] sm:text-xs",children:"Bekliyor"})]})]})]},s.id)),d.length===0&&e.jsx("p",{className:"text-center py-4 text-[10px] sm:text-xs md:text-sm text-muted-foreground",children:"Henüz kimse atanmadı"})]})})]})})]})]})}):null};export{ne as default};

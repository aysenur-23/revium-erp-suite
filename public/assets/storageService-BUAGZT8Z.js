var d=(e,r,a)=>new Promise((o,t)=>{var n=i=>{try{l(a.next(i))}catch(m){t(m)}},s=i=>{try{l(a.throw(i))}catch(m){t(m)}},l=i=>i.done?o(i.value):Promise.resolve(i.value).then(n,s);l((a=a.apply(e,r)).next())});import{Y as w,Z as u,$ as p}from"./index-BQmY0BmM.js";import{u as c,d as h}from"./driveService-ChwQKMyd.js";import"./lucide-react-CAeuRJQk.js";const f=e=>({provider:"google_drive",fileId:e.fileId,webViewLink:e.webViewLink,webContentLink:e.webContentLink,url:e.webViewLink||e.webContentLink||""}),D=(e,r,a)=>d(void 0,null,function*(){if(e.size>10*1024*1024)throw new Error("Dosya boyutu 10MB'dan küçük olmalıdır");const o=Date.now(),t=`tasks/${r}/attachments/${o}_${e.name}`,n=yield c(e,{type:"task",fileName:e.name,metadata:{taskId:r,path:t}});return f(n)}),v=(e,r,a,o)=>d(void 0,null,function*(){const t=Date.now(),n=`reports/${r}/${t}.pdf`,s=e instanceof File?e:new File([e],`${t}.pdf`,{type:"application/pdf"}),l=yield c(s,{type:"report",fileName:s.name,metadata:{reportType:r,reportId:null,path:n}});return f(l)}),I=(e,r)=>d(void 0,null,function*(){var a;try{if((r==null?void 0:r.provider)==="google_drive"||r!=null&&r.fileId){if(!(r!=null&&r.fileId))throw new Error("Drive dosyasını silmek için fileId gerekli");yield h(r.fileId);return}if(!w)throw new Error("Firebase Storage başlatılmamış");const o=new URL(e),t=decodeURIComponent(((a=o.pathname.split("/o/")[1])==null?void 0:a.split("?")[0])||"");if(!t)throw new Error("Geçersiz dosya URL'i");const n=u(w,t);yield p(n)}catch(o){throw console.error("Delete file error:",o),new Error(o.message||"Dosya silinirken hata oluştu")}});export{I as deleteFile,v as uploadReportPDF,D as uploadTaskAttachment};

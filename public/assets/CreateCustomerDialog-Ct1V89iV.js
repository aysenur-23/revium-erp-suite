import{k as _,r as n,j as e,U as E,B as w,X as S,L as z,C as T,e as L,w as m,R as i,b as f,a4 as M}from"./index-Xd90qdO9.js";import{D as B,a as R,b as q,c as A,T as C,n as G}from"./MainLayout-DW7UjMSA.js";import{S as I}from"./save-Bgz0wbo5.js";const K=({open:c,onOpenChange:d,onSuccess:k})=>{const{user:v}=_(),[x,h]=n.useState(!1),[a,j]=n.useState({name:"",email:"",phone:"",company:"",address:"",tax_number:"",notes:""}),[t,u]=n.useState({}),[F,N]=n.useState({}),b=()=>{j({name:"",email:"",phone:"",company:"",address:"",tax_number:"",notes:""}),u({}),N({})};n.useEffect(()=>{c&&b()},[c]);const l=(s,o)=>{j(r=>({...r,[s]:o})),F[s]&&t[s]&&u(r=>{const{[s]:p,...g}=r;return g})},D=()=>{const s={};return a.name.trim()||(s.name="İsim alanı zorunludur."),a.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)&&(s.email="Geçerli bir email adresi girin."),a.phone&&a.phone.replace(/\D/g,"").length<10&&(s.phone="Geçerli bir telefon numarası girin."),s},y=async s=>{s.preventDefault();const o=D();if(Object.keys(o).length>0){const r=["name","email","phone","company","address","tax_number","notes"],p={};r.forEach(g=>{p[g]=!0}),N(p),u(o);return}h(!0);try{if(!v){f.error("Oturumunuz sona erdi. Lütfen tekrar giriş yapın."),h(!1);return}await G({name:a.name,company:a.company||null,email:a.email||null,phone:M(a.phone),address:a.address||null,taxId:a.tax_number||null,notes:a.notes||null,createdBy:v.id}),f.success("Müşteri başarıyla oluşturuldu"),k(),d(!1),b()}catch(r){console.error("Create customer error:",r),f.error(r.message||"Müşteri oluşturulurken hata oluştu")}finally{h(!1)}};return e.jsx(B,{open:c,onOpenChange:d,children:e.jsx(R,{className:"!max-w-[100vw] sm:!max-w-[95vw] !w-[100vw] sm:!w-[95vw] !h-[100vh] sm:!h-[90vh] !max-h-[100vh] sm:!max-h-[90vh] !left-0 sm:!left-[2.5vw] !top-0 sm:!top-[5vh] !right-0 sm:!right-auto !bottom-0 sm:!bottom-auto !translate-x-0 !translate-y-0 overflow-hidden !p-0 gap-0 bg-white flex flex-col !m-0 !rounded-none sm:!rounded-lg !border-0 sm:!border",children:e.jsxs("div",{className:"flex flex-col h-full min-h-0",children:[e.jsx(q,{className:"p-3 sm:p-4 border-b bg-white flex-shrink-0 relative pr-12 sm:pr-16",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"h-8 w-8 sm:h-10 sm:w-10 rounded-lg bg-primary/10 flex items-center justify-center border border-primary/20 flex-shrink-0",children:e.jsx(E,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary"})}),e.jsx(A,{className:"text-lg sm:text-xl font-semibold text-foreground truncate",children:"Yeni Müşteri"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 flex-shrink-0",children:[e.jsxs(w,{variant:"outline",size:"sm",className:"border-primary/20 hover:bg-primary/5 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0",onClick:()=>d(!1),disabled:x,children:[e.jsx(S,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"İptal"]}),e.jsxs(w,{variant:"default",size:"sm",className:"bg-primary hover:bg-primary/90 rounded-lg px-3 py-1.5 font-medium text-xs sm:text-sm flex-shrink-0 text-white",onClick:y,disabled:x,children:[x?e.jsx(z,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0 animate-spin"}):e.jsx(I,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5 flex-shrink-0"}),"Kaydet"]})]})]})}),e.jsx("div",{className:"flex-1 overflow-hidden bg-gray-50/50 p-3 sm:p-4 min-h-0",children:e.jsx("div",{className:"max-w-full mx-auto h-full overflow-y-auto",children:e.jsx("form",{onSubmit:y,className:"space-y-4 sm:space-y-6",children:e.jsx(T,{children:e.jsxs(L,{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-1",children:"Müşteri Bilgileri"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:"Temel müşteri bilgilerini girin"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"name",showRequired:!0,className:"text-sm sm:text-base",children:"İsim"}),e.jsx(i,{id:"name",value:a.name,onChange:s=>l("name",s.target.value),className:"min-h-[44px] sm:min-h-0",required:!0}),t.name&&e.jsx("p",{className:"text-xs text-destructive",children:t.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"company",className:"text-sm sm:text-base",children:"Şirket"}),e.jsx(i,{id:"company",value:a.company,onChange:s=>l("company",s.target.value),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"email",className:"text-sm sm:text-base",children:"E-posta"}),e.jsx(i,{id:"email",type:"email",value:a.email,onChange:s=>l("email",s.target.value),className:"min-h-[44px] sm:min-h-0"}),t.email&&e.jsx("p",{className:"text-xs text-destructive",children:t.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"phone",className:"text-sm sm:text-base",children:"Telefon"}),e.jsx(i,{id:"phone",value:a.phone,onChange:s=>l("phone",s.target.value),className:"min-h-[44px] sm:min-h-0"}),t.phone&&e.jsx("p",{className:"text-xs text-destructive",children:t.phone})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"address",className:"text-sm sm:text-base",children:"Adres"}),e.jsx(C,{id:"address",value:a.address,onChange:s=>l("address",s.target.value),rows:3,className:"min-h-[44px] sm:min-h-0 resize-none"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"tax_number",className:"text-sm sm:text-base",children:"Vergi No"}),e.jsx(i,{id:"tax_number",value:a.tax_number,onChange:s=>l("tax_number",s.target.value),className:"min-h-[44px] sm:min-h-0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"notes",className:"text-sm sm:text-base",children:"Notlar"}),e.jsx(C,{id:"notes",value:a.notes,onChange:s=>l("notes",s.target.value),rows:4,className:"min-h-[44px] sm:min-h-0 resize-none",placeholder:"Müşteri hakkında notlar..."})]})]})})})})})]})})})};export{K as C};

import{a3 as Rs,x as Cs,M as _e,z as st,D as tt,E as Bs,g as be,au as Es,T as ye,G as Is,F as Ps,I as Ms,Q as Ls,k as Ie,r as o,b as W,j as e,C as R,e as C,L as pe,B as _,v as ls,X as Us,w as Os,R as at,a8 as We,a9 as es,ak as lt,l as Gs,m as qs,n as ue,i as je,ab as ss,aj as he,o as ze,a7 as rt,at as nt,aW as rs,h as Fs,S as zs,p as $s,q as Ks,s as _s,t as $e,a0 as hs,a1 as fs,$ as js,c as ve,d as we,ai as it}from"./index-Xd90qdO9.js";import{B as V,C as Ee,D as ns,a as is,b as cs,c as ds,d as os,T as ct,e as Ws,W as Ke,j as ms,J as gs,w as Ns,z as Hs,M as dt}from"./MainLayout-DW7UjMSA.js";import{A as ot,a as mt,b as xt,c as pt,d as ut,e as ht,f as ft,g as jt}from"./alert-dialog-BVp-ELLM.js";import{A as Ae,a as Re,b as ys}from"./avatar-KtUT5CWN.js";import{b as ge,c as gt,a as xs,y as Nt,x as yt}from"./taskService-CQO0i9v5.js";import{T as vt}from"./TaskInlineForm-CDqKbM2W.js";import{F as wt}from"./folder-DUFwF4S_.js";import{C as Ys}from"./calendar-days-DIIfLF_e.js";import{i as Ce,a as Vs}from"./isBefore-CpsBulHW.js";import{s as Qs,f as vs}from"./format-DuC-NjES.js";import{a as Xs}from"./addDays-b8IynWul.js";import{g as ws}from"./pdfGenerator-H9L-JbYf.js";import{S as bt}from"./search-input-QX7HVhJf.js";import{T as bs,a as Ts,b as oe,c as fe,d as Ds,e as U}from"./table-CHpYTcky.js";import{getRoles as Tt}from"./rolePermissionsService-CoZ8Qmsy.js";import{T as Be}from"./trending-up-DyiN6Ad2.js";import{D as ts}from"./download-Bq-rl9Ru.js";import{D as Dt,A as kt}from"./DepartmentDetailModal-eftmRmp7.js";import{P as as}from"./progress-DSBhhNxd.js";import{S as ks}from"./skeleton-DkPhyqEs.js";import{C as Js}from"./chart-column-tcYl_7Fa.js";import{s as St}from"./subDays-BSPI1LCX.js";import{U as Ss}from"./user-plus-DWuSLDZe.js";import"./storageService-pEqhfEwa.js";import"./driveService-020R8zku.js";import"./checkbox-BX7aNvy5.js";import"./UserMultiSelect-KlPlOKAA.js";import"./popover-BA39Kv9C.js";import"./permissions-D79DzJt5.js";import"./plus-D9uLCipi.js";import"./list-checks-CkcaKLuC.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=Rs("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=Rs("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Zs=async a=>{try{const u=Cs(_e,"departments"),Z=st(u,tt("managerId","==",a)),b=(await Bs(Z)).docs.map(h=>h.id);if(b.length===0)return[];const N=await be(),D=[];for(const h of N)if(h.pendingTeams&&h.pendingTeams.length>0){for(const w of h.pendingTeams)if(b.includes(w)){const j=await Es(w);j&&D.push({userId:h.id,userName:h.fullName||h.displayName||h.email,userEmail:h.email,teamId:w,teamName:j.name,requestedAt:h.createdAt||ye.now(),status:"pending"})}}return D.sort((h,w)=>{var z,M;const j=((z=h.requestedAt)==null?void 0:z.toMillis())||0;return(((M=w.requestedAt)==null?void 0:M.toMillis())||0)-j})}catch(u){throw console.error("Get pending team requests error:",u),u}},et=async()=>{try{const a=Cs(_e,"departments"),u=await Bs(a),Z=new Set;u.docs.forEach(N=>{const D=N.data();D.managerId&&D.managerId.trim()!==""&&Z.add(N.id)});const B=await be(),b=[];for(const N of B)if(N.pendingTeams&&N.pendingTeams.length>0){for(const D of N.pendingTeams)if(!Z.has(D)){const h=await Es(D);h&&b.push({userId:N.id,userName:N.fullName||N.displayName||N.email,userEmail:N.email,teamId:D,teamName:h.name,requestedAt:N.createdAt||ye.now(),status:"pending"})}}return b.sort((N,D)=>{var j,I;const h=((j=N.requestedAt)==null?void 0:j.toMillis())||0;return(((I=D.requestedAt)==null?void 0:I.toMillis())||0)-h})}catch(a){throw console.error("Get all pending team requests error:",a),a}},Ct=async(a,u,Z)=>{try{const B=Is(_e,"users",a),b=await Ps(B);if(!b.exists())throw new Error("Kullanıcı bulunamadı");const N=b.data(),D=N.pendingTeams||[],h=N.approvedTeams||[];if(!D.includes(u))throw new Error("Bu ekip talebi bulunamadı");const w=D.filter(I=>I!==u),j=[...h,u];await Ms(B,{pendingTeams:w,approvedTeams:j,updatedAt:Ls()})}catch(B){throw console.error("Approve team request error:",B),B}},Bt=async(a,u,Z)=>{try{const B=Is(_e,"users",a),b=await Ps(B);if(!b.exists())throw new Error("Kullanıcı bulunamadı");const D=b.data().pendingTeams||[];if(!D.includes(u))throw new Error("Bu ekip talebi bulunamadı");const h=D.filter(w=>w!==u);await Ms(B,{pendingTeams:h,updatedAt:Ls()})}catch(B){throw console.error("Reject team request error:",B),B}},Et=()=>{const{user:a,isAdmin:u}=Ie(),[Z,B]=o.useState(!0),[b,N]=o.useState([]),[D,h]=o.useState(!1),[w,j]=o.useState(null),[I,z]=o.useState("");o.useEffect(()=>{M()},[a]);const M=async()=>{if(a!=null&&a.id){B(!0);try{let v;u?v=await et():v=await Zs(a.id),N(v)}catch(v){W.error("Talepler yüklenirken hata: "+v.message)}finally{B(!1)}}},Q=async v=>{try{await Ct(v.userId,v.teamId,(a==null?void 0:a.id)||""),W.success(`${v.userName} kullanıcısı ${v.teamName} ekibine onaylandı`),M()}catch(L){W.error("Onaylama hatası: "+L.message)}},ee=async()=>{if(w)try{await Bt(w.userId,w.teamId,I),W.success(`${w.userName} kullanıcısının ${w.teamName} ekibi talebi reddedildi`),h(!1),j(null),z(""),M()}catch(v){W.error("Reddetme hatası: "+v.message)}},O=v=>{j(v),h(!0)};return Z?e.jsx(R,{children:e.jsx(C,{className:"flex items-center justify-center py-8",children:e.jsx(pe,{className:"h-6 w-6 animate-spin text-primary"})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(R,{children:e.jsxs(C,{className:"pt-6",children:[b.length>0&&e.jsx("div",{className:"mb-4 flex justify-end",children:e.jsxs(V,{variant:"secondary",children:[b.length," bekleyen talep"]})}),b.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Onay bekleyen ekip talebi yok"}):e.jsx("div",{className:"space-y-3",children:b.map(v=>{var L;return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"font-semibold",children:v.userName}),e.jsx(V,{variant:"outline",children:v.teamName})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:v.userEmail}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Talep tarihi: ",(L=v.requestedAt)==null?void 0:L.toDate().toLocaleDateString("tr-TR")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{size:"sm",variant:"default",onClick:()=>Q(v),className:"gap-2",children:[e.jsx(ls,{className:"h-4 w-4"}),"Onayla"]}),e.jsxs(_,{size:"sm",variant:"destructive",onClick:()=>O(v),className:"gap-2",children:[e.jsx(Us,{className:"h-4 w-4"}),"Reddet"]})]})]},`${v.userId}-${v.teamId}`)})})]})}),e.jsx(ot,{open:D,onOpenChange:h,children:e.jsxs(mt,{children:[e.jsxs(xt,{children:[e.jsx(pt,{children:"Ekip Talebini Reddet"}),e.jsx(ut,{children:w&&e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:w.userName})," kullanıcısının"," ",e.jsx("strong",{children:w.teamName})," ekibi talebini reddetmek istediğinizden emin misiniz?"]})})]}),e.jsxs("div",{className:"space-y-2 py-4",children:[e.jsx(Os,{htmlFor:"reject-reason",children:"Red Nedeni (Opsiyonel)"}),e.jsx(at,{id:"reject-reason",value:I,onChange:v=>z(v.target.value),placeholder:"Red nedeni..."})]}),e.jsxs(ht,{children:[e.jsx(ft,{children:"İptal"}),e.jsx(jt,{onClick:ee,className:"bg-destructive text-destructive-foreground",children:"Reddet"})]})]})})]})},As=a=>{if(!a)return"Tarih yok";try{let u;if(a!=null&&a.toDate)u=a.toDate();else if(a instanceof Date)u=a;else if(typeof a=="string")u=new Date(a);else return"Geçersiz tarih";return isNaN(u.getTime())?"Geçersiz tarih":u.toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Tarih hatası"}},It=()=>{const{user:a,isAdmin:u,isTeamLeader:Z}=Ie(),[B,b]=o.useState(!0),[N,D]=o.useState([]),[h,w]=o.useState([]),[j,I]=o.useState([]),[z,M]=o.useState({}),[Q,ee]=o.useState({}),[O,v]=o.useState({}),[L,F]=o.useState(null),[H,k]=o.useState(!1),[r,Ne]=o.useState(""),[re,J]=o.useState("pending"),[Te,n]=o.useState(!1),[x,p]=o.useState(null),[E,G]=o.useState("pending"),[X,le]=o.useState("edit"),[se,i]=o.useState(new Map),[te,Pe]=o.useState([]),[s,l]=o.useState({}),[d,c]=o.useState(new Set);o.useEffect(()=>{m()},[a,u]);const m=async()=>{if(a!=null&&a.id){b(!0);try{const[t,S,ie,ce,Me,Le]=await Promise.all([ge({approvalStatus:"pending"}),ge({approvalStatus:"approved"}),ge({approvalStatus:"rejected"}),be(),We(),gt()]),Ue=new Map;Le.forEach(g=>{Ue.set(g.id,g)}),i(Ue),Pe(ce);const De=g=>{if(u)return g;const f=Me.filter(P=>P.managerId===a.id);if(f.length===0)return[];const de=f.map(P=>P.id),xe=ce.filter(P=>!!(P.approvedTeams&&P.approvedTeams.some(Se=>de.includes(Se))||P.pendingTeams&&P.pendingTeams.some(Se=>de.includes(Se))||P.departmentId&&de.includes(P.departmentId))).map(P=>P.id);return g.filter(P=>P.createdBy===a.id||P.approvalRequestedBy&&xe.includes(P.approvalRequestedBy))},Je=De(t),ae=De(S),ke=De(ie),A=[...Je,...ae,...ke],K=await Promise.all(A.map(async g=>{try{const de=(await xs(g.id)).map(xe=>{const P=ce.find(Se=>Se.id===xe.assignedTo);return P?{id:P.id,full_name:P.fullName||P.displayName||P.email||"Bilinmeyen",email:P.email}:null}).filter(xe=>xe!==null);return{...g,assignedUsers:de}}catch(f){return console.error(`Error fetching assignments for task ${g.id}:`,f),{...g,assignedUsers:[]}}})),y=K.filter(g=>Je.some(f=>f.id===g.id)),Oe=K.filter(g=>ae.some(f=>f.id===g.id)),me=K.filter(g=>ke.some(f=>f.id===g.id));D(y),w(Oe),I(me);const Ge={},qe={},Fe={};await Promise.all(A.map(async g=>{if(g.approvalRequestedBy&&!Ge[g.approvalRequestedBy])try{const f=await es(g.approvalRequestedBy,!0);Ge[g.approvalRequestedBy]=(f==null?void 0:f.fullName)||(f==null?void 0:f.email)||"Silinmiş Kullanıcı"}catch{Ge[g.approvalRequestedBy]="Silinmiş Kullanıcı"}if(g.approvedBy&&!qe[g.approvedBy])try{const f=await es(g.approvedBy,!0);qe[g.approvedBy]=(f==null?void 0:f.fullName)||(f==null?void 0:f.email)||"Silinmiş Kullanıcı"}catch{qe[g.approvedBy]="Silinmiş Kullanıcı"}if(g.rejectedBy&&!Fe[g.rejectedBy])try{const f=await es(g.rejectedBy,!0);Fe[g.rejectedBy]=(f==null?void 0:f.fullName)||(f==null?void 0:f.email)||"Silinmiş Kullanıcı"}catch{Fe[g.rejectedBy]="Silinmiş Kullanıcı"}})),M(Ge),ee(qe),v(Fe);const Ze={},us=new Set;for(const g of K){const f=g.assignedUsers||[];for(const de of f){const xe=typeof de=="string"?de:de.id;xe&&us.add(xe)}}await Promise.all(Array.from(us).map(async g=>{try{const f=await lt({userId:g,limit:10});Ze[g]=f}catch(f){console.error(`Error fetching logs for user ${g}:`,f),Ze[g]=[]}})),l(Ze)}catch(t){console.error("Fetch tasks error:",t),W.error("Görevler yüklenemedi")}finally{b(!1)}}},T=async t=>{if(a!=null&&a.id)try{await yt(t.id,a.id),W.success("Görev onaylandı"),m()}catch(S){W.error("Onaylama hatası: "+S.message)}},$=async()=>{if(!(!L||!(a!=null&&a.id)))try{await Nt(L.id,a.id,r||null),W.success("Görev onayı reddedildi"),k(!1),F(null),Ne(""),m()}catch(t){W.error("Reddetme hatası: "+t.message)}},q=t=>{p(t.id);const S=t.status==="cancelled"?"completed":t.status;G(S),le("edit"),n(!0)},ne=()=>{m()},He=t=>{switch(t){case"completed":return e.jsx(je,{className:"h-5 w-5 text-success"});case"in_progress":return e.jsx(Ee,{className:"h-5 w-5 text-warning"});default:return e.jsx(Fs,{className:"h-5 w-5 text-muted-foreground"})}},Ye=t=>({pending:"Beklemede",in_progress:"Devam Ediyor",completed:"Tamamlandı",cancelled:"İptal"})[t]||t,Y=t=>{if(!t.dueDate)return!1;let S;return t.dueDate instanceof ye||t.dueDate&&typeof t.dueDate=="object"&&"toDate"in t.dueDate?S=t.dueDate.toDate():S=new Date(t.dueDate),Ce(S,new Date)&&t.status!=="completed"},ps=t=>{if(!t.dueDate)return!1;let S;t.dueDate instanceof ye||t.dueDate&&typeof t.dueDate=="object"&&"toDate"in t.dueDate?S=t.dueDate.toDate():S=new Date(t.dueDate);const ie=Qs(new Date),ce=Xs(ie,3);return!Y(t)&&(Vs(S,ie)||S.getTime()===ie.getTime())&&Ce(S,ce)&&t.status!=="completed"},Ve=t=>{if(!t)return"-";try{let S;if(t instanceof ye)S=t.toDate();else if(typeof t=="string")S=new Date(t);else if(t&&typeof t=="object"&&"toDate"in t)S=t.toDate();else return"-";return S.toLocaleDateString("tr-TR",{day:"2-digit",month:"short"})}catch{return"-"}},Qe=t=>t.split(" ").map(S=>S[0]).join("").toUpperCase().slice(0,2),Xe=(t,S=!0)=>{var ke;z[t.approvalRequestedBy||""];const ie=t.approvedBy?Q[t.approvedBy]||"...":null,ce=t.rejectedBy?O[t.rejectedBy]||"...":null,Me=t.approvedAt?As(t.approvedAt):null,Le=t.rejectedAt?As(t.rejectedAt):null,Ue=Y(t),De=ps(t),ae=(t.assignedUsers||[]).map(A=>{if(typeof A=="string"){const K=te.find(y=>y.id===A);return K?{id:K.id,full_name:K.fullName||K.email||"Bilinmeyen"}:null}return A}).filter(Boolean);return e.jsx("div",{className:"p-6 rounded-xl border-2 border-border hover:border-primary/40 hover:bg-primary/5 transition-all duration-200 shadow-sm hover:shadow-md",children:e.jsxs("div",{className:"flex flex-col gap-5 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>q(t),children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[He(t.status),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:t.title}),t.projectId&&se.has(t.projectId)&&e.jsxs(V,{variant:"outline",className:"bg-gradient-to-r from-blue-50 to-indigo-50 text-blue-700 border-blue-300 hover:from-blue-100 hover:to-indigo-100 transition-all shadow-sm",children:[e.jsx(wt,{className:"h-3 w-3 mr-1.5"}),e.jsx("span",{className:"font-semibold text-xs",children:(ke=se.get(t.projectId))==null?void 0:ke.name})]})]})})]}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2 mb-4 line-clamp-2 leading-relaxed",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx(V,{variant:"secondary",children:Ye(t.status)}),e.jsxs(V,{variant:"outline",className:"text-xs",children:["Öncelik ",t.priority]}),De&&e.jsx(V,{className:"bg-amber-100 text-amber-900 border-amber-200",children:"Yaklaşan Termin"}),Ue&&e.jsx(V,{variant:"destructive",children:"Termin Geçti"}),t.approvalStatus==="pending"&&e.jsx(V,{className:"bg-yellow-100 text-yellow-900 border-yellow-300",children:"Görev Onayı Bekleniyor"}),t.approvalStatus==="approved"&&e.jsx(V,{className:"bg-green-100 text-green-900 border-green-300",children:"Görev Onaylandı"}),t.approvalStatus==="rejected"&&e.jsx(V,{className:"bg-red-100 text-red-900 border-red-300",children:"Görev Onayı Reddedildi"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-4 text-sm text-muted-foreground",children:[t.dueDate&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ys,{className:"h-4 w-4"}),"Termin: ",Ve(t.dueDate)]}),ae.length>0&&e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4"}),ae.length," kişi"]})]}),ae.length>0&&e.jsxs("div",{className:"flex items-center gap-2 mt-4",children:[e.jsx("div",{className:"flex -space-x-2",children:ae.slice(0,4).map(A=>e.jsx(Ae,{className:"h-7 w-7 border-2 border-background",children:e.jsx(Re,{className:"text-[11px]",children:Qe(A.full_name)})},A.id))}),ae.length>4&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",ae.length-4," daha"]})]}),(ie||ce||t.rejectionReason)&&e.jsxs("div",{className:"flex flex-col gap-1 mt-4 text-sm",children:[ie&&Me&&e.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[e.jsx(je,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:["Onaylayan: ",e.jsx("span",{className:"font-medium",children:ie})," - ",Me]})]}),ce&&Le&&e.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[e.jsx(ss,{className:"h-3.5 w-3.5"}),e.jsxs("span",{children:["Reddeden: ",e.jsx("span",{className:"font-medium",children:ce})," - ",Le]})]}),t.rejectionReason&&e.jsxs("div",{className:"text-red-600 italic mt-1",children:["Red Nedeni: ",t.rejectionReason]})]})]}),ae.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-border",children:[e.jsxs("button",{type:"button",onClick:A=>{A.stopPropagation(),c(K=>{const y=new Set(K);return y.has(t.id)?y.delete(t.id):y.add(t.id),y})},className:"flex items-center gap-2 text-sm font-medium text-muted-foreground hover:text-foreground transition-colors w-full",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{children:"Ekip Üyelerinin Logları"}),d.has(t.id)?e.jsx(rt,{className:"h-4 w-4 ml-auto"}):e.jsx(nt,{className:"h-4 w-4 ml-auto"})]}),d.has(t.id)&&e.jsx("div",{className:"mt-3 space-y-3",children:ae.map(A=>{const K=s[A.id]||[];return K.length===0?e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30 border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ae,{className:"h-6 w-6",children:e.jsx(Re,{className:"text-[10px]",children:Qe(A.full_name)})}),e.jsx("span",{className:"font-medium text-sm",children:A.full_name})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Henüz log bulunmuyor"})]},A.id):e.jsxs("div",{className:"p-3 rounded-lg bg-muted/30 border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ae,{className:"h-6 w-6",children:e.jsx(Re,{className:"text-[10px]",children:Qe(A.full_name)})}),e.jsx("span",{className:"font-medium text-sm",children:A.full_name}),e.jsxs(V,{variant:"secondary",className:"text-xs ml-auto",children:[K.length," log"]})]}),e.jsxs("div",{className:"space-y-2",children:[K.slice(0,5).map(y=>{const Oe={CREATE:{color:"bg-green-500",label:"Oluşturma"},UPDATE:{color:"bg-blue-500",label:"Güncelleme"},DELETE:{color:"bg-red-500",label:"Silme"}}[y.action]||{color:"bg-gray-500",label:y.action};let me;return y.createdAt instanceof ye||y.createdAt&&typeof y.createdAt=="object"&&"toDate"in y.createdAt?me=y.createdAt.toDate():y.createdAt&&typeof y.createdAt=="object"&&y.createdAt.constructor===Date?me=y.createdAt:typeof y.createdAt=="string"||typeof y.createdAt=="number"?me=new Date(y.createdAt):me=new Date,e.jsxs("div",{className:"flex items-start gap-2 text-xs",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${Oe.color} mt-1.5 flex-shrink-0`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-medium",children:Oe.label}),y.tableName&&e.jsx("span",{className:"text-muted-foreground",children:y.tableName==="tasks"?"Görev":y.tableName==="profiles"?"Profil":y.tableName==="departments"?"Departman":y.tableName})]}),y.tableName&&y.recordId&&e.jsxs("p",{className:"text-muted-foreground mt-0.5 line-clamp-1",children:[y.tableName==="tasks"?"Görev":y.tableName==="profiles"?"Profil":y.tableName," - ",y.recordId.substring(0,8)]}),e.jsx("p",{className:"text-muted-foreground mt-0.5",children:me.toLocaleDateString("tr-TR",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})})]})]},y.id)}),K.length>5&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["+",K.length-5," log daha"]})]})]},A.id)})})]}),e.jsxs("div",{className:"flex items-center gap-2",onClick:A=>A.stopPropagation(),children:[S&&t.approvalStatus==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(_,{size:"sm",variant:"default",className:"bg-green-600 hover:bg-green-700 text-white",onClick:A=>{A.stopPropagation(),T(t)},children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Onayla"]}),e.jsxs(_,{size:"sm",variant:"outline",className:"border-red-200 text-red-700 hover:bg-red-50 hover:text-red-800",onClick:A=>{A.stopPropagation(),F(t),k(!0)},children:[e.jsx(Us,{className:"h-4 w-4 mr-2"}),"Reddet"]})]}),e.jsxs(_,{size:"sm",variant:"outline",onClick:A=>{A.stopPropagation(),q(t)},children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),"Detay"]})]})]})},t.id)};return B?e.jsx(R,{children:e.jsx(C,{className:"flex items-center justify-center py-8",children:e.jsx(pe,{className:"h-6 w-6 animate-spin text-primary"})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(R,{children:e.jsx(C,{className:"pt-6",children:e.jsxs(Gs,{value:re,onValueChange:J,className:"w-full",children:[e.jsxs(qs,{className:"grid w-full grid-cols-3",children:[e.jsxs(ue,{value:"pending",className:"gap-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),"Bekleyen (",N.length,")"]}),e.jsxs(ue,{value:"approved",className:"gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),"Onaylandı (",h.length,")"]}),e.jsxs(ue,{value:"rejected",className:"gap-2",children:[e.jsx(ss,{className:"h-4 w-4"}),"Reddedildi (",j.length,")"]})]}),e.jsx(he,{value:"pending",className:"space-y-4 mt-4",children:N.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(ls,{className:"h-10 w-10 text-muted-foreground/20"})}),e.jsx("p",{children:"Onayınızı bekleyen görev bulunmuyor."})]}):e.jsx("div",{className:"space-y-4",children:N.map(t=>Xe(t,!0))})}),e.jsx(he,{value:"approved",className:"space-y-4 mt-4",children:h.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(je,{className:"h-10 w-10 text-muted-foreground/20"})}),e.jsx("p",{children:"Onaylanmış görev bulunmuyor."})]}):e.jsx("div",{className:"space-y-4",children:h.map(t=>Xe(t,!1))})}),e.jsx(he,{value:"rejected",className:"space-y-4 mt-4",children:j.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx(ss,{className:"h-10 w-10 text-muted-foreground/20"})}),e.jsx("p",{children:"Reddedilmiş görev bulunmuyor."})]}):e.jsx("div",{className:"space-y-4",children:j.map(t=>Xe(t,!1))})})]})})}),e.jsx(ns,{open:H,onOpenChange:k,children:e.jsxs(is,{children:[e.jsxs(cs,{children:[e.jsx(ds,{children:"Görevi Reddet"}),e.jsx(os,{children:'Görevi neden reddettiğinizi belirtebilirsiniz. Görev "Devam Ediyor" statüsüne geri dönecektir.'})]}),e.jsxs("div",{className:"space-y-2 py-2",children:[e.jsx(Os,{children:"Red Nedeni"}),e.jsx(ct,{placeholder:"Eksik kısımlar var, lütfen kontrol et...",value:r,onChange:t=>Ne(t.target.value)})]}),e.jsxs(Ws,{children:[e.jsx(_,{variant:"outline",onClick:()=>k(!1),children:"İptal"}),e.jsx(_,{variant:"destructive",onClick:$,children:"Reddet"})]})]})}),e.jsx(ns,{open:Te,onOpenChange:n,children:e.jsxs(is,{className:"max-w-4xl w-[95vw] overflow-y-auto max-h-[90vh]",children:[e.jsxs(cs,{children:[e.jsx(ds,{children:"Görev Detayları"}),e.jsx(os,{children:"Görev detaylarını, ekibi ve checklist'i görüntüleyin."})]}),x&&e.jsx(vt,{mode:X,projectId:null,taskId:x,defaultStatus:E,onCancel:()=>{n(!1),p(null),G("pending")},onSuccess:()=>{ne(),n(!1),p(null),G("pending")},className:"border-0 shadow-none p-0"},`${X}-${x}`)]})})]})},Pt=()=>{const{user:a,isAdmin:u,isTeamLeader:Z}=Ie(),[B,b]=o.useState(!0),[N,D]=o.useState([]),[h,w]=o.useState([]),[j,I]=o.useState([]),[z,M]=o.useState(null),[Q,ee]=o.useState(""),[O,v]=o.useState("all"),[L,F]=o.useState({}),[H,k]=o.useState(!1),[r,Ne]=o.useState(null),[re,J]=o.useState(!1);o.useEffect(()=>{Te()},[a,u]);const Te=async()=>{if(a!=null&&a.id){b(!0);try{const[s,l,d]=await Promise.all([be(),We(),Tt()]);w(l),I(d);let c=[];if(u)c=s;else{const T=l.filter($=>$.managerId===a.id);if(T.length===0)c=[];else{const $=T.map(q=>q.id);c=s.filter(q=>!!(q.approvedTeams&&q.approvedTeams.some(ne=>$.includes(ne))||q.pendingTeams&&q.pendingTeams.some(ne=>$.includes(ne))||q.departmentId&&$.includes(q.departmentId)))}}D(c);const m={};await Promise.all(c.map(async T=>{try{const $=await ge({assignedTo:T.id}),q=await Promise.all($.map(async Y=>(await xs(Y.id)).find(Ve=>Ve.assignedTo===T.id))),ne=q.filter(Y=>(Y==null?void 0:Y.status)==="completed").length,He=q.filter(Y=>(Y==null?void 0:Y.status)==="pending").length,Ye=q.filter(Y=>(Y==null?void 0:Y.status)==="accepted").length;m[T.id]={total:$.length,completed:ne,pending:He,inProgress:Ye}}catch($){console.error(`Error fetching stats for ${T.id}:`,$),m[T.id]={total:0,completed:0,pending:0,inProgress:0}}})),F(m)}catch(s){console.error("Fetch team members error:",s),W.error("Ekip üyeleri yüklenemedi")}finally{b(!1)}}},n=o.useMemo(()=>{let s=N;if(Q.trim()){const l=Q.toLowerCase();s=s.filter(d=>{var c,m,T;return((c=d.fullName)==null?void 0:c.toLowerCase().includes(l))||((m=d.email)==null?void 0:m.toLowerCase().includes(l))||((T=d.phone)==null?void 0:T.toLowerCase().includes(l))})}return O!=="all"&&(s=s.filter(l=>{var d,c;return!!((d=l.approvedTeams)!=null&&d.includes(O)||(c=l.pendingTeams)!=null&&c.includes(O)||l.departmentId===O)})),s},[N,Q,O]),x=o.useMemo(()=>{if(!u)return null;const s={};return h.forEach(l=>{s[l.id]=[]}),s["no-department"]=[],n.forEach(l=>{const d=[];l.approvedTeams&&l.approvedTeams.length>0&&d.push(...l.approvedTeams),l.pendingTeams&&l.pendingTeams.length>0&&l.pendingTeams.forEach(c=>{d.includes(c)||d.push(c)}),l.departmentId&&!d.includes(l.departmentId)&&d.push(l.departmentId),d.length>0?d.forEach(c=>{s[c]&&(s[c].find(m=>m.id===l.id)||s[c].push(l))}):s["no-department"].push(l)}),s},[n,h,u]),p=s=>{var d;return h.some(c=>c.managerId===s.id)?"team_leader":((d=s.role)==null?void 0:d[0])||"viewer"},E=s=>{const l=j.find(d=>d.key===s);return l?l.label:s},G=s=>{const l=j.find(d=>d.key===s);return l?l.color.replace("bg-","bg-"):"bg-gray-500"},X=s=>h.some(l=>l.managerId===s.id),le=async s=>{try{const l=await ge({assignedTo:s.id}),d=await Promise.all(l.map(async c=>{var $,q;const T=(await xs(c.id)).find(ne=>ne.assignedTo===s.id);return{taskTitle:c.title,status:(T==null?void 0:T.status)||"pending",assignedAt:(($=T==null?void 0:T.assignedAt)==null?void 0:$.toDate())||c.createdAt.toDate(),completedAt:((q=T==null?void 0:T.completedAt)==null?void 0:q.toDate())||(c.status==="completed"?c.updatedAt.toDate():null)}}));return{userName:s.fullName||s.email,userEmail:s.email,total:l.length,accepted:d.filter(c=>c.status==="accepted").length,rejected:d.filter(c=>c.status==="rejected").length,pending:d.filter(c=>c.status==="pending").length,completed:d.filter(c=>c.status==="completed").length,active:d.filter(c=>c.status==="accepted").length,assignments:d}}catch(l){throw console.error("Error fetching user stats:",l),l}},se=async s=>{J(!0);try{const l=await le(s);Ne({member:s,stats:l}),k(!0)}catch(l){W.error("Rapor yüklenemedi: "+l.message)}finally{J(!1)}},i=async s=>{M(s.id);try{const l=await le(s),d=await ws(l),c=URL.createObjectURL(d),m=document.createElement("a");m.href=c,m.download=`${s.fullName||"Kullanici"}-Raporu.pdf`,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(c),W.success("Rapor indirildi")}catch(l){console.error("Report generation error:",l),W.error("Rapor oluşturulamadı: "+l.message)}finally{M(null)}},te=async()=>{if(r){M(r.member.id);try{const s=await ws(r.stats),l=URL.createObjectURL(s),d=document.createElement("a");d.href=l,d.download=`${r.member.fullName||"Kullanici"}-Raporu.pdf`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(l),W.success("Rapor indirildi")}catch(s){console.error("Report generation error:",s),W.error("Rapor oluşturulamadı: "+s.message)}finally{M(null)}}},Pe=s=>{const l=[];if(s.approvedTeams&&s.approvedTeams.length>0&&l.push(...s.approvedTeams),s.pendingTeams&&s.pendingTeams.length>0&&s.pendingTeams.forEach(c=>{l.includes(c)||l.push(c)}),s.departmentId&&!l.includes(s.departmentId)&&l.push(s.departmentId),l.length===0)return"-";const d=l.map(c=>{var m;return(m=h.find(T=>T.id===c))==null?void 0:m.name}).filter(Boolean);return d.length>0?d.join(", "):"-"};return B?e.jsx(R,{children:e.jsx(C,{className:"flex items-center justify-center py-8",children:e.jsx(pe,{className:"h-6 w-6 animate-spin text-primary"})})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx(R,{children:e.jsxs(C,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(bt,{placeholder:"İsim, e-posta veya telefon ara...",value:Q,onChange:s=>ee(s.target.value),containerClassName:"flex-1"}),e.jsxs(zs,{value:O,onValueChange:v,children:[e.jsx($s,{className:"w-full sm:w-[200px]",children:e.jsx(Ks,{placeholder:"Departman Filtrele"})}),e.jsxs(_s,{children:[e.jsx($e,{value:"all",children:"Tüm Departmanlar"}),h.map(s=>e.jsx($e,{value:s.id,children:s.name},s.id))]})]})]}),n.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(ze,{className:"h-12 w-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:Q||O!=="all"?"Arama kriterlerinize uygun üye bulunamadı.":"Ekibinizde üye bulunmuyor."})]}):u&&x?e.jsx("div",{className:"space-y-6",children:Object.entries(x).map(([s,l])=>{if(l.length===0)return null;const d=h.find(m=>m.id===s),c=d?d.name:s==="no-department"?"Departmanı Olmayan Üyeler":"Bilinmeyen Departman";return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx(ms,{className:"h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:c}),e.jsxs(V,{variant:"secondary",className:"ml-auto",children:[l.length," üye"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(m=>{var $,q;const T=L[m.id]||{total:0,completed:0,pending:0,inProgress:0};return e.jsx(R,{className:"hover:shadow-md transition-shadow h-full flex flex-col",children:e.jsxs(C,{className:"p-4 space-y-4 flex flex-col h-full",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsxs(Ae,{className:"h-12 w-12 flex-shrink-0",children:[e.jsx(ys,{src:void 0}),e.jsx(Re,{className:"bg-primary/10 text-primary",children:m.fullName?m.fullName.substring(0,2).toUpperCase():"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-semibold line-clamp-1",children:m.fullName||"İsimsiz"}),((($=m.role)==null?void 0:$.includes("admin"))||((q=m.role)==null?void 0:q.includes("super_admin"))||X(m))&&e.jsx(gs,{className:"h-4 w-4 text-primary flex-shrink-0"})]}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:m.email}),m.phone&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:hs(m.phone)})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[m.email&&e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1 gap-2",onClick:()=>window.location.href=`mailto:${m.email}`,children:[e.jsx(fs,{className:"h-3.5 w-3.5"}),"Mail"]}),m.phone&&e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1 gap-2",onClick:()=>window.location.href=`tel:${m.phone}`,children:[e.jsx(js,{className:"h-3.5 w-3.5"}),"Ara"]})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Toplam Görev:"}),e.jsx("span",{className:"font-semibold",children:T.total})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center p-2 bg-green-50 rounded min-h-[70px] w-full",children:[e.jsx(je,{className:"h-4 w-4 text-green-600 mb-1"}),e.jsx("span",{className:"text-xs font-semibold text-green-700",children:T.completed}),e.jsx("span",{className:"text-[10px] text-green-600",children:"Tamamlandı"})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-blue-50 rounded min-h-[70px] w-full",children:[e.jsx(Be,{className:"h-4 w-4 text-blue-600 mb-1"}),e.jsx("span",{className:"text-xs font-semibold text-blue-700",children:T.inProgress}),e.jsx("span",{className:"text-[10px] text-blue-600",children:"Devam Ediyor"})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-yellow-50 rounded min-h-[70px] w-full",children:[e.jsx(Ee,{className:"h-4 w-4 text-yellow-600 mb-1"}),e.jsx("span",{className:"text-xs font-semibold text-yellow-700",children:T.pending}),e.jsx("span",{className:"text-[10px] text-yellow-600",children:"Bekliyor"})]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm pt-2 border-t",children:[e.jsxs("div",{className:"flex justify-between text-muted-foreground",children:[e.jsx("span",{children:"Departman:"}),e.jsx("span",{className:"text-foreground font-medium text-right",children:Pe(m)})]}),e.jsxs("div",{className:"flex justify-between text-muted-foreground",children:[e.jsx("span",{children:"Rol:"}),e.jsx(V,{className:`${G(p(m))} text-white hover:opacity-80`,children:E(p(m))})]})]}),e.jsxs("div",{className:"flex gap-2 mt-auto",children:[e.jsxs(_,{variant:"outline",className:"flex-1 gap-2",onClick:()=>se(m),disabled:re,children:[re?e.jsx(pe,{className:"h-4 w-4 animate-spin"}):e.jsx(rs,{className:"h-4 w-4"}),"Önizle"]}),e.jsxs(_,{variant:"default",className:"flex-1 gap-2",onClick:()=>i(m),disabled:z===m.id,children:[z===m.id?e.jsx(pe,{className:"h-4 w-4 animate-spin"}):e.jsx(ts,{className:"h-4 w-4"}),"İndir"]})]})]})},m.id)})})]},s)})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(s=>{var d,c;const l=L[s.id]||{total:0,completed:0,pending:0,inProgress:0};return e.jsx(R,{className:"hover:shadow-md transition-shadow h-full flex flex-col",children:e.jsxs(C,{className:"p-4 space-y-4 flex flex-col h-full",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsxs(Ae,{className:"h-12 w-12 flex-shrink-0",children:[e.jsx(ys,{src:void 0}),e.jsx(Re,{className:"bg-primary/10 text-primary",children:s.fullName?s.fullName.substring(0,2).toUpperCase():"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-semibold line-clamp-1",children:s.fullName||"İsimsiz"}),(((d=s.role)==null?void 0:d.includes("admin"))||((c=s.role)==null?void 0:c.includes("super_admin"))||X(s))&&e.jsx(gs,{className:"h-4 w-4 text-primary flex-shrink-0"})]}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:s.email}),s.phone&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1",children:hs(s.phone)})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[s.email&&e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1 gap-2",onClick:()=>window.location.href=`mailto:${s.email}`,children:[e.jsx(fs,{className:"h-3.5 w-3.5"}),"Mail"]}),s.phone&&e.jsxs(_,{variant:"outline",size:"sm",className:"flex-1 gap-2",onClick:()=>window.location.href=`tel:${s.phone}`,children:[e.jsx(js,{className:"h-3.5 w-3.5"}),"Ara"]})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Toplam Görev:"}),e.jsx("span",{className:"font-semibold",children:l.total})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center p-2 bg-green-50 rounded min-h-[70px] w-full",children:[e.jsx(je,{className:"h-4 w-4 text-green-600 mb-1"}),e.jsx("span",{className:"text-xs font-semibold text-green-700",children:l.completed}),e.jsx("span",{className:"text-[10px] text-green-600",children:"Tamamlandı"})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-blue-50 rounded min-h-[70px] w-full",children:[e.jsx(Be,{className:"h-4 w-4 text-blue-600 mb-1"}),e.jsx("span",{className:"text-xs font-semibold text-blue-700",children:l.inProgress}),e.jsx("span",{className:"text-[10px] text-blue-600",children:"Devam Ediyor"})]}),e.jsxs("div",{className:"flex flex-col items-center p-2 bg-yellow-50 rounded min-h-[70px] w-full",children:[e.jsx(Ee,{className:"h-4 w-4 text-yellow-600 mb-1"}),e.jsx("span",{className:"text-xs font-semibold text-yellow-700",children:l.pending}),e.jsx("span",{className:"text-[10px] text-yellow-600",children:"Bekliyor"})]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm pt-2 border-t",children:[e.jsxs("div",{className:"flex justify-between text-muted-foreground",children:[e.jsx("span",{children:"Departman:"}),e.jsx("span",{className:"text-foreground font-medium text-right",children:Pe(s)})]}),e.jsxs("div",{className:"flex justify-between text-muted-foreground",children:[e.jsx("span",{children:"Rol:"}),e.jsx(V,{className:`${G(p(s))} text-white hover:opacity-80`,children:E(p(s))})]})]}),e.jsxs("div",{className:"flex gap-2 mt-auto",children:[e.jsxs(_,{variant:"outline",className:"flex-1 gap-2",onClick:()=>se(s),disabled:re,children:[re?e.jsx(pe,{className:"h-4 w-4 animate-spin"}):e.jsx(rs,{className:"h-4 w-4"}),"Önizle"]}),e.jsxs(_,{variant:"default",className:"flex-1 gap-2",onClick:()=>i(s),disabled:z===s.id,children:[z===s.id?e.jsx(pe,{className:"h-4 w-4 animate-spin"}):e.jsx(ts,{className:"h-4 w-4"}),"İndir"]})]})]})},s.id)})})]})}),e.jsx(ns,{open:H,onOpenChange:k,children:e.jsxs(is,{className:"w-full max-w-[98vw] md:max-w-6xl max-h-[95vh] overflow-y-auto",children:[e.jsxs(cs,{children:[e.jsxs(ds,{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"h-5 w-5"}),"Kullanıcı Performans Raporu - ",(r==null?void 0:r.member.fullName)||(r==null?void 0:r.member.email)]}),e.jsxs(os,{children:[r==null?void 0:r.member.email," - ",new Date().toLocaleDateString("tr-TR",{day:"2-digit",month:"long",year:"numeric"})]})]}),r&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(R,{className:"bg-gradient-to-br from-blue-50 to-blue-100/50 border-blue-200",children:e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Toplam Görev"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900 mt-1",children:r.stats.total})]}),e.jsx(Ke,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(R,{className:"bg-gradient-to-br from-green-50 to-green-100/50 border-green-200",children:e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-700",children:"Tamamlanan"}),e.jsx("p",{className:"text-2xl font-bold text-green-900 mt-1",children:r.stats.completed}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:r.stats.total>0?`%${Math.round(r.stats.completed/r.stats.total*100)}`:"%0"})]}),e.jsx(je,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(R,{className:"bg-gradient-to-br from-yellow-50 to-yellow-100/50 border-yellow-200",children:e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-700",children:"Aktif Görevler"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900 mt-1",children:r.stats.active})]}),e.jsx(Be,{className:"h-8 w-8 text-yellow-600"})]})})})]}),e.jsxs(R,{children:[e.jsx(ve,{children:e.jsx(we,{children:"Detaylı İstatistikler"})}),e.jsx(C,{children:e.jsxs(bs,{children:[e.jsx(Ts,{children:e.jsxs(oe,{children:[e.jsx(fe,{children:"Metrik"}),e.jsx(fe,{className:"text-center",children:"Değer"}),e.jsx(fe,{className:"text-center",children:"Oran"})]})}),e.jsxs(Ds,{children:[e.jsxs(oe,{children:[e.jsx(U,{className:"font-medium",children:"Toplam Görev"}),e.jsx(U,{className:"text-center",children:r.stats.total}),e.jsx(U,{className:"text-center",children:"%100"})]}),e.jsxs(oe,{children:[e.jsx(U,{className:"font-medium",children:"Tamamlanan"}),e.jsx(U,{className:"text-center",children:r.stats.completed}),e.jsx(U,{className:"text-center",children:r.stats.total>0?`%${Math.round(r.stats.completed/r.stats.total*100)}`:"%0"})]}),e.jsxs(oe,{children:[e.jsx(U,{className:"font-medium",children:"Kabul Edilen"}),e.jsx(U,{className:"text-center",children:r.stats.accepted}),e.jsx(U,{className:"text-center",children:r.stats.total>0?`%${Math.round(r.stats.accepted/r.stats.total*100)}`:"%0"})]}),e.jsxs(oe,{children:[e.jsx(U,{className:"font-medium",children:"Beklemede"}),e.jsx(U,{className:"text-center",children:r.stats.pending}),e.jsx(U,{className:"text-center",children:r.stats.total>0?`%${Math.round(r.stats.pending/r.stats.total*100)}`:"%0"})]}),e.jsxs(oe,{children:[e.jsx(U,{className:"font-medium",children:"Reddedilen"}),e.jsx(U,{className:"text-center",children:r.stats.rejected}),e.jsx(U,{className:"text-center",children:r.stats.total>0?`%${Math.round(r.stats.rejected/r.stats.total*100)}`:"%0"})]}),e.jsxs(oe,{children:[e.jsx(U,{className:"font-medium",children:"Aktif Görevler"}),e.jsx(U,{className:"text-center",children:r.stats.active}),e.jsx(U,{className:"text-center",children:r.stats.total>0?`%${Math.round(r.stats.active/r.stats.total*100)}`:"%0"})]})]})]})})]}),r.stats.assignments.length>0&&e.jsxs(R,{children:[e.jsx(ve,{children:e.jsx(we,{children:"Görev Detayları"})}),e.jsx(C,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(bs,{children:[e.jsx(Ts,{children:e.jsxs(oe,{children:[e.jsx(fe,{children:"Görev Başlığı"}),e.jsx(fe,{className:"text-center",children:"Durum"}),e.jsx(fe,{className:"text-center",children:"Atanma Tarihi"}),e.jsx(fe,{className:"text-center",children:"Tamamlanma Tarihi"})]})}),e.jsx(Ds,{children:r.stats.assignments.map((s,l)=>{const d={pending:"Beklemede",accepted:"Kabul Edildi",rejected:"Reddedildi",completed:"Tamamlandı",in_progress:"Devam Ediyor"},c=s.assignedAt instanceof Date?s.assignedAt:new Date(s.assignedAt),m=s.completedAt?s.completedAt instanceof Date?s.completedAt:new Date(s.completedAt):null;return e.jsxs(oe,{children:[e.jsx(U,{className:"font-medium",children:s.taskTitle}),e.jsx(U,{className:"text-center",children:e.jsx(V,{variant:s.status==="completed"?"default":s.status==="accepted"||s.status==="in_progress"?"secondary":s.status==="rejected"?"destructive":"outline",children:d[s.status]||s.status})}),e.jsx(U,{className:"text-center",children:vs(c,"dd.MM.yyyy",{locale:Ns})}),e.jsx(U,{className:"text-center",children:m?vs(m,"dd.MM.yyyy",{locale:Ns}):"-"})]},l)})})]})})})]}),e.jsx(R,{className:"bg-gradient-to-r from-primary/10 to-primary/5 border-primary/20",children:e.jsx(C,{className:"p-4",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:r.stats.userName})," kullanıcısı toplam"," ",e.jsx("strong",{children:r.stats.total})," görev almış,"," ",e.jsx("strong",{children:r.stats.completed})," görevi tamamlamıştır."," ","Tamamlanma oranı:"," ",e.jsxs("strong",{children:["%",r.stats.total>0?Math.round(r.stats.completed/r.stats.total*100):0]})]})})})]}),e.jsxs(Ws,{children:[e.jsx(_,{variant:"outline",onClick:()=>k(!1),children:"Kapat"}),e.jsx(_,{onClick:te,disabled:!r||z===(r==null?void 0:r.member.id),children:z===(r==null?void 0:r.member.id)?e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"h-4 w-4 mr-2 animate-spin"}),"İndiriliyor..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"PDF İndir"]})})]})]})})]})},Mt=()=>{const{user:a,isAdmin:u,isTeamLeader:Z}=Ie(),[B,b]=o.useState([]),[N,D]=o.useState([]),[h,w]=o.useState([]),[j,I]=o.useState([]),[z,M]=o.useState(!0),[Q,ee]=o.useState(null),[O,v]=o.useState("all");o.useEffect(()=>{a!=null&&a.id&&L()},[a,O]);const L=async()=>{if(a!=null&&a.id){M(!0);try{const[n,x,p]=await Promise.all([We(),be(),ge()]);if(b(n),u){D(n);let E=n;if(O!=="all"&&(E=n.filter(i=>i.id===O)),E.length===0){w([]),I([]),M(!1);return}const G=E.map(i=>i.id),X=x.filter(i=>!!(i.approvedTeams&&i.approvedTeams.some(te=>G.includes(te))||i.pendingTeams&&i.pendingTeams.some(te=>G.includes(te))||i.departmentId&&G.includes(i.departmentId)));w(X);const le=X.map(i=>i.id),se=p.filter(i=>le.includes(i.createdBy)||i.createdBy===a.id);I(se)}else{const E=B.filter(i=>i.managerId===a.id);if(E.length===0){D([]),w([]),I([]),M(!1);return}D(E);const G=E.map(i=>i.id),X=x.filter(i=>!!(i.approvedTeams&&i.approvedTeams.some(te=>G.includes(te))||i.pendingTeams&&i.pendingTeams.some(te=>G.includes(te))||i.departmentId&&G.includes(i.departmentId)));w(X);const le=X.map(i=>i.id),se=p.filter(i=>le.includes(i.createdBy)||i.createdBy===a.id);I(se)}}catch(n){console.error("Error fetching team stats:",n)}finally{M(!1)}}},F=j.filter(n=>{if(!n.dueDate||n.status==="completed"||n.status==="cancelled")return!1;let x;const p=n.dueDate;return p!=null&&p.toDate&&typeof p.toDate=="function"?x=p.toDate():p instanceof Date?x=p:x=new Date(p),Ce(x,new Date)}),H=j.filter(n=>{if(!n.dueDate||n.status==="completed"||n.status==="cancelled")return!1;let x;const p=n.dueDate;p!=null&&p.toDate&&typeof p.toDate=="function"?x=p.toDate():p instanceof Date?x=p:x=new Date(p);const E=Qs(new Date),G=Xs(E,3);return!Ce(x,E)&&Ce(x,G)}),k=St(new Date,7),r=j.filter(n=>{if(n.status!=="completed"||!n.updatedAt)return!1;let x;const p=n.updatedAt;return p!=null&&p.toDate&&typeof p.toDate=="function"?x=p.toDate():p instanceof Date?x=p:x=new Date(p),Vs(x,k)}),Ne=j.length>0?j.reduce((n,x)=>n+(x.priority||0),0)/j.length:0,re=h.map(n=>{const x=j.filter(E=>E.createdBy===n.id),p=x.filter(E=>E.status==="completed").length;return{member:n,totalTasks:x.length,completedTasks:p,completionRate:x.length>0?p/x.length*100:0}}).sort((n,x)=>x.completedTasks-n.completedTasks).slice(0,5),J={completedTasks:j.filter(n=>n.status==="completed").length,completionRate:j.length>0?j.filter(n=>n.status==="completed").length/j.length*100:0,overdueTasks:F.length,dueSoonTasks:H.length,recentCompleted:r.length,avgPriority:Ne.toFixed(1)},Te=n=>{const x=h.filter(i=>!!(i.approvedTeams&&i.approvedTeams.includes(n)||i.pendingTeams&&i.pendingTeams.includes(n)||i.departmentId===n)),p=x.map(i=>i.id),E=j.filter(i=>!!(i.productionProcessId===n||p.includes(i.createdBy))),G=E.filter(i=>i.status==="completed").length;E.filter(i=>i.status==="cancelled").length;const X=E.length,le=E.filter(i=>i.status!=="completed"&&i.status!=="cancelled").length,se=X>0?G/X*100:0;return{members:x.length,activeTasks:le,completedTasks:G,totalTasks:X,completionRate:se}};return z?e.jsxs("div",{className:"space-y-4",children:[e.jsx(ks,{className:"h-32 w-full"}),e.jsx(ks,{className:"h-64 w-full"})]}):e.jsxs("div",{className:"space-y-6",children:[u&&e.jsx(R,{children:e.jsx(C,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Ekip Seç:"}),e.jsxs(zs,{value:O,onValueChange:v,children:[e.jsx($s,{className:"w-full sm:w-[250px]",children:e.jsx(Ks,{placeholder:"Ekip seçiniz"})}),e.jsxs(_s,{children:[e.jsx($e,{value:"all",children:"Tüm Ekipler"}),B.map(n=>e.jsx($e,{value:n.id,children:n.name},n.id))]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(R,{className:"bg-gradient-to-br from-green-50 to-green-100/50 border-green-200",children:e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-700",children:"Tamamlanan"}),e.jsx("p",{className:"text-2xl font-bold text-green-900 mt-1",children:J.completedTasks})]}),e.jsx(Hs,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(R,{className:"bg-gradient-to-br from-purple-50 to-purple-100/50 border-purple-200",children:e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-700",children:"Tamamlanma Oranı"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-900 mt-1",children:[J.completionRate.toFixed(0),"%"]})]}),e.jsx(Be,{className:"h-8 w-8 text-purple-600"})]})})}),e.jsx(R,{className:"bg-gradient-to-br from-red-50 to-red-100/50 border-red-200",children:e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-700",children:"Geciken Görevler"}),e.jsx("p",{className:"text-2xl font-bold text-red-900 mt-1",children:J.overdueTasks})]}),e.jsx(Fs,{className:"h-8 w-8 text-red-600"})]})})}),e.jsx(R,{className:"bg-gradient-to-br from-amber-50 to-amber-100/50 border-amber-200",children:e.jsx(C,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-700",children:"Yaklaşan Terminler"}),e.jsx("p",{className:"text-2xl font-bold text-amber-900 mt-1",children:J.dueSoonTasks}),e.jsx("p",{className:"text-xs text-amber-600 mt-1",children:"3 gün içinde"})]}),e.jsx(Ys,{className:"h-8 w-8 text-amber-600"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(R,{children:[e.jsx(ve,{children:e.jsxs(we,{className:"text-lg flex items-center gap-2",children:[e.jsx(Js,{className:"h-5 w-5"}),"Son 7 Gün Aktivite"]})}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Tamamlanan Görevler"}),e.jsx("span",{className:"text-muted-foreground",children:J.recentCompleted})]}),e.jsx(as,{value:j.length>0?J.recentCompleted/j.length*100:0,className:"h-3"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Son 7 gün içinde ",J.recentCompleted," görev tamamlandı"]})]})]}),e.jsxs(R,{children:[e.jsx(ve,{children:e.jsxs(we,{className:"text-lg flex items-center gap-2",children:[e.jsx(Rt,{className:"h-5 w-5"}),"Görev Öncelik Analizi"]})}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Ortalama Öncelik"}),e.jsx("span",{className:"text-muted-foreground",children:J.avgPriority})]}),e.jsx(as,{value:j.length>0?parseFloat(J.avgPriority)/5*100:0,className:"h-3"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Yüksek Öncelik:"}),e.jsx("span",{className:"ml-2 font-semibold",children:j.filter(n=>(n.priority||0)>=4).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Kritik:"}),e.jsx("span",{className:"ml-2 font-semibold text-red-600",children:j.filter(n=>(n.priority||0)===5).length})]})]})]})]})]}),re.length>0&&e.jsxs(R,{children:[e.jsx(ve,{children:e.jsxs(we,{className:"text-lg flex items-center gap-2",children:[e.jsx(At,{className:"h-5 w-5"}),"En Aktif Üyeler"]})}),e.jsx(C,{children:e.jsx("div",{className:"space-y-3",children:re.map(({member:n,totalTasks:x,completedTasks:p,completionRate:E},G)=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary/10 text-primary font-semibold text-sm",children:G+1}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.fullName||n.email}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[p," tamamlanan / ",x," toplam"]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs(V,{variant:"secondary",className:"text-xs",children:[E.toFixed(0),"%"]})})]},n.id))})})]}),e.jsxs(R,{children:[e.jsx(ve,{children:e.jsxs(we,{className:"text-lg flex items-center gap-2",children:[e.jsx(ms,{className:"h-5 w-5"}),u?"Tüm Ekipler":"Yönettiğim Ekipler"," (",N.length,")"]})}),e.jsx(C,{children:e.jsx("div",{className:"space-y-4",children:N.map(n=>{const x=Te(n.id);return e.jsxs("button",{onClick:()=>{u&&v(n.id)},className:"w-full text-left p-4 rounded-lg bg-muted/50 space-y-2 hover:bg-muted transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("h4",{className:"font-medium",children:n.name})]}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[x.completionRate.toFixed(0),"%"]})]}),e.jsx(as,{value:x.completionRate,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Üye: ",x.members]}),e.jsxs("span",{children:["Aktif: ",x.activeTasks]}),e.jsxs("span",{children:["Tamamlanan: ",x.completedTasks]}),e.jsxs("span",{children:["Toplam: ",x.totalTasks]})]})]},n.id)})})})]}),!u&&Q&&e.jsx(Dt,{open:!!Q,onOpenChange:n=>!n&&ee(null),departmentId:Q})]})},pa=()=>{const{user:a,isAdmin:u,isTeamLeader:Z}=Ie(),[B,b]=o.useState("approvals"),[N,D]=o.useState({totalMembers:0,pendingApprovals:0,pendingRequests:0,activeTasks:0}),[h,w]=o.useState(!0);if(!u&&!Z)return e.jsx(it,{to:"/",replace:!0});o.useEffect(()=>{j()},[a,u]);const j=async()=>{if(a!=null&&a.id){w(!0);try{const[I,z,M,Q]=await Promise.all([be(),We(),ge(),u?et():Zs(a.id)]);let ee=[];if(u)ee=I;else{const L=z.filter(F=>F.managerId===a.id);if(L.length===0)ee=[];else{const F=L.map(H=>H.id);ee=I.filter(H=>!!(H.approvedTeams&&H.approvedTeams.some(k=>F.includes(k))||H.pendingTeams&&H.pendingTeams.some(k=>F.includes(k))||H.departmentId&&F.includes(H.departmentId)))}}let O=M;if(!u){const L=z.filter(F=>F.managerId===a.id);if(L.length>0){const F=L.map(k=>k.id),H=I.filter(k=>!!(k.approvedTeams&&k.approvedTeams.some(r=>F.includes(r))||k.pendingTeams&&k.pendingTeams.some(r=>F.includes(r))||k.departmentId&&F.includes(k.departmentId))).map(k=>k.id);O=M.filter(k=>H.includes(k.createdBy)||k.createdBy===a.id)}else O=M.filter(F=>F.createdBy===a.id)}const v=O.filter(L=>L.approvalStatus==="pending");D({totalMembers:ee.length,pendingApprovals:v.length,pendingRequests:Q.length,activeTasks:O.filter(L=>L.status==="in_progress").length})}catch(I){console.error("Error fetching stats:",I),W.error("İstatistikler yüklenirken hata oluştu")}finally{w(!1)}}};return e.jsx(dt,{children:e.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-foreground",children:"Ekip Yönetimi"}),e.jsx("p",{className:"text-muted-foreground mt-0.5 sm:mt-1 text-xs sm:text-sm",children:"Ekip üyelerinizi, görev onaylarını ve katılım isteklerini yönetin."})]}),!h&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("button",{type:"button",onClick:()=>b("members"),className:"text-left group focus:outline-none touch-manipulation h-full",children:e.jsx(R,{className:"bg-gradient-to-br from-blue-50 to-blue-100/50 border-blue-200 group-hover:border-blue-400 transition-colors h-full",children:e.jsxs(C,{className:"p-3 sm:p-4 h-full flex items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-blue-700",children:"Toplam Üye"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-blue-900 mt-1",children:N.totalMembers}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-1",children:"Ekip üyelerini görüntüleyin"})]}),e.jsx(ze,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-600 flex-shrink-0"})]})})}),e.jsx("button",{type:"button",onClick:()=>b("approvals"),className:"text-left group focus:outline-none touch-manipulation h-full",children:e.jsx(R,{className:"bg-gradient-to-br from-yellow-50 to-yellow-100/50 border-yellow-200 group-hover:border-yellow-400 transition-colors h-full",children:e.jsxs(C,{className:"p-3 sm:p-4 h-full flex items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-yellow-700",children:"Bekleyen Onaylar"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-yellow-900 mt-1",children:N.pendingApprovals}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-1",children:"Görev onay taleplerini inceleyin"})]}),e.jsx(Ee,{className:"h-6 w-6 sm:h-8 sm:w-8 text-yellow-600 flex-shrink-0"})]})})}),e.jsx("button",{type:"button",onClick:()=>b("approvals"),className:"text-left group focus:outline-none touch-manipulation h-full",children:e.jsx(R,{className:"bg-gradient-to-br from-green-50 to-green-100/50 border-green-200 group-hover:border-green-400 transition-colors h-full",children:e.jsxs(C,{className:"p-3 sm:p-4 h-full flex items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-green-700",children:"Aktif Görevler"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-900 mt-1",children:N.activeTasks}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-1",children:"Görev durumlarına göz atın"})]}),e.jsx(Be,{className:"h-6 w-6 sm:h-8 sm:w-8 text-green-600 flex-shrink-0"})]})})}),e.jsx("button",{type:"button",onClick:()=>b("join-requests"),className:"text-left group focus:outline-none touch-manipulation h-full",children:e.jsx(R,{className:"bg-gradient-to-br from-purple-50 to-purple-100/50 border-purple-200 group-hover:border-purple-400 transition-colors h-full",children:e.jsxs(C,{className:"p-3 sm:p-4 h-full flex items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-purple-700",children:"Katılım İstekleri"}),e.jsx("p",{className:"text-xl sm:text-2xl font-bold text-purple-900 mt-1",children:N.pendingRequests}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mt-1",children:"Bekleyen katılım taleplerini yönetin"})]}),e.jsx(Ss,{className:"h-6 w-6 sm:h-8 sm:w-8 text-purple-600 flex-shrink-0"})]})})})]}),e.jsxs(Gs,{value:B,onValueChange:b,className:"space-y-6",children:[e.jsx("div",{className:"overflow-x-auto pb-2 -mx-4 px-4 sm:mx-0 sm:px-0 sm:pb-0",children:e.jsxs(qs,{className:"w-full justify-start sm:justify-between h-auto p-1 gap-1",children:[e.jsxs(ue,{value:"approvals",className:"gap-2 flex-1 min-w-[140px]",children:[e.jsx(Hs,{className:"h-4 w-4"}),e.jsx("span",{children:"Görev Onayları"})]}),e.jsxs(ue,{value:"members",className:"gap-2 flex-1 min-w-[140px]",children:[e.jsx(ze,{className:"h-4 w-4"}),e.jsx("span",{children:"Ekip Üyeleri"})]}),e.jsxs(ue,{value:"logs",className:"gap-2 flex-1 min-w-[140px]",children:[e.jsx(Ke,{className:"h-4 w-4"}),e.jsx("span",{children:"Ekip Logları"})]}),e.jsxs(ue,{value:"join-requests",className:"gap-2 flex-1 min-w-[140px]",children:[e.jsx(Ss,{className:"h-4 w-4"}),e.jsx("span",{children:"Katılım İstekleri"})]}),e.jsxs(ue,{value:"stats",className:"gap-2 flex-1 min-w-[140px]",children:[e.jsx(Js,{className:"h-4 w-4"}),e.jsx("span",{children:"İstatistikler"})]})]})}),e.jsx(he,{value:"approvals",className:"space-y-4",children:e.jsx(It,{})}),e.jsx(he,{value:"members",className:"space-y-4",children:e.jsx(Pt,{})}),e.jsx(he,{value:"logs",className:"space-y-4",children:e.jsx(kt,{mode:u?"admin":"team",userId:a==null?void 0:a.id})}),e.jsx(he,{value:"join-requests",className:"space-y-4",children:e.jsx(Et,{})}),e.jsx(he,{value:"stats",className:"space-y-4",children:e.jsx(Mt,{})})]})]})})};export{pa as default};
